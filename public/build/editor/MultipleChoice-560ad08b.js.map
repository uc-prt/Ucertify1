{"version":3,"file":"MultipleChoice-560ad08b.js","sources":["../../../clsSMMultipleChoice/MultipleChoice.svelte"],"sourcesContent":["<script>\n\t/**\n\t * File: MultipleChoice.svelte\n\t * Author: Pradeep Yadav\n\t * Description: Authoring file for multiple choice\n\t */\n\timport { onMount } from \"svelte\";\n\timport { writable } from \"svelte/store\";\n\timport { AH } from \"../helper/HelperAI.svelte\";\n\timport OptionContainer from \"./OptionContainer.svelte\";\n\texport let ucEditor;\n\texport let getChildXml;\n\texport let editorState;\n\texport let xml;\n\n\tlet state = {};\n\tlet hdd = writable({\n\t\t\tcorrectAnswers:\"\",\n\t\t\toptionData:\"\",\n\t\t\toptionDataCopy:\"\",\n\t\t\treviewMode:false,\n\t\t\txml:\"\",\n\t\t\toptionCounter: 1,\n\t\t});\n\tconst unsubscribe = hdd.subscribe((items)=> {\n\t\tstate = items;\n\t});\n\tlet letters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\".split('');\n\n\tonMount(async()=> {\n\t\tdidMount();\n\t})\n\n\t// Interate and load Options\n\tfunction didMount() {\n\t\tvar init = setTimeout(function() {\n\t\t\tloadOldType();\n\t\t\tvar loadTimer = setTimeout(function() {\n\t\t\t\ttry {\n\t\t\t\t\tdocument.querySelectorAll(\"[id^='option']\").forEach((_this, i)=> {\n\t\t\t\t\t\tif (_this.querySelectorAll(\".pln\").length > 0) {\n\t\t\t\t\t\t\t_this.querySelectorAll(\".pln\").forEach((_this2)=> {\n\t\t\t\t\t\t\t\tif (_this2.nextElementSibling.length > 0 && _this.previousElementSibling.length > 0) {\n\t\t\t\t\t\t\t\t\tif (_this2.nextElementSibling.nodeName == \"BR\" && _this2.previousElementSibling.nodeName == \"BR\") {\n\t\t\t\t\t\t\t\t\t\t_this.nextElementSibling.remove();\n\t\t\t\t\t\t\t\t\t\t_this2.remove();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\txml ? editOption(i) : \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch(error) {\n\t\t\t\t\tconsole.log({err:\"Removing PrettyPrint  BR from Authoring Error\", func:'componentDidMount'});\n\t\t\t\t}\n\t\t\t\tucEditor.initEditor(false, \"#authoringSection .ebook_item_text\");\n\t\t\t\tclearTimeout(loadTimer);\n\t\t\t}, 3000);\n\t\t\tclearTimeout(init);\n\t\t}, 200);\n\t\tAH.listen(document, 'keydown', '.answer_container .delete_element', function(_this, event) {\n\t\t\tif ((event.keyCode == 13 || event.which == 13)) {\n\t\t\t\t// click the element which currently get the focus and enter key is down\n\t\t\t\tAH.trigger(_this, 'click');\n\t\t\t}\n        });\n        \n        // this condition used for that guid which is generated by the help of List Item module\n        if (editorState.ajaxData.parent_guid) {\n            // used for only show the preview\n            preview_edit = 1;\n            AI && AI.set('get_parent_guid', editorState.ajaxData.parent_guid);\n        }\n\t}\n\n\t// TO update modified options\n\tfunction updateProps(newData) {\n\t\teditorState.ajaxData.correct_answers = newData.correct_answers;\n\t\teditorState.ajaxData.answers = newData.answers;\n\t\tgetChildXml(editorState, \"mcqType\");\n\t}\n\n\t// Check options and set state\n\tfunction loadOldType() {\n\t\tstate.correctAnswers = editorState.ajaxData.correct_answers;\n\t\tstate.optionData = editorState.ajaxData.answers;\n\t\tstate.optionDataCopy = editorState.ajaxData.answers;\n\t\tstate.optionCounter = editorState.ajaxData.answers.length;\n\t}\n\n\t// Handle Edit of options\n\tfunction editOption(index){\n\t\tlet quesData = ucEditor.getContent(\"option\"+index);\n\t\tstate.optionDataCopy[index]['answer'] = AI.ignoreEnity(quesData);\n\t\tupdateProps({\n\t\t\tcorrect_answers: state.correctAnswers,\n\t\t\tanswers: state.optionDataCopy,\n\t\t});\n\t}\n\n\t//Handle Delete options\n\tfunction deleteOption(index) {\n\t\tlet temp = [];\n\t\tstate.optionDataCopy.map((data, i)=> {\n\t\t\tif (i != index) {\n\t\t\t\ttemp.push(data);\n\t\t\t}\n\t\t});\n\t\tconsole.log(temp);\n\t\tstate.optionDataCopy = temp;\n\t\tupdateProps({\n\t\t\tcorrect_answers: state.correctAnswers,\n\t\t\tanswers: temp,\n\t\t});\n\t\tupdateOptionData(temp);\n\t}\n\n\t// Handle addition of new options\n\tfunction addOption(index) {\n\t\tlet temp1 = state.optionDataCopy;\n\t\tstate.optionCounter = state.optionCounter + 1;\n\t\ttemp1.push({\n\t\t\tanswer: \"Option\",\n\t\t\tid: \"id\" + (state.optionCounter),\n\t\t\tis_correct:\"0\",\n\t\t\tseq_str:\"\",\n\t\t\tseq_tag:\"\"\n\t\t});\n\t\tstate.optionDataCopy = temp1;\n\t\tupdateProps({\n\t\t\tcorrect_answers: state.correctAnswers,\n\t\t\tanswers: temp1,\n\t\t});\n\t\tupdateOptionData(temp1);\n\t\t\n\t\ttinymce.EditorManager.editors = [];//@saquib:added this line\n\t\tucEditor.initEditor();\n\t\tsetTimeout(()=> {\n\t\t\tucEditor.initEditor(false, \"#authoringSection .ebook_item_text\");\n\t\t},1000);\n\t}\n\n\t// Update option's data\n\tfunction updateOptionData(data) {\n\t\tdata = JSON.stringify(data);\n\t\tdata  = JSON.parse(data);\n\t\tstate.optionData = data;\n\t}\n\n\t// Handle checked\n\tfunction toggleChecked(index,e) {\n\t\tlet correctAnswers = 0;\n\t\tstate.optionDataCopy[index]['is_correct'] = ((e.target.checked) ? \"1\" : \"0\");\n\t\tfor (let i in state.optionDataCopy) {\n\t\t\tif (state.optionDataCopy[i][\"is_correct\"] == \"1\") {\n\t\t\t\tcorrectAnswers++;\n\t\t\t}\n\t\t}\n\t\tstate.correctAnswers = correctAnswers;\n\t\tlet temp = state.optionDataCopy;\n\t\tupdateOptionData(temp);\n\t\tupdateProps({\n\t\t\tcorrect_answers: correctAnswers,\n\t\t\tanswers: state.optionDataCopy,\n\t\t});\n\t}\n</script>\n\n<div>\n\t{#if (state.optionData)}\n\t\t<OptionContainer \n\t\t\ttoggleChecked={toggleChecked} \n\t\t\tdeleteOption={deleteOption} \n\t\t\teditOption={editOption} \n\t\t\tletters={letters} \n\t\t\tcorrectAnswers={state.correctAnswers} \n\t\t\treviewMode={state.reviewMode} \n\t\t\tdata={state.optionData} \n\t\t/>\n\t{/if}\n\t<div class=\"mt-lg position-relative col-12 bottom20 pl-0\" style=\"padding-top: 8px;\">\n\t\t<button \n\t\t\tvariant=\"fab\" \n\t\t\tcolor=\"primary\"\n\t\t\taria-label=\"Add\"\n\t\t\ton:click={addOption}\n\t\t\tclass=\"rounded d-flex align-items-center btn btn-sm btn-outline-primary pr-md\"\n\t\t\tstyle=\"text-transform: none;\"\n\t\t>\n\t\t\t<span class=\"icomoon-plus pr-1\"></span>Add option\n\t\t</button> \n\t</div>\n</div>"],"names":[],"mappings":"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"}