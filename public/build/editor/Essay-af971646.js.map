{"version":3,"file":"Essay-af971646.js","sources":["../../../clsSMEssay/Essay.svelte"],"sourcesContent":["<script>\r\n    import { beforeUpdate,onMount } from \"svelte\";\r\n    import { AH, XMLToJSON } from \"../helper/HelperAI.svelte\";\r\n    import SUNEDITOR from 'suneditor';\r\n    import plugins from 'suneditor/src/plugins';\r\n    import { Checkbox } from 'svelte-mui/src';\r\n    export let xml;\r\n    export let getChildXml;\r\n    export let l;\r\n    let isUpload = false;\r\n    let author_xml;\r\n    const headingArray = [{\"font\": \"fontSize 6\",\"text\": \"Heading 1\"}, {\"font\": \"fontSize 5\",\"text\": \"Heading 2\"}, {\"font\": \"fontSize 4\",\"text\": \"Heading 3\"},{\"font\": \"fontSize 3\",\"text\": \"Heading 4\"},{\"font\": \"fontSize 2\",\"text\": \"Heading 5\"},{\"font\": \"fontSize 1\",\"text\": \"Heading 6\"}];\r\n    let essayAuthEditor;\r\n    let timer = null;\r\n    let state = {\r\n        files_number : 1,\r\n        cdata : true,\r\n    };\r\n    \r\n    onMount(()=> {\r\n        initEdit();\r\n        let listenrTarget = AH.find('#SM_essay', 'a,button,input,select');\r\n        AH.listenAll(listenrTarget, \"blur\", (e)=> { \r\n            console.log(e.target);\r\n            updateXML(500); \r\n        });\r\n        // AH.listenAll(listenrTarget, \"keyup\", ()=> { updateXML(500); });\r\n        // AH.listenAll(listenrTarget, \"keydown\", ()=> { updateXML(500); });\r\n\r\n        AH.bind(\"#files_number\", 'keydown', (e)=> {\r\n            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {\r\n                AH.select(\"#err_txt\").innerHTML = \"Digits Only\";\r\n                AH.selectAll(\"#err_txt\", 'show');\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // if ((navigator.userAgent.indexOf(\"MSIE \") > -1 || navigator.userAgent.indexOf(\"Trident/\")) > -1) {\r\n        //     jQuery('#uploadChk').keyup(function(e) { if (e.keyCode == 32) this.click() });\r\n        // }\r\n\r\n        let parsedXmlNode = AH.parseHtml(xml);\r\n        if (AH.find(parsedXmlNode, 'default') && AH.find(parsedXmlNode, 'default').getAttribute('type') == 1) {\r\n            AH.selectAll('.upload-area', 'removeClass', 'h');\r\n            AH.select('#uploadChk').checked = true;\r\n            console.log(AH.find(parsedXmlNode, 'default').getAttribute('fileTypeExts'));\r\n            AH.select(`#choose_ext option[value=\"${AH.find(parsedXmlNode, 'default').getAttribute('fileTypeExts')}\"]`, 'attr',{selected: 'selected'});\r\n            AH.select('#files_number').value = AH.find(parsedXmlNode, 'default').getAttribute('limit');\r\n        }\r\n\r\n        //updateXML();\r\n        parseXml(xml);\r\n    });\r\n\r\n    function initEdit() {\r\n        essayAuthEditor = SUNEDITOR.create('essay_editorAuth', { \r\n            width: 'auto',\r\n            toolbarContainer: \"#essayToolbar\",\r\n            placeholder: \"Write text here.\",\r\n            plugins: plugins, \r\n            resizingBar: false,\r\n            showPathLabel: false,\r\n            buttonList: [\r\n                ['formatBlock'],\r\n                ['bold', 'italic', 'underline'],\r\n                ['link'],\r\n                ['list', 'outdent', 'indent', 'align'],\r\n                ['removeFormat'],\r\n            ] \r\n        });\r\n\r\n        essayAuthEditor.onChange = (content, core)=> {\r\n            updateXML(1000, content);\r\n        }\r\n        essayAuthEditor.onKeyDown = (e, core)=> {\r\n            if (e.keyCode == 86 || e.keyCode == 67) {\r\n                updateXML(1000);\r\n            }\r\n        }\r\n    }\r\n    // // it detects any change in xml.\r\n    // beforeUpdate(()=> {\r\n    //     if (xml != author_xml) {\r\n    //         author_xml = xml;\r\n    //         parseXml(xml);\r\n    //     }\r\n    // });\r\n    \r\n\r\n    // if xml change the it updates cdata\r\n    function parseXml(xml) {\r\n        if (state.cdata) {\r\n            state.cdata = false;\r\n            let qxml = XMLToJSON(xml);\r\n            if ( AI.isValid(qxml) && AI.isValid(qxml.smxml.default) ) {\r\n                essayAuthEditor.setContents(qxml.smxml.default.__cdata);\r\n            }\r\n        }\r\n    }\r\n\r\n    // it checks the no .of files for upload. \r\n    function maxLengthCheck(e, maxLength) {\r\n        state.files_number = e.value;\r\n        if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {\r\n            AH.select(\"#err_txt\").innerHTML = \"Digits Only\";\r\n            AH.selectAll(\"#err_txt\", 'show');\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // it updates the xml;\r\n    function updateXML(time, content) {\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        timer = setTimeout(function() {\r\n            let val = content || essayAuthEditor.getContents();\r\n            let xmlDom = AH.parseHtml(xml);\r\n            let chooseExtOpt = AH.selectAll(\"#choose_ext option\", \"selected\")[0];\r\n            let defaultDom = xmlDom.querySelector('default');\r\n            if (AH.select(\"#uploadChk\").checked) {\r\n                if (defaultDom) {\r\n                    AH.setAttr(defaultDom, {\r\n                        'type': 1,\r\n                        'fileTypeExts': (chooseExtOpt ? chooseExtOpt.value : \"\"),\r\n                        'limit': AH.select('#files_number').value\r\n                    });\r\n                } else {\r\n                    let defHtml = AH.parseHtml(`<default type=\"1\" fileTypeExts=\"${chooseExtOpt ? chooseExtOpt.value : ''}\" limit=\"${AH.select('#files_number').value}\"></default>`);\r\n                    xmlDom.appendChild(defHtml);\r\n                }\r\n            } else if (defaultDom) {\r\n                defaultDom.setAttribute('type', 0)\r\n                defaultDom.removeAttribute(...['fileTypeExts', 'limit']);\r\n            }\r\n\r\n            if (defaultDom) {\r\n                defaultDom.innerHTML = `<!--[CDATA[${val}]]-->`;\r\n            } else {\r\n                let defHtml = AH.parseHtml(`<default type=\"0\"><!--[CDATA[${val}]]--></default>`);\r\n                xmlDom.appendChild(defHtml);\r\n                //xmlDom.querySelector('default').innerHTML = '';\r\n            }\r\n            //console.log(xmlDom);\r\n            author_xml = formatXml(xmlDom.outerHTML);\r\n            getChildXml(author_xml);\r\n        }, time);\r\n    }\r\n</script>\r\n\r\n<main id=\"SM_essay\">\r\n    <div class=\"hero-unit\">\r\n        <div id=\"essayToolbar\" class=\"sun-editor\"></div>\r\n        <textarea id=\"essay_editorAuth\" class=\"text-left editor sun-editor-editable\"></textarea>\r\n        <Checkbox \t\r\n            bind:checked={isUpload}\r\n            on:click={updateXML}\r\n            id=\"uploadChk\"\r\n            name=\"uploadChk\"\r\n            color=\"primary\"\r\n        >\r\n            <span>Upload</span>\r\n        </Checkbox>\r\n        {#if isUpload}\r\n            <div class=\"upload-area mt-3 text-left\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-sm-3\">\r\n                        <label for=\"choose_ext\" class=\"mb-0 pt-sm1 font14\">{l.file_extension_text} </label>\r\n                    </div>\r\n                    <div class=\"col-sm-8\">\r\n                        <select name=\"choose_ext\" id=\"choose_ext\" class=\"form-control form-control-md\" on:blur=\"{()=> updateXML(500)}\">\r\n                            <option value=\"*.txt,*.doc,*.docx,*.pdf,*.jpg,*.png,*.gif,*.bmp,*.jpeg\" selected=\"selected\">All(*.*)</option>\r\n                            <option value=\"*.txt\">*.txt</option>\r\n                            <option value=\"*.pdf\">*.pdf</option>\r\n                            <option value=\"*.doc,*.docx\">*.doc,*.docx</option>\r\n                            <option value=\"*.doc,*.docx,*.pdf\">*.doc,*.docx,*.pdf</option>\r\n                            <option value=\"*.jpg,*.png,*.gif,*.bmp,*.jpeg\">*.jpg,*.png,*.gif,*.bmp,*.jpeg</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div class=\"row mt-2\">\r\n                    <div class=\"col-sm-3\">\r\n                        <label for=\"files_number\" class=\"mb-0 font14 pt-1\">{l.number_of_files} </label>\r\n                    </div>\r\n                    <div class=\"col-sm-8\">\r\n                        <input \r\n                            type=\"number\" \r\n                            class=\"form-control form-control-md float-left filenumber\" \r\n                            name=\"files_number\" \r\n                            id=\"files_number\" \r\n                            value={state.files_number} \r\n                            step=\"1\" \r\n                            min=\"1\" \r\n                            max=\"10\" \r\n                            on:change={maxLengthCheck.bind(this, 2)} \r\n                            required=\"required\"\r\n                        />\r\n                        <small class=\"font11\">{l.you_can_upload}</small>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        {/if}\r\n    </div>\r\n</main>\r\n<style>\r\n    .hero-unit {\r\n        border: 1px solid #ccc;\r\n        width: 84%;\r\n        padding: 18px!important;\r\n        font-size: 15px!important;\r\n        margin-bottom: 30px;\r\n        font-weight: 200;\r\n        line-height: 30px;\r\n        color: inherit;\r\n        background-color: #eeeeee;\r\n        -webkit-border-radius: 6px;\r\n        -moz-border-radius: 6px;\r\n        border-radius: 6px;\r\n    }\r\n    #essay_editorAuth {\r\n        max-height: 250px;\r\n        height: 250px;\r\n        background-color: white;\r\n        border-collapse: separate;\r\n        border: 1px solid rgb(204, 204, 204);\r\n        padding: 4px;\r\n        box-sizing: content-box;\r\n        -webkit-box-shadow: rgba(0, 0, 0, 0.0745098) 0px 1px 1px 0px inset;\r\n        box-shadow: rgba(0, 0, 0, 0.0745098) 0px 1px 1px 0px inset;\r\n        border-top-right-radius: 3px;\r\n        border-bottom-right-radius: 3px;\r\n        border-bottom-left-radius: 3px;\r\n        border-top-left-radius: 3px;\r\n        overflow: scroll;\r\n        outline: none;\r\n    }\r\n    .essay-btn, .essay-btn-add {\r\n        display: inline-block;\r\n        padding: 4px 8px;\r\n        font-size: 12px;\r\n        line-height: 20px;\r\n        text-align: center;\r\n        vertical-align: middle;\r\n        cursor: pointer;\r\n        color: #333333;\r\n        text-shadow: 0 1px 1px rgba(255, 255, 255, 0.75);\r\n        background-color: #f5f5f5;\r\n        background-image: -moz-linear-gradient(top, #ffffff, #e6e6e6);\r\n        background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#ffffff), to(#e6e6e6));\r\n        background-image: -webkit-linear-gradient(top, #ffffff, #e6e6e6);\r\n        background-image: -o-linear-gradient(top, #ffffff, #e6e6e6);\r\n        background-image: linear-gradient(to bottom, #ffffff, #e6e6e6);\r\n        background-repeat: repeat-x;\r\n        /* filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffffff', endColorstr='#ffe6e6e6', GradientType=0); */\r\n        border-color: #e6e6e6 #e6e6e6 #bfbfbf;\r\n        border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);\r\n        /* filter: progid:DXImageTransform.Microsoft.gradient(enabled = false); */\r\n        border: 1px solid #cccccc;\r\n        border-bottom-color: #b3b3b3;\r\n        -webkit-border-radius: 4px;\r\n        -moz-border-radius: 4px;\r\n        border-radius: 4px;\r\n        -webkit-box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\r\n        -moz-box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\r\n        box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\r\n    }\r\n    .dropdown-item {\r\n        display: block;\r\n        width: 100%;\r\n        padding: 4px 12px;\r\n        clear: both;\r\n        font-weight: 400;\r\n        color: #212529;\r\n        text-align: inherit;\r\n        white-space: nowrap;\r\n        background-color: transparent;\r\n        border: 0;\r\n    }\r\n    .essay-btn {\r\n        margin-bottom: 15px;\r\n    }\r\n    .essay-container .upload-area #files_number {\r\n        width: 115px;\r\n    }\r\n    .essay-container {\r\n        width: 89%;\r\n    }\r\n</style>"],"names":["SUNEDITOR"],"mappings":"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"}