import{G as e,N as t,S as i,i as l,s as a,F as s,e as r,j as n,f as o,h as d,r as c,o as p,c as u,m as h,t as m,a as f,d as g,b,g as x,k as A,n as y,p as w,_ as v,A as _,E as k,X as E,w as M,I as $,u as I}from"./main-a30cdebc.js";import{I as L}from"./ItemHelper-bbb6acbc.js";import{F as T}from"./FillInTheBlanksToolbar-33754640.js";const S=new e;const C=new class{constructor(e){this.userAnsXML="",this.sInfo=!0,this.labBinded=!0,this.delPreSpaces={},this.init()}init(){this.delPreSpaces={loopGaurd:0,withLines:e=>{this.delPreSpaces.loopGaurd>0&&("function"==typeof activate&&activate(1),S.selectAll(e,"hide"));var t=S.selectAll(".linenums li").length,i=[];if(0==t&&this.delPreSpaces.loopGaurd<=4)return this.delPreSpaces.loopGaurd++,setTimeout((()=>{this.delPreSpaces.withLines(e)}),1e3),!1;this.showFillModule(e),S.selectAll(".linenums li").forEach(((e,t)=>{"&nbsp;"==S.find(e,"span").innerHTML||""==S.find(e,"span").innerHTML?e.remove():i.push(e)})),i.forEach(((e,t)=>{if(e.children.classList.contains("fillelement")||e.children.classList.contains("dropable")){let t;e.children.forEach((e=>{""==e.innerHTML?e.remove():t=e})),S.prevElm(e).append(t),S.insert(S.prevElm(e),S.nextElm(e).innerHTML,"beforeend"),S.nextElm(e).remove(),e.remove()}}))},withoutLines:e=>{S.find(e,".fillelement,.dropable","all").forEach((t=>{var i=S.prevElm(t).innerHTML.trim(),l=S.nextElm(t).innerHTML.trim();if(delPreSpaces.loopGaurd>0&&("function"==typeof activate&&activate(1),S.selectAll(e,"hide")),0==S.find(e,".kwd","all").length&&delPreSpaces.loopGaurd<=4)return delPreSpaces.loopGaurd++,setTimeout((()=>{delPreSpaces.withoutLines(e)}),1e3),!1;this.showFillModule(e),""==i?S.prevElm(t).remove():S.prevElm(t).innerHTML=i,""==l?S.nextElm(t).remove():S.nextElm(t).innerHTML=l}))},showFillModule:e=>{"function"==typeof activate&&activate(0),"undefined"!=typeof quizPlayerStatic&&"undefined"!=typeof QuizPlayer&&QuizPlayer.setNewHeight(quizPlayerStatic),S.selectAll(e,"show")}}}setUpdate(e){this.updateModule=e}readyFill(e){let i="",l="";S.bind(e+" select","change",(()=>{S.trigger(e,"click")})),this.dragOptionFill={appendTo:"body",zIndex:100,revert:e=>{if(!e)return this.sInfo&&(this.sInfo=!1,setTimeout((function(){this.sInfo=!0}),6e4),S.showmsg("While dropping a component, keep your mouse pointer on the drop area. Drop area must be compatible with the component you are dropping.",100)),!0},helper:t=>{var i=t.target;try{return i.classList.contains("dropable")&&(i=S.find(e,"#"+t.target.getAttribute("droped"))),this.img={width:S.select(i).clientWidth,height:"auto"},t.target.draggable("option","cursorAt",{left:Math.floor(this.img.width/2),top:-10}),t.target.cloneNode(!0).css({width:this.img.width+"px",height:this.img.height+"px",position:"absolute","text-align":"center"})}catch(e){console.warn("Helper:",e)}},onDragStart:e=>{e.target.dataset.drag_enable=!0},onDragEnter:e=>{e.target.classList.add("drop-hover")},onDragLeave:e=>{e.target.classList.remove("drop-hover")},onDrop:(t,i)=>{const a=t.target,s=i.getAttribute("droped")?i.getAttribute("droped"):i.getAttribute("id");a.getAttribute("droped").trim(),a.innerHTML=i.innerHTML,S.select(a,"attr",{userans:s,droped:s,path:i.getAttribute("path")}),S.select(a,"css",{backgroundColor:i.style.backgroundColor}),l=a.id,this.checkAns(e),a.classList.remove("drop-hover")},onDragEnd:(t,a)=>{let s=t.target;if(s.classList.contains("dropable")&&(s.dataset.drag_enable,S.select(s,"css",{backgroundColor:s.getAttribute("bgcolor")}),s.textContent=s.getAttribute("caption"),S.selectAll(s,"attr",{droped:"",userans:""})),i=s.id,s.classList.contains("dropable")){const e=S.select("#"+l).getAttribute("droped");e&&1==S.select("#"+e).getAttribute("drag-single")&&this.dnd.disableDrag("#"+e)}else i&&1==S.select("#"+i).getAttribute("drag-single")&&""!=l&&this.dnd.disableDrag("#"+i);this.checkAns(e),l=""},scroll:"true",refreshPositions:!0,cursor:"default"},window.fillid=e,this.dnd||(this.dnd=new t(this.dragOptionFill)),S.find(e,".dragable","all").forEach((e=>this.dnd.setDrag(e))),S.find(e,".dropable","all").forEach((e=>{const t=e.getAttribute("droped");t&&1==S.select("#"+t).getAttribute("drag-single")&&this.dnd.disableDrag(S.select("#"+t))})),S.find(e,"[droped*=ID]","all").forEach(((t,i)=>{"0"==S.find(e,"#"+t.getAttribute("droped")).getAttribute("multi_drag")&&this.dnd.disableDrag(S.find(e,"#"+t.getAttribute("droped")))})),S.find(e,".dropable","all").forEach((e=>this.dnd.setDrop(e)))}bindKeyup(e){S.find(e,".fillelement","all").forEach((e=>{S.selectAll(Array.from(e.children),"addClass","ks")})),S.find(e,".dragable","all").forEach((e=>{e.classList.add("ks")})),S.find(e,".dropable","all").forEach((e=>{e.classList.add("ks")})),S.listen(document,"click",e,((t,i)=>{this.checkFocus("ks")||S.selectAll(S.find(e,".copiedclr","all"),"removeClass","copiedclr")}))}checkFocus(e){this.checkAns&&this.checkAns(ajax_eId);var t=!1;return S.find(ajax_eId,"."+e,"all").forEach((e=>{if(S.isFocus(e))return t=!0,!1})),t}showdragans(e,t,i){void 0===i&&(i=0),S.find(e,"select,input,textarea,.dropable,span.edit_step","all").forEach((l=>{this.showchilddragans(e,l,t,i)}))}showchilddragans(e,t,i,l){let a=-2;if(t.classList.contains("dropable"))if(t.innerHTML=t.getAttribute("caption").replace(/\#doublequote#/gim,'"'),S.setCss(t,{"background-color":t.getAttribute("bgcolor")}),"c"==i)t.getAttribute("anskey").split(",").forEach(((i,l)=>{if(""!=i.trim()){const l=S.find(e,"#"+i);return l&&(t.innerHTML=l.getAttribute("caption").replace(/\#doublequote#/gim,'"'),S.setCss(t,{backgroundColor:l.getAttribute("bgcolor")})),!1}}));else if("u"==i){a=-1,""!=t.getAttribute("userans").trim()&&(this.userans=S.find(e,"#"+t.getAttribute("userans")),this.userans&&(t.innerHTML=this.userans.getAttribute("caption").replace(/\#doublequote#/gim,'"'),S.setCss(t,{backgroundColor:this.userans.getAttribute("bgcolor")})));const i=t.getAttribute("anskey"),l=t.getAttribute("userans");""!=l&&i.indexOf(l)>-1&&(a=1)}if(t.classList.contains("edit_step")&&1==l&&("c"==i?S.selectAll(".edit_step","css",{border:"none",display:"none"}):"u"==i&&(S.selectAll(".edit_step","css",{cursor:"none",display:"block"}),a=this.fillTestText(e,t))),t.parentElement.classList.contains("fillelement"))if("SELECT"==t.nodeName)a=-1,this.totalcorrect=S.find(t,"[correctans='1']","all").length,this.a=0,S.find(t,"option","all").forEach(((e,t)=>{e.removeAttribute("selected"),"c"==i?e.getAttribute("correctans")>0&&e.setAttribute("selected",!0):"u"==i&&(e.getAttribute("userans")>0&&e.setAttribute("selected",!0),e.selected&&1==e.getAttribute("correctans")&&this.a++)})),this.totalcorrect==this.a&&(a=1);else if("INPUT"==t.nodeName||"TEXTAREA"==t.nodeName)if(void 0===t.type&&(this.type="text"),"c"==i){var s=t.getAttribute("anskey").split(",");if(s.length>1){var r="<p style='text-align:left;'>All of the answers are correct!<br>";s.forEach(((e,t)=>{r+="("+(t+1)+") "+e.replace(/#cm/g,",")+"<br>"})),S.setAttr(t,{rel:"multiple_answers",title:r+"</p>","data-html":"true"})}t.value=t.getAttribute("anskey").replace(/#cm/g,",")}else if("u"==i){if(t.removeAttribute(["rel","title","data-html"]),""==t.getAttribute("userans")&&""!==t.getAttribute("defaultAns"))t.value=t.getAttribute("defaultAns");else{var n=t.getAttribute("userans");"TEXTAREA"==t.nodeName&&(n=(n=n.replace(/#singlequote#/g,"'")).replace(/#dblquote#/g,'"')),t.value=n}a=this.fillTestText(e,t)}if("u"==i&&1==l){if(-2!=a&&1!=parseInt(S.select(e).getAttribute("manual_grade"))){const e=this.markUserAnswer(a);t.classList.contains("dropable")?(S.insert(t,e,"beforeend"),t.setAttribute("as",a)):t.classList.contains("edit_step")?(1==a?S.selectAll("#"+t.getAttribute("id"),"css",{border:"2px solid green"}):S.selectAll("#"+t.getAttribute("id"),"css",{border:"2px solid red"}),t.setAttribute("as",a)):(S.insert(t.parentElement,e,"beforeend"),t.parentElement.setAttribute("as",a))}t.setAttribute("title",1==a?"is marked as Correct":"is marked as incorrect")}else S.find(e,".correct_incorrect_icon_fill",{action:"remove"}),t.setAttribute("title","")}fillTestText(e,t){var i=-1,l=t.getAttribute("anskey").trim(),a=t.value?t.value.trim():"",s=t.getAttribute("haskeywords"),r=t.getAttribute("hasnotkeywords"),n=t.getAttribute("codetype"),o=t.getAttribute("mathtype");if("TEXTAREA"!=t.nodeName){/\d,\d/.test(a)&&(a=t.value.trim().replace(/,/g,"#cm"));let e=a.match(/[a-zA-Z]{1,1},[a-zA-Z]{1,1}/g);a.match(/[a-zA-Z]{1,1},[a-zA-Z]{1,1}/g)&&(e=e.toString().replace(/,/g,"#cm")),a=a.replace(/[a-zA-Z]{1,1},[a-zA-Z]{1,1}/g,e)}if(1==n){var d=[/\s+/g,/\;$/,/"/g],c=["","","'"];for(let e=0;e<d.length;e++)a=a.replace(d[e],c[e]),l=l.replace(d[e],c[e])}if(1==o&&(a=t.getAttribute("userans").trim()),1==S.select(e).getAttribute("matchtype")&&(l=l.toLowerCase(),a=a.toLowerCase()),1==S.select(e).getAttribute("ignoretype")){if(0!=S.select(e).getAttribute("multi")){var p=[];l.split(",").forEach(((e,t)=>{p.push(e.replace(/[^a-zA-Z0-9]/gi,""))})),l=p.join(",")}else l=l.replace(/[^a-zA-Z0-9]/gi,"");a=a.replace(/[^a-zA-Z0-9]/gi,"")}if(1==t.getAttribute("keywordtype")&&s.length>0&&r.length>0){var u=0,h=0;s.split(",").forEach(((e,t)=>{-1!=a.indexOf(e)&&u++})),r.split(",").forEach(((e,t)=>{-1!=a.indexOf(e)&&h++})),s.split(",").length==u&&0==h&&(a=l)}return 0!=S.select(e).getAttribute("multi")?""!=(a=a.replace(/,/gm,"#cm"))&&this.checkInArray(l.split(","),a.split(","))&&(i=1,a=a.replace(/#cm/gm,",")):a==l&&(i=1),i}markUserAnswer(e){const t='<span class="'+(1==e?"icomoon-new-24px-checkmark-circle-1 font-weight-bold":"icomoon-new-24px-cancel-circle-1 font-weight-bold")+'" style="color:'+(1==e?"green":"red")+';">';let i='<span class="correct_incorrect_icon_fill" style="background:white;border-radius:15px 12px 12px;"> '+t+"</span></span>";return S.find(ajax_eId,".prettyprint","all").length>0&&(i='<span class="correct_incorrect_icon_fill" style="bottom:22px;background:none;border-radius:12px;"> '+t+"</span></span>"),i}checkAns(e){if(this.userAnsXML="<smans type='9'>\n",this.result=!0,this.temp=0,S.find(e,"select,input,textarea,.dropable,span.edit_step.mathquill","all").forEach((t=>{this.userAnsXML=this.checkChildAnswer(e,t,this.userAnsXML)})),this.userAnsXML+="</smans>",window.ISSPECIALMODULEUSERXMLCHANGE=1,S.select("#special_module_user_xml").value=this.userAnsXML,this.updateModule("uxml",this.userAnsXML),1!=parseInt(S.select(e).getAttribute("manual_grade")))return S.select("#answer").checked=!!this.result,this.result?(S.select("#answer").checked=!0,"undefined"!=typeof is_sm&&S.showmsg("Correct",3),"Correct"):(S.select("#answer").checked=!1,"undefined"!=typeof is_sm&&S.showmsg("Incorrect",3),"Incorrect")}checkInArray(e,t){let i=[];for(let l=0;l<e.length;l++)for(let a=0;a<t.length;a++)i.includes(t[a])||t[a].trim()!=e[l].trim()||i.push(t[a]);return 0==t.length-i.length}checkChildAnswer(e,t,i){if(t.classList.contains("dropable")){var l=t.getAttribute("anskey").split(",");0==S.findInArray(t.getAttribute("userans"),l)?this.result=!1:this.temp++,"undefined"!=typeof calculatePoint&&calculatePoint(S.select(e).getAttribute("totalcorrectans"),this.temp),i+=`<div id='${t.getAttribute("id")}' userAns='${t.getAttribute("userans")}'></div>\n`}else if(t.classList.contains("mathquill")){for(var a=[],s=t.getAttribute("id"),r=t.getAttribute("anskey").trim(),n=t.getAttribute("userans").trim(),o=MathQuill.getInterface(2).StaticMath(document.getElementById(s)),d=0;d<=o.innerFields.length-1;d++)a[d]=o.innerFields[d].latex();let e=n,l=n.match(/\\MathQuillMathField(.*?)}*}{4,6}|\\MathQuillMathField(.*?)}*}{3,6}|\\MathQuillMathField(.*?)}*}{2,6}|\\MathQuillMathField(.*?)}*}{1,6}/g);if(a.indexOf("")<0)for(d in l){const t="\\MathQuillMathField{"+a[d]+"}",i=l[d].replace(/\\MathQuillMathField(.*?)}*}{4,6}|\\MathQuillMathField(.*?)}*}{3,6}|\\MathQuillMathField(.*?)}*}{2,6}|\\MathQuillMathField(.*?)}*}{1,6}/g,t),s=l[d];e=e.replace(s,i)}let c=n=e;r!=c?this.result=!1:this.temp++,t.getAttribute("userans",c),i+=`<div id='${t.getAttribute("id")}' userAns='${c}' anskey='${r}' userAnsSeq='${t.getAttribute("userAnsSeq")}'></div>\n`}else if(t.parentElement.classList.contains("fillelement"))if("SELECT"==t.nodeName)this.uAnsSel="",this.a=0,this.totalcorrect=S.find(t,"[correctans='1']","all").length,S.find(t,"option","all").forEach(((e,t)=>{e.selected&&(this.a++,1!=e.getAttribute("correctans")?this.result=!1:this.temp++,this.uAnsSel=this.uAnsSel+t+",")})),this.a!=this.totalcorrect&&(this.result=!1),"undefined"!=typeof calculatePoint&&calculatePoint(S.select(e).getAttribute("totalcorrectans"),this.temp),i+=`<div id='${t.parentElement.getAttribute("id")}' userAns='${this.uAnsSel}'></div>\n`;else if("INPUT"==t.nodeName||"TEXTAREA"==t.nodeName){r=t.getAttribute("anskey").trim();var c=t.value.trim();if(1==t.getAttribute("codetype")){var p=[/\s+/g,/\;$/,/"/g],u=["","","'"];for(let e=0;e<p.length;e++)c=c.replace(p[e],u[e]),r=r.replace(p[e],u[e])}if(1==S.select(e).getAttribute("matchtype")&&(r=r.toLowerCase(),c=c.toLowerCase()),1==S.select(e).getAttribute("ignoretype")){if(0!=S.select(e).getAttribute("multi")){let e=[];r.split(",").forEach(((t,i)=>{e.push(t.replace(/[^a-zA-Z0-9]/gi,""))})),r=e.join(",")}else r=r.replace(/[^a-zA-Z0-9]/gi,"");c=c.replace(/[^a-zA-Z0-9]/gi,"")}if(0!=S.select(e).getAttribute("multi"))""!=(c=c.replace(/,/g,"#cm"))&&this.checkInArray(r.split(","),c.split(","))?this.temp++:this.result=!1;else{var h=t.getAttribute("haskeywords"),m=t.getAttribute("hasnotkeywords");if(1==t.getAttribute("keywordtype")&&h.length>0&&m.length>0){var f=0,g=0;h.split(",").forEach(((e,t)=>{-1!=c.indexOf(e)&&f++})),m.split(",").forEach(((e,t)=>{-1!=c.indexOf(e)&&g++})),h.split(",").length!=f||0!=g?this.result=!1:this.temp++}else r!=c?this.result=!1:this.temp++}"undefined"!=typeof calculatePoint&&calculatePoint(S.select(e).getAttribute("totalcorrectans"),this.temp);var b=t.value;"TEXTAREA"==t.nodeName&&(b=(b=b.replace(/'/g,"#singlequote#")).replace(/"/g,"#dblquote#")),t.nodeName,i+=`<div id='${t.parentElement.getAttribute("id")}' userAns='${b}'></div>\n`}return i}modeOn(e,t){S.selectAll(".test, .review","addClass","h"),e?("function"==typeof hotkeys&&(hotkeys.unbind("alt+down,enter,delete","fillintheblank"),hotkeys.deleteScope("fillintheblank")),S.selectAll(".review","removeClass","h"),this.unBindLab(),this.showdragans(ajax_eId,"u",1)):(this.bindKeyup(ajax_eId),S.selectAll(".test","removeClass","h"),this.bindLab(),this.showdragans(ajax_eId,"u"))}bindLab(){this.labBinded=!0,S.find(ajax_eId,"select,input,textarea",{action:"removeAttr",actionData:"disabled"});try{this.readyFill(ajax_eId)}catch(e){console.log("catch")}}unBindLab(){this.labBinded=!1,S.find(ajax_eId,"input,select,textarea","all").forEach((e=>{"INPUT"==this.nodeName||"TEXTAREA"==this.nodeName?e.getAttribute("userans",e.value):"SELECT"==this.nodeName&&e.querySelectorAll("option").forEach(((e,t)=>{e.selected?e.setAttribute("userans",1):e.setAttribute("userans","")}))}))}pre_fill(e){S.find(e,".fillelement,.dropable","all");S.find(e,".prettyprint","all").length>0&&("function"==typeof activate&&activate(1),S.selectAll(e,"hide"),S.find(e,"pre").classList.contains("lg")&&S.selectAll(e,"css",{width:"930px"}),setTimeout((()=>{S.find(e,"pre").classList.contains("linenums")?this.delPreSpaces.withLines(e):this.delPreSpaces.withoutLines(e),this.delPreSpaces.showFillModule(e)}),1e3))}},{document:j}=s;function q(e){let t,i;return{c(){t=r("link"),o(t,"rel","stylesheet"),o(t,"href",i=window.themeUrl+"css/mathquill.css")},m(e,i){d(e,t,i)},p:c,d(e){e&&p(t)}}}function F(e){let t,i;return t=new T({props:{spanId:e[5].spanId,divId:e[5].divId,action:e[3].fillMath[e[6]],show:e[9]}}),{c(){u(t.$$.fragment)},m(e,l){h(t,e,l),i=!0},p(e,i){const l={};32&i[0]&&(l.spanId=e[5].spanId),32&i[0]&&(l.divId=e[5].divId),8&i[0]&&(l.action=e[3].fillMath[e[6]]),t.$set(l)},i(e){i||(m(t.$$.fragment,e),i=!0)},o(e){f(t.$$.fragment,e),i=!1},d(e){g(t,e)}}}function z(e){let t;return{c(){t=I("*Matching is not case sensitive.")},m(e,i){d(e,t,i)},d(e){e&&p(t)}}}function N(e){let t;return{c(){t=I("*Exact matching is required.")},m(e,i){d(e,t,i)},d(e){e&&p(t)}}}function P(e){let t,i,l,a,s,c,w,v,_,k,E,M,$,I,T,S,C,j,P,D,O,H,B,Q=e[5].isMathquill&&q(),X={handleReviewClick:e[10],reviewMode:e[0]};l=new L({props:X}),e[15](l),l.$on("setReview",e[7]),l.$on("unsetReview",e[8]);let U=e[5].showToolbar&&F(e);function Z(e,t){return"0"==e[5].matchtype?N:z}let G=Z(e),V=G(e);return{c(){t=r("div"),Q&&Q.c(),i=b(),u(l.$$.fragment),a=b(),s=r("center"),c=r("div"),w=r("div"),v=b(),U&&U.c(),_=b(),k=r("div"),V.c(),E=b(),M=r("div"),$=r("div"),I=b(),T=r("center"),o(w,"class","string"),o(w,"id","previewArea"),x(w,"font-family","'Roboto, sans-serif; font-size: 1em"),x(k,"color","#b94a48"),x(k,"margin-top","5px"),o(k,"class","smnotes"),o($,"class","arrow-up"),o(T,"class","dragArea"),o(M,"class","footerStr"),x(M,"display",e[5].footerStr?"block":"none"),o(c,"id",R),o(c,"class",S="fillmain "+(e[0]?"pe-none":null)),o(c,"matchtype",C=e[5].matchtype),o(c,"multi",j=e[5].multi),o(c,"ignoretype",P=e[5].ignoretype),o(c,"manual_grade",D=e[1]||0),o(c,"totalcorrectans",O=e[5].totalcorrectans),o(t,"class",H=e[2]?"mx-4 pl-2 pl-md-0":"")},m(e,r){d(e,t,r),Q&&Q.m(t,null),n(t,i),h(l,t,null),n(t,a),n(t,s),n(s,c),n(c,w),n(c,v),U&&U.m(c,null),n(c,_),n(c,k),V.m(k,null),n(c,E),n(c,M),n(M,$),n(M,I),n(M,T),B=!0},p(e,a){e[5].isMathquill?Q?Q.p(e,a):(Q=q(),Q.c(),Q.m(t,i)):Q&&(Q.d(1),Q=null);const s={};1&a[0]&&(s.reviewMode=e[0]),l.$set(s),e[5].showToolbar?U?(U.p(e,a),32&a[0]&&m(U,1)):(U=F(e),U.c(),m(U,1),U.m(c,_)):U&&(A(),f(U,1,1,(()=>{U=null})),y()),G!==(G=Z(e))&&(V.d(1),V=G(e),V&&(V.c(),V.m(k,null))),(!B||32&a[0])&&x(M,"display",e[5].footerStr?"block":"none"),(!B||1&a[0]&&S!==(S="fillmain "+(e[0]?"pe-none":null)))&&o(c,"class",S),(!B||32&a[0]&&C!==(C=e[5].matchtype))&&o(c,"matchtype",C),(!B||32&a[0]&&j!==(j=e[5].multi))&&o(c,"multi",j),(!B||32&a[0]&&P!==(P=e[5].ignoretype))&&o(c,"ignoretype",P),(!B||2&a[0]&&D!==(D=e[1]||0))&&o(c,"manual_grade",D),(!B||32&a[0]&&O!==(O=e[5].totalcorrectans))&&o(c,"totalcorrectans",O),(!B||4&a[0]&&H!==(H=e[2]?"mx-4 pl-2 pl-md-0":""))&&o(t,"class",H)},i(e){B||(m(l.$$.fragment,e),m(U),B=!0)},o(e){f(l.$$.fragment,e),f(U),B=!1},d(i){i&&p(t),Q&&Q.d(),e[15](null),g(l),U&&U.d(),V.d()}}}let R="fillmain";function D(e){let t=document.querySelectorAll(".textarea.ks");for(let l=0;l<t.length;l++){let a=t[l];var i=setTimeout((function(){a.style.cssText="height:auto;overflow: auto;",e&&(window.isIE?a.style.cssText="height:"+(a.scrollHeight+10)+"px;overflow: hidden":a.style.cssText="height:"+a.scrollHeight+"px;overflow: hidden"),clearTimeout(i)}),100)}}function O(e,t,i){let l,{manual_grade:a}=t,{xml:s}=t,{uxml:r}=t,{isReview:n}=t,{editorState:o}=t,{smValidate:d}=t,{showAns:c}=t,p="",u="",h=[],m=0,f=1,g=[],b={},x={};globalThis.ajax_eId="#fillmain";let A={};M({matchtype:"0",ignoretype:"",multi:"",totalcorrectans:0,showToolbar:!1,isMathquill:!1,fillMath:[],footerStr:!1}).subscribe((e=>{i(5,A=e)}));function y(){if(i(5,A.xml=s,A),b=E(s),r&&(window.isResetMath?(console.warn("Uxml not loaded",window.isResetMath),window.isResetMath=!1):(console.warn("uxml loaded",window.isResetMath),x=E(r),i(5,A.uxml=r,A))),function(e,t=!1){p=e.smxml.text.__cdata,u="",h=[],m=0,i(5,A.footerStr=!1,A),_.selectAll(".smnotes","hide"),e.smxml.text._matchType&&(e.smxml.text._matchtype=e.smxml.text._matchType,delete e.smxml.text._matchType);e.smxml.text._ignoreType&&(e.smxml.text._ignoretype=e.smxml.text._ignoreType,delete e.smxml.text._ignoreType);i(5,A.matchtype=e.smxml.text._matchtype,A),i(5,A.ignoretype=e.smxml.text._ignoretype,A),i(5,A.multi="multiple"==e.smxml.text._multiple?"1":"",A);let l=p.match(/%{[\s\S]*?}%/gm),a="",s="",r=0;l&&l.forEach(((e,n)=>{if(r++,t&&t.smans){let e=t.smans.div;0==Array.isArray(e)&&(e=[],e[0]=t.smans.div),e&&(s=e[n])}let o=l[n];a=l[n].match(/\|(.*?)}%$/gm),a=a?a[0].replace(/\||}%/gm,""):"",a=a.trim(),""==a||"c"==a?(_.selectAll(".smnotes","show"),s?z(o,n,s):z(o,n)):"n"==a?s?N(o,n,s):N(o,n):"d"==a||"ds"==a?s?H(o,n,s):H(o,n):"s"==a?s?P(o,n,s):P(o,n):"e"==a?(i(5,A.isMathquill=!0,A),s?F(o,n,s):F(o,n)):(a.indexOf(!1)||a.indexOf(!1))&&(_.selectAll(".smnotes","show"),s?O(o,n,s):O(o,n));o.replace("%{","").replace("}%","")}));_.selectAll("#"+R,"attr",{totalcorrectans:r}),p=_.ignoreEnity(p),_.find("#"+R,"#previewArea",{action:"html",actionData:p}),_.find("#"+R,".dragArea",{action:"html",actionData:u});let n=_.find("#"+R,".dragArea"),o=n?.children?Array.from(n.children):[];for(;o.length;)n.append(o.splice(Math.floor(Math.random()*o.length),1)[0]);(function(){let e=[];_.selectAll(".dragArea div").forEach(((t,i)=>{e.push(10*t.innerHTML.length+30)})),_.selectAll("#previewArea [id^=elem]").forEach((t=>{t.classList.contains("drag-resize")&&_.setCss(t,{"max-width":Math.max(...e)})}))})(),function(){if(_.find(ajax_eId,"table.uc-table","all").length>0){let e=_.find(ajax_eId,"table.uc-table").clientWidth+9;_.setCss(_.find(ajax_eId,".smnotes"),{width:e+"px",margin:"auto","padding-top":"5px"})}}(),q();var d=setTimeout((function(){_.find(ajax_eId,".prettyprint","all").length>=1&&0==_.find(ajax_eId,".prettyprint .L0","all").length&&"function"==typeof prettyPrint&&(_.selectAll(".prettyprint").forEach((e=>{e.classList.add("prettyprintReplica"),e.classList.remove("prettyprint")})),_.selectAll(".linenums").forEach((e=>{e.classList.add("linenumsReplica"),e.classList.remove("linenums")})),_.find(ajax_eId,".prettyprintReplica").forEach((e=>{e.classList.add("prettyprint")})),_.find(ajax_eId,".linenumsReplica").forEach((e=>{e.classList.add("linenums")})),prettyPrint(),_.selectAll(".prettyprintReplica").forEach((e=>{e.classList.add("prettyprint"),e.classList.remove("prettyprintReplica")})),_.selectAll(".linenumsReplica").forEach((e=>{e.classList.add("linenums"),e.classList.remove("linenumsReplica")}))),clearTimeout(d)}),2e3);if(_.find(ajax_eId,"table.uc-table","all").length>0){_.find(ajax_eId,"table.uc-table",{action:"addClass",actionData:"font14"});try{"BR"==_.find(ajax_eId,"table.uc-table").previousElementSibling?.nodeName&&_.find(ajax_eId,"table.uc-table").previousElementSibling.remove()}catch(e){console.warn(e)}}}(b,x),C.showdragans(ajax_eId,"u"),!s){let e=smVal.validate(o.content_type,o.subtype,o.content_icon);d(e)}}function I(){i(0,n=!0),s.includes("user Response{")&&(window.isResetMath=!0),i(5,A.showToolbar=!1,A),C.modeOn("on"),C.showdragans(ajax_eId,"u",1),_.selectAll(".remed_disable","show"),D(1);let e=document.getElementById(R);e=e?e.getElementsByClassName("mathquill"):e,e&&(_.setCss(ajax_eId,{position:"relative"}),_.insert(ajax_eId,"<div class='spinner-wrapper' style='position:absolute!important;opacity:0!important;'></div>","afterbegin"))}function L(){i(0,n=!1),_.selectAll(".mathquill","css",{border:"none"}),C.modeOn(),_.selectAll(".remed_disable, .corr_div","hide"),C.showdragans(ajax_eId,"u",0);let e=document.getElementById(R);e=e?e.getElementsByClassName("mathquill"):e,D(),e&&(_.selectAll(ajax_eId,"css",{position:"unset"}),_.selectAll(".spinner-wrapper","remove"))}function T(){let e=C.checkAns(ajax_eId);o&&c(e)}function S(e,t){let l,a=!0;for(;a;)(e=e.parentElement).getAttribute("id")&&(a=!1,l=e.getAttribute("id"));let s=[];_.selectAll("#"+l+" span.mq-editable-field").forEach((t=>{let i=e.getAttribute("mathquill-command-id");s.push(i)}));let r=e.getAttribute("mathquill-command-id"),n=s.indexOf(r);i(5,A.spanId=n,A),i(5,A.divId=l,A),i(5,A.showToolbar=!0,A)}function j(e,t){i(5,A[e]=t,A),"uxml"==e&&(x=E(A.uxml),function(e){let t="",i=b.smxml.text.__cdata.match(/%{[\s\S]*?}%/gm),l="";i&&i.forEach(((i,a)=>{if(e&&e.smans){let i=e.smans.div;0==Array.isArray(i)&&(i=[],i[0]=e.smans.div),i&&(t=i[a])}if(l=i.match(/\|(.*?)}%$/gm),l=l?l[0].replace(/\||}%/gm,""):"",l=l.trim(),t&&t._userAns){let e="";""==l||"c"==l||"n"==l?e=`#elem${a} .fillintheblank`:"d"==l||"ds"==l?e="#elem"+a:"s"==l||("e"==l?e="#elem"+a:(l.indexOf(!1)||l.indexOf(!1))&&(e=`#elem${a} .textarea`)),_.isValid(e)&&document.querySelector(e)&&document.querySelector(e).setAttribute("userans",t._userAns)}}))}(x))}function q(){try{console.log("runmodule"),C.readyFill(ajax_eId)}catch(t){if(f<=100)var e=setTimeout((()=>{q(),clearTimeout(e)}),50);else console.warn("Error at runModule function");f++}}function F(e,t,l=!1){let a=e,s=(e=(e=e.replace(/%{|}%/g,"")).split("|"))[0].replace(/user Response/g,"\\MathQuillMathField").split("##"),r=Math.floor(Math.random()*s.length),n=s[r],o=n.replace(/MathQuillMathField{(.*?)}/g,"MathQuillMathField{}"),d=0,c=n;l?l._userAns&&(o=l._userAns,l._userAnsSeq&&(c=l._anskey,r=l._userAnsSeq)):n.indexOf("MathQuillMathField")>-1&&(c=n,d=1),_.selectAll("#elem"+t,"hide");let u=`<div id="main_div" class="text-center filter auto_height fillelement mathitem inline-block"><div class="disable_div fh fwidth absolute h"></div><div class="remed_disable fh fwidth absolute h"></div><span  id="m${t}" style="display:none;" class="auto_height h corr_div fillmathelement mathquill" userAnsSeq="${r}" anskey="${c}" defaultans="${d}" mathtype="1">${c}</span>${`<span id="elem${t}" class="auto_height edit_step fillmathelement mathquill" userAnsSeq="${r}" userans="${o}" anskey="${c}" defaultans="${d}" mathtype="1"></span>`}</div>`;p=p.replace(a,u);let h=setInterval((()=>{if("function"==typeof MathQuill){clearInterval(h),_.selectAll("#elem"+t,"show");let e=MathQuill.getInterface(2);_.selectAll(".mathquill").forEach((t=>{let i=t.getAttribute("id");if(1==t.getAttribute("defaultans")){var l=t.getAttribute("userans");_.selectAll("#"+i,"text",l)}else _.selectAll("#"+i,"text",t.getAttribute("userans"));g[i]=e.StaticMath(document.getElementById(i))})),i(3,C.fillMath=g,C)}}),100)}function z(e,t,i=!1){var l="";i&&i._userAns&&(l=i._userAns);let a=e,s="",r=(e=(e=e.replace(/%{|}%/g,"")).split("|"))[1]&&"c"==e[1].trim()?"1":"",n=e[0].trim();if(-1!=n.indexOf("#style#")){let e=n.split("#style#");n=e[0],s=e[1]}let o=[],d=n.split(",");_.selectAll(d).forEach(((e,t)=>{o[t]=10*d[t].length+30}));let c=`<div id="elem${t}" class="fillelement">${`<input type="text" class="fillintheblank ks" anskey="${n.trim()}" value="${l}" userans="${l}" defaultans="" haskeywords="" codetype="${r}" hasnotkeywords="" keywordtype="" autocomplete="off" data-role="none" style="width:${Math.max(...o)}px;${s}" />`}</div>`;p=p.replace(a,c)}function N(e,t,i=!1){var l="";i&&i._userAns&&(l=i._userAns);let a=e,s="",r=(e=(e=e.replace(/%{|}%/g,"")).split("|"))[1]&&"c"==e[1].trim()?"1":"",n=e[0].trim();if(-1!=n.indexOf("#style#")){let e=n.split("#style#");n=e[0],s=e[1]}let o=[],d=n.split(",");_.selectAll(d).forEach(((e,t)=>{o[t]=10*d[t].length+30}));let c=`<div id="elem${t}" class="fillelement">${`<input type="number" onKeyDown="if(isNaN(event.key)){var key_arr = [13, 37, 38, 39, 40, 8, 69, 101, 46, 16, 9];if(!key_arr.includes(event.keyCode)) event.preventDefault()} "class="fillintheblank ks" anskey="${n.trim()}" value="${l}" userans="${l}" defaultans="" haskeywords="" codetype="${r}" hasnotkeywords="" keywordtype="" autocomplete="off" data-role="none" style="width: ${Math.max(...o)+20}px;${s}" />`}</div>`;p=p.replace(a,c)}function P(e,t,i=!1){let l=e,a=(e=(e=e.replace(/%{|}%/g,"")).split("|"))[0].trim();a=a.split(",").map((e=>e.trim()));let s='<option value="">&nbsp;Please Select</option>';_.selectAll(a).forEach(((e,t)=>{let l=0==a[t].indexOf("*")?"1":"0",r=0==a[t].indexOf("+")?'selected="selected"':"",n=0==a[t].indexOf("*")||0==a[t].indexOf("+")?a[t].slice(1):a[t],o="";if(i&&i._userAns){r="",t==i._userAns.split(",")[0].trim()-1&&(r='selected="selected"',o="1")}n=n.replace(/\#cm/gim,",").replace(/\#pl/gim,"+"),s+=`<option value="${t}" correctans="${l}" userans="${o}" ${r}>&nbsp;${n}</option>`}));let r=`<div id="elem${t}" class="fillelement">${`<select class="fillintheblank ks" data-role="none">${s}</select>`}</div>`;p=p.replace(l,r)}function O(e,t,i=!1){let l="";i&&i._userAns&&(l=i._userAns);let a=e,s=(e=(e=e.replace(/%{|}%/g,"")).split("|"))[0].trim(),r=JSON.parse(e[1]),n=`<div id="elem${t}" class="fillelement" style="height:auto">${`<textarea class="textarea ks" rows="${r.rows}" cols="${r.cols}" anskey="${s}" value="${l}" defaultans="${r.defaultAns?r.defaultAns:""}" userans="${l}" haskeywords="" hasnotkeywords="" keywordtype="1" autocomplete="off" data-role="none">${l}</textarea>`}</div>`;p=p.replace(a,n)}function H(e,t,l=!1){let a=e,s=(e=(e=e.replace(/%{|}%/g,"")).split("|"))[0].trim(),r="ds"==e[1].trim()?"1":"0",n=s.split(","),o="";_.selectAll(n).forEach(((e,t)=>{let i=!1,l=10*n[t].length+30,a=n[t],s=n[t].match(/i~|~i/g),d="";s?a=n[t].replace(/i~|~i/g,""):(o+="ID"+m+",",d="ID"+m+","),_.selectAll(h).forEach(((e,t)=>{h[t].ans==a&&(i=!0,s||(o=o.replace(d,""),o+=h[t].id+","))})),0==i&&h.push({ans:a,id:"ID"+m}),0==i&&(u+=`<div id="ID${m}" dragable="true" tabindex="0" class="drag-resize dragable ks" caption="${a.replace(/\#cm/gim,",").replace(/\"/gim,"#doublequote#")}" path="//s3.amazonaws.com/jigyaasa_content_static/" drag-single="${r}" bgcolor="#CCFFCC" style="background-color:#CCFFCC;height:auto;max-width:${l}px;padding:3px 10px 3px 10px; margin: 2px 2px;" aria-disabled="false">${a.replace(/\#cm/gim,",")}</div>`),0==i&&m++}));let d="";l&&l._userAns&&(d=l._userAns);let c='<div id="elem'+t+'" tabindex="0" dropzone="1" class="drag-resize dropable ks" path="//s3.amazonaws.com/jigyaasa_content_static/" anskey="'+o.slice(0,-1)+'" caption="" userans="'+d+'" droped="'+d+'" bgcolor="#FFFFCC" style="background-color: rgb(255, 255, 204); min-width: 50px; height: auto; padding: 5px 10px 5px;">'+d+"</div>";p=p.replace(a,c),i(5,A.footerStr=!0,A)}return w((()=>{window.J=v,C.setUpdate(j.bind(this)),_.addScript("",editor.baseUrlTheme+"clsSMFill/libs/mathQuill_new.js");let e=document.getElementById(R);e=e?e.getElementsByClassName("mathquill"):e,A.isMathquill&&_.selectAll("div"+ajax_eId,"css",{overflow:"auto"}),_.bind(ajax_eId,"click",T),_.bind(ajax_eId,"keyup",T),_.bind(ajax_eId,"change",T),_.listen(document,"click","span.mq-editable-field.mq-focused",S),_.listen(document,"change","span.mq-editable-field.mq-focused",S),y()})),k((e=>{if(s!=A.xml){if(o&&1==o.stopPreviewUpdate)return!1;y(),setTimeout((function(){let e=document.getElementById("previewArea");if(e.childNodes[0]&&"TABLE"==e.childNodes[0].nodeName){e=document.querySelectorAll("#previewArea td");for(let t in e)e[t].firstElementChild||"TD"!=e[t].nodeName||e[t].setAttribute("tabindex","0")}else for(let t in e.childNodes)if(3==e.childNodes[t].nodeType){let i=document.createElement("span");i.setAttribute("tabindex","0"),i.innerHTML=e.childNodes[t].textContent,e.childNodes[t].replaceWith(i)}}),1e3)}})),e.$$set=e=>{"manual_grade"in e&&i(1,a=e.manual_grade),"xml"in e&&i(2,s=e.xml),"uxml"in e&&i(11,r=e.uxml),"isReview"in e&&i(0,n=e.isReview),"editorState"in e&&i(12,o=e.editorState),"smValidate"in e&&i(13,d=e.smValidate),"showAns"in e&&i(14,c=e.showAns)},e.$$.update=()=>{1&e.$$.dirty[0]&&(n?I():L())},[n,a,s,C,l,A,undefined,I,L,function(e){i(5,A.showToolbar=e,A)},function(e,t){"c"==e?(C.showdragans(ajax_eId,"c",1),_.selectAll(".corr_div","show"),_.selectAll(".remed_disable","show"),D(1)):(C.showdragans(ajax_eId,"u",1),_.selectAll(".corr_div","hide"),D(1))},r,o,d,c,function(e){$[e?"unshift":"push"]((()=>{l=e,i(4,l)}))}]}export default class extends i{constructor(e){var t;super(),j.getElementById("svelte-zb1ued-style")||((t=r("style")).id="svelte-zb1ued-style",t.textContent='xmp{display:inline}[id^="fillmain"]{overflow:hidden;max-width:1024px;text-align:left}[id^="fillmain"] pre{background:none;border:none;font-size:14px!important}[id^="fillmain"] .string{min-height:50px;margin-top:10px;margin-right:10px}[id^="fillmain"] .footerStr{position:relative;margin-top:10px;background-color:#ccc;padding:15px;min-height:60px}[id^="fillmain"] .footerStr .arrow-up{position:absolute;top:-10px;right:50%;width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:10px solid #ccc}[id^="fillmain"] .fill-row{padding:6px}[id^="fillmain"] .fillelement, [id^="fillmain"] .drag-resize{height:30px;display:inline-block;position:relative;min-height:30px;margin:1px 0 1px 0;top:-3px}td .drag-resize{top:0 !important}td .fillelement{top:0px !important}[id^="fillmain"] input[type="text"], [id^="fillmain"] select{height:99%!important;resize:none;font-size:12px;color:#000;max-width:800px}[id^="fillmain"] .drag-resize{vertical-align:middle;border:1px solid #31B731;text-align:center;padding:3px;font-size:14px}[id^="fillmain"] .drag-resize.ui-draggable{cursor:move}[id^="fillmain"] .drop-hover{border:1px dashed red!important;box-shadow:0 0 0 2px yellow inset;outline:1px solid blue}[id^="fillmain"] .fillcheck ul{width:220px}[id^="fillmain"] .fillcheck li.selected{background-color:#E5E5E5}.fillcheck .selected .icomoon-checkmark-3:before{float:left;color:blue;padding:3px;position:relative;right:14px}.fillcheck .icomoon-close-2:before{float:left;color:blue;position:relative;right:14px;font-size:20px}.MathJax_Display{display:inline!important}[id^="fillmain"] .select{font-size:15px}[id^="fillmain"] .textarea{vertical-align:middle;border-radius:3px;background:#ffe;border:1px solid #ccc;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.ui-draggable-disabled{cursor:no-drop!important;opacity:0.5!important}.sel{border:2px solid #FF0000!important}.bla [id^="fillmain"] .dragable:focus, .bla [id^="fillmain"] .dropable:focus{box-shadow:inset 0 0 0 1px transparent, inset 0 0 0 1px #ffffff, inset 0 0 0 2px #fff;outline:none}.highlight_main{border:1px dashed #000}.copiedclr{background-color:#CCC!important}[id^="fillmain"] select::-ms-expand{margin-left:2px}.fillintheblank{height:30px;padding:5px 10px;font-size:14px;margin-bottom:3px;line-height:20px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;color:#555;background-color:#FFE;vertical-align:middle;background-image:none;border:1px solid #ccc;font-family:Helvetica,Arial,\'Times New Roman\',Verdana,sans-serif;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);-webkit-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.fillintheblank:focus{border-color:rgba(82,168,236,0.8);outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 8px rgba(82,168,236,0.6);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 8px rgba(82,168,236,0.6);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 8px rgba(82,168,236,0.6)}.correct_incorrect_icon_fill{position:absolute;width:17px;height:18px;right:-4px;top:-7px;font-size:17px;white-space:normal !important;z-index:9 !important}.corr_div{display:none;position:absolute;width:100%;height:100%;background-color:#21a81d;color:#ffffff;top:0%;padding-top:4px;border-radius:3px;cursor:none !important}.auto_height{height:auto!important}.prettyprint{display:-ms-grid!important}',n(j.head,t)),l(this,e,O,P,a,{manual_grade:1,xml:2,uxml:11,isReview:0,editorState:12,smValidate:13,showAns:14},[-1,-1])}}
//# sourceMappingURL=FillInTheBlanksPreview-d740fc47.js.map
