import{G as e,S as t,i as s,s as n,e as o,f as r,h as i,o as a,b as l,c,u,j as d,m as f,l as m,x as h,t as p,a as b,d as g,D as _,y as A,p as v,A as w,a1 as S,F as x,w as k,R as y,X as q}from"./main-ac89e9fe.js";import{I as L}from"./ItemHelper-6d042fa0.js";import{h as E}from"./hotkeys.esm-4c49bce2.js";import{S as C}from"./sortable.esm-143959dc.js";const M=new e;var I={};let T,P,D,j;I.ajax_eId="#choose",I.userAnsXML="",I.errorCatchFlag=1,M.listen(document,"keyup",".sm_input_text",(function(){""==document.querySelector(".sm_input_text").value&&document.querySelector(".add-option")?document.querySelector(".add-option").disabled=!0:document.querySelector(".add-option")&&(document.querySelector(".add-option").disabled=!1)})),I.update_XMLValue=function(){var e=[];if(M.selectAll(".choose_item_container textarea").forEach((t=>{if(t.value.length>0){const s=t.value.replace(/\r?\n/g,"||");M.prevElm(t,"input")&&M.prevElm(t,"input").checked?e.push("*"+s):e.push(s)}})),document.querySelector("#special_module_xml")){var t=document.querySelector("#special_module_xml").value;M.find(t,"list").setAttribute("headingCorrect",document.querySelector("#headingCorrect").value),M.find(t,"list").setAttribute("allowSort",document.querySelector("#allowSort").getAttribute("value")),M.find(t,"list").setAttribute("isSentence",document.querySelector("#isSentence").getAttribute("value")),M.find(t,"list").setAttribute("isParagraph",document.querySelector("#isParagraph").getAttribute("value")),M.find(t,"list").innerHTML="\x3c!--[CDATA["+e.join("\n")+"]]--\x3e",document.querySelector("#special_module_xml").value=formatXml(t.xml?t.xml:(new XMLSerializer).serializeToString(t[0]),!0)}},I.showAns=function(e,t,s){"c"==s?(I.review(e,1),I.sortList(e,"correct_seq")):"u"==s&&(I.review(e,0),I.sortList(e,"user_seq"))},I.sortList=function(e,t){var s=M.selectAll(e+" #sortable > li"),n=Array.from(s);n.sort((function(e,s){var n=parseInt(e.getAttribute(t));0===n&&(n=Number.MAX_VALUE);var o=parseInt(s.getAttribute(t));return 0===o&&(o=Number.MAX_VALUE),n-o})),M.selectAll(e+" #sortable > li").forEach((e=>{e.remove()})),n.forEach((t=>{M.find(e,"#sortable").append(t)}))},I.togseq=function(e){var t=M.find(e,"#sortable").getAttribute("checkSeq");M.find(e,"#sortable").setAttribute("checkSeq","1"==t?"0":"1"),M.find(e,"#instruction").innerHTML="1"==t?"":"Sequence Important"},I.review=function(e,t){var s=document.querySelector(e)?.querySelector("#sortable")?.getAttribute("checkSeq"),n=1==t?"is_correct":"user_answer",o=1==t?"correct_seq":"user_seq";"normal"==M.select(e).getAttribute?.("type")?M.find(e,"#sortable li","all").forEach((e=>{if("1"==s){if(1==e.getAttribute(n))var r=e.getAttribute(o);else r=0;M.find(e,".prefix").innerHTML=r>0?r:"",M.find(e,".prefix",{action:"removeClass",actionData:"tick"})}else 1==e.getAttribute(n)?M.find(e,".prefix",{action:"addClass",actionData:"tick"}):M.find(e,".prefix",{action:"removeClass",actionData:"tick"});1==e.getAttribute("user_answer")&&0==t||1==e.getAttribute("is_correct")&&1==t?e.classList.add("choose_sel"):e.classList.remove("choose_sel")})):"sentence"!=M.select(e).getAttribute?.("type")&&"paragraph"!=M.select(e).getAttribute?.("type")||I.setActiveClass(e,t)},I.CheckResultchoose=function(e){let t={};var s=!0,n=0;let o=M.find(e,"#sortable");var r=Array.isArray(o)?"":o.getAttribute("checkSeq"),i="";return M.find(e,"#sortable li","all").forEach((e=>{var t=e.getAttribute("user_seq"),o=e.getAttribute("user_answer");"1"==r?(t!=e.getAttribute("correct_seq")&&(s=!1),"undefined"!=typeof calculatePoint&&e.getAttribute("correct_seq")>0&&t==e.getAttribute("correct_seq")&&n++):(o!=e.getAttribute("is_correct")&&(s=!1),"undefined"!=typeof calculatePoint&&e.getAttribute("is_correct")>0&&o==e.getAttribute("is_correct")&&n++),i+=e.getAttribute("optID")+"|"+t+"|"+o+","})),"undefined"!=typeof calculatePoint&&calculatePoint(M.find(e,"#sortable").getAttribute("totalCorrectAns"),n),I.userAnsXML='<SMANS type="6"><list useranswer="'+i+'" /></SMANS>',t.u=I.userAnsXML,t.b=s,t},I.touchHandler=function(e){var t=e.changedTouches[0],s="";switch(e.type){case"touchstart":s="mousedown";break;case"touchmove":s="mousemove";break;case"touchend":s="mouseup";break;default:return}var n=document.createEvent("MouseEvent");n.initMouseEvent(s,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)},I.init=function(e){document.addEventListener("touchstart",I.touchHandler,!0),document.addEventListener("touchmove",I.touchHandler,!0),document.addEventListener("touchend",I.touchHandler,!0),document.addEventListener("touchcancel",I.touchHandler,!0),M.bind(e,"touchstart",(function(e){e.preventDefault()})),M.bind(e,"touchmove",(function(e){e.preventDefault()}))},I.shouldselect=!1,I.readyThis=function(e){(null!=typeof isTouchable||isiPad)&&setTimeout((function(){M.find(e,"#sortable").removeAttribute("onmouseup"),M.listen(M.find("body",e),"click","#sortable",(function(){var t=window.event;I.ow=t.srcElement?t.srcElement:t.target,I.t=setTimeout((function(){I.setUserAns(e,I.ow,I.shouldselect)}),100)})),"0"!=document.querySelector("#sortable").getAttribute("checkseq")&&new C(M.find(e,"#sortable"),{onEnd:function(t){I.ow=t.srcElement?t.srcElement:t.target,I.t=setTimeout((function(){I.setUserAns(e,I.ow,I.shouldselect)}),100)}})}),200)},I.bindKeyup=function(e){var t=0;function s(e,t=1){if(e.id){let s=M.selectAll(".ks"),n=-1;for(let o=0;o<s.length;o++)if(e.id==s[o].id){n=t?o==s.length-1?0:o+1:0==o?s.length-1:o-1;break}-1!=n&&s[n].focus()}}function n(){var s,n;t=0,s=M.find(e,"#sortable .copied"),n=M.find(e,".ks").length,s.classList.contains("copied")&&(0==t?s.insertBefore(M.find(e,".ks:nth(0)")):s.insertAfter(M.find(e,".ks:nth("+t+")"))),M.find(e,".ks:nth("+t+")").focus(),t==n-1?t=0:t++}function o(){var e=!1;let t=M.selectAll("#sortable li"),s=M.select(":focus");if(s.nodeName){let n=s.getAttribute("id");for(let s=0;s<t.length;s++)if(n==t[s].getAttribute("id")){e=!0;break}}return e}E.unbind("down,up,enter,alt+down,delete,left,right,tab,shift+tab,esc","choose"+e),M.find(e,"#sortable li","all").forEach((e=>{e.classList.add("ks")})),M.bind(document,"click",(function(){o()||M.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"})})),M.listen(document,"keydown",e,(function(){E.setScope("choose"+e)})),E("down, up, enter, alt+down, delete, left, right, tab, shift+tab, esc","choose"+e,(function(t,r){switch(r.key){case"up":case"left":if(o()){var i=M.find(e,"#sortable .copied"),a=M.find(e,".ks").length;let n=M.select(".ks:focus"),o=M.selectAll(".ks")[0];n.id==o.id?i&&i.classList.contains("copied")?(i.insertAfter(M.find(e,".ks:nth("+(a-1)+")")),i.focus()):M.selectAll(".ks")[M.selectAll(".ks").length-1].focus():i&&i.classList.contains("copied")?(i.insertBefore(M.find(e,"#sortable .copied").previousElementSibling),i.focus()):s(n,0),t.preventDefault()}break;case"down":case"right":if(o()){console.log("check");i=M.find(e,"#sortable .copied"),M.selectAll(e+" .ks").length;let n=M.select(".ks:focus"),o=M.selectAll(".ks")[M.selectAll(".ks").length-1];if(n.id==o.id)i&&i.classList.contains("copied")?(i.insertBefore(M.find(e,".ks:nth(0)")),i.focus()):M.selectAll(".ks")[0].focus();else if(i&&i.classList.contains("copied")){var l=M.find(e,"#sortable .copied").nextSibling.cloneNode(!0);i.insertAfter(l,M.find(e,"#sortable .copied").nextSibling),i.focus()}else s(n,1);t.preventDefault()}break;case"enter":o()&&(t.preventDefault(),"0"==M.find(e,"#sortable").getAttribute("checkseq")?(I.ow=M.find(e,"#sortable li:focus","all")[0],I.t=setTimeout((function(){I.setUserAns(e,I.ow,!0)}),100)):"1"==M.find(e,"#sortable").getAttribute("checkseq")&&(M.find(e,"#sortable li:focus").classList.contains("copied")?(I.ow=M.find(e,"#sortable li:focus","all")[0],I.t=setTimeout((function(){I.setUserAns(e,I.ow,!M.find(e,"#sortable li:focus").classList.contains("choose_sel"))}),100),M.find(e,"#sortable li:focus",{action:"removeClass",actionData:"copied"})):(I.ow=M.find(e,"#sortable li:focus","all")[0],I.t=setTimeout((function(){I.setUserAns(e,I.ow,!M.find(e,"#sortable li:focus").classList.contains("choose_sel"))}),100),M.find(e,"#sortable li:focus",{action:"addClass",actionData:"copied"}))));break;case"alt+down":n();break;case"delete":o()&&(I.ow=M.find(e,"#sortable li:focus","all")[0],I.t=setTimeout((function(){I.setUserAns(e,I.ow,!0)}),100));break;case"tab":o()&&M.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"});let r=M.selectAll(".ks:focus"),c=M.selectAll(".ks")[M.selectAll(".ks").length-1];r.id==c.id&&(t.preventDefault(),M.selectAll(".ks")[0].focus());break;case"shift+tab":o()&&M.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"}),r=M.selectAll(".ks:focus"),c=M.selectAll(".ks")[M.selectAll(".ks").length-1],r.id==c.id&&(t.preventDefault(),M.selectAll(".ks")[M.selectAll(".ks").length].focus());break;case"esc":o()&&(t.preventDefault(),M.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"}),M.selectAll(".ks")[M.selectAll(".ks").length-1].focus(),M.selectAll(".ks")[M.selectAll(".ks").length-1].blur())}})),E.setScope("choose"+e)},I.cmd=function(e,t){I.shouldselect=!0},I.cmm=function(e,t){t||(t=window.event);var s=t.srcElement?t.srcElement:t.target;if(s.classList.contains("prefix")&&(s=s.parentElement),s){var n=s.getAttribute("user_answer");I.shouldselect=!1,"0"==n&&(I.shouldselect=!0)}},I.cmu=function(e,t,s=!1){s?I.ow=t:(t||(t=window.event),I.ow=t.srcElement?t.srcElement:t.target),I.ow.classList.contains("prefix")&&(I.ow=I.ow.parentElement),I.t=setTimeout((function(){I.setUserAns(e,I.ow,I.shouldselect)}),100)},I.setUserAns=function(e,t,s){if("IMG"==t.tagName?(T=M.parent(t,"li").getAttribute("user_answer"),P=M.parent(t,"li").getAttribute("user_seq"),D=M.find(e,"#sortable").getAttribute("checkSeq")):(T=t.getAttribute("user_answer"),P=t.getAttribute("user_seq"),D=M.find(e,"#sortable").getAttribute("checkSeq")),"UL"!=t.tagName){if(s)if("1"==T)if("IMG"==t.tagName){let e=M.parent(t,"li");M.setAttr(e,{user_answer:0}),e.classList.remove("choose_sel"),"1"!=D&&M.find(e,".prefix","all").classList.remove("tick")}else M.setAttr(t,{user_answer:0}),t.classList.remove("choose_sel"),"1"!=D&&M.find(t,".prefix",{action:"removeClass",actionData:"tick"});else if("IMG"==t.tagName){if(M.find(document.querySelector(t).parentElement,"li","all").setAttribute("user_answer",1),M.select(t.parentElement).classList.add("choose_sel"),"1"!=D){let e=M.parent(t,"li");M.find(e,".prefix").classList.add("tick")}}else M.setAttr(t,{user_answer:1}),t.classList.add("choose_sel"),"1"!=D&&M.find(t,".prefix",{action:"addClass",actionData:"tick"});if("1"==D){var n=1;M.find(e,"#sortable li","all").forEach((e=>{1==e.getAttribute("user_answer")?(M.find(e,".prefix").innerHTML=n,M.setAttr(e,{user_seq:n}),n++):(M.find(e,".prefix").innerHTML="",M.setAttr(e,{user_seq:0}))}))}I.CheckResultchoose(e),I.shouldselect=!1}else I.shouldselect=!1},I.removeItem=function(){M.remove(e1.parentElement.parentElement),document.querySelectorAll(".choose_item_container").innerHTML.trim().length<=200?document.querySelector(".message_content").style.display="block":document.querySelector(".message_content").style.display="none"},I.addItem=function(){document.querySelector(".message_content").style.display="none",M.insert(".choose_item_container",'<div class="clearfix mt choose_options"><div class="col-md-12 mt-head"><input class="choose_compls" type="checkbox"><textarea></textarea><span class="remove-item icomoon-24px-delete-1"></span></div></div>',"afterbegin")},I.setDragSequence=function(e,t,s){var n=1;M.find(e,"#sortable li","all").forEach((e=>{M.setAttr(e,{user_seq:n}),n++})),0==s&&M.find(e,"#sortable li","all").forEach((e=>{e.classList.remove("choose_sel")})),I.CheckResultSentenceChoose(e)},I.CheckResultSentenceChoose=function(e){var t=!0;let s={};D=M.find("#choose","#sortable").getAttribute("checkSeq");var n="";return M.find(e,"#sortable li","all").forEach((e=>{P=e.getAttribute("user_seq"),j=e.getAttribute("correct_seq"),T=e.getAttribute("user_answer"),P!=j&&0!=e.getAttribute("correct_seq")&&(t=!1),n+=e.getAttribute("optID")+"|"+P+"|"+T+","})),I.userAnsXML='<SMANS type="6"><list useranswer="'+n+'" /></SMANS>',ISSPECIALMODULEUSERXMLCHANGE=1,document.querySelector("#special_module_user_xml")&&(document.querySelector("#special_module_user_xml").value=I.userAnsXML),document.querySelector("#answer")&&M.setAttr("#answer",{checked:t}),s.u=I.userAnsXML,s.ans=t,s},I.dragSenParItem=function(e){new C(M.find(e,"#sortable"),{onStart:function(e){console.log("start =>"+e)},onEnd:function(t){console.log("end =>"+t),I.setDragSequence(e,t.item)}}),I.CheckResultchoose(e)},I.setActiveClass=function(e,t){M.find(e,"#sortable").getAttribute("checkSeq");M.find(e,"#sortable li","all").forEach((e=>{1==e.getAttribute("user_answer")&&0==t||1==e.getAttribute("is_correct")&&1==t?e.classList.add("choose_sel"):e.classList.remove("choose_sel")}))},I.removeActive=function(e){M.find(e,"#sortable li","all").forEach((e=>{e.classList.remove("choose_sel")}))},I.labBinded=!0,I.sortable=!1,I.modeOn=function(e){M.selectAll(".test","addClass","h"),M.selectAll(".review","addClass","h"),e?(M.selectAll(".review","removeClass","h"),I.unBindLab(),void 0!==E&&E.unbind("down,up,enter,alt+down,delete,left,right,tab,shift+tab,esc","choose"+I.ajax_eId),M.find(I.ajax_eId,".copied","all").forEach((e=>{e.classList.remove("copied")})),null!=document.querySelector("#show_ans_group button")&&document.querySelector("#show_ans_group button").forEach((e=>{e.classList.contains("correct-ans btn-primary")?I.showAns(I.ajax_eId,e,"c"):e.classList.contains("your-ans btn-primary")&&I.showAns(I.ajax_eId,e,"u")}))):(M.selectAll(".test","removeClass","h"),setTimeout((function(){I.callBindKey()}),100),I.review(I.ajax_eId,0),I.bindLab())},I.callBindKey=function(){void 0!==E?I.bindKeyup(I.ajax_eId):(I.errorCatchFlag<=50?setTimeout((function(){I.callBindKey()}),100):console.log("hotkeys not found"),I.errorCatchFlag++)},I.unBindLab=function(){I.labBinded=!1,"normal"==document.querySelector(I.ajax_eId).getAttribute("type")&&M.find(I.ajax_eId,"#sortable").removeAttribute("onmouseup onmousemove onmousedown"),M.find(I.ajax_eId,"#sortable").classList.contains("ui-sortable")&&(I.sortable=!0)},I.bindLab=function(){I.labBinded=!0,M.bind(document.querySelector("#sortable"),"mouseup",(function(e){I.cmu(I.ajax_eId,e)})),M.bind(document.querySelector("#sortable"),"mousemove",(function(e){I.cmm(I.ajax_eId,e)})),M.bind(document.querySelector("#sortable"),"mousedown",(function(e){I.cmd(I.ajax_eId,e)})),Array.isArray(M.find(I.ajax_eId,"#sortable"))||new C(M.find(I.ajax_eId,"#sortable"),{animation:150,onEnd:function(e){I.cmu(I.ajax_eId,e.item,!0),M.select(I.ajax_eId).click()}}),"sentence"!=document.querySelector(I.ajax_eId)?.getAttribute?.("type")&&"paragraph"!=document.querySelector(I.ajax_eId)?.getAttribute?.("type")||I.dragSenParItem(I.ajax_eId)};const{document:X}=x;function N(e,t,s){const n=e.slice();return n[26]=t[s],n[28]=s,n}function R(e){let t,s,n,l,c,u,d,f,m,h,p=e[9](e[26])+"";return{c(){t=o("li"),r(t,"key",s=e[28]),r(t,"class",n="1"==e[3].isSentence?"sentence_li":"1"==e[3].isParagraph?"paragraph_li":""),r(t,"is_correct",l=e[26].isCorrect),r(t,"optid",c=e[26].optid),r(t,"correct_seq",u=e[26].seq),r(t,"user_answer",d=e[26].user_answer),r(t,"u",f=e[26].user_answer),r(t,"user_seq",m=e[26].user_seq?e[26].user_seq:e[28]),r(t,"id",h="id"+e[28]),r(t,"tabindex","0")},m(e,s){i(e,t,s),t.innerHTML=p},p(e,s){4&s&&p!==(p=e[9](e[26])+"")&&(t.innerHTML=p),8&s&&n!==(n="1"==e[3].isSentence?"sentence_li":"1"==e[3].isParagraph?"paragraph_li":"")&&r(t,"class",n),4&s&&l!==(l=e[26].isCorrect)&&r(t,"is_correct",l),4&s&&c!==(c=e[26].optid)&&r(t,"optid",c),4&s&&u!==(u=e[26].seq)&&r(t,"correct_seq",u),4&s&&d!==(d=e[26].user_answer)&&r(t,"user_answer",d),4&s&&f!==(f=e[26].user_answer)&&r(t,"u",f),4&s&&m!==(m=e[26].user_seq?e[26].user_seq:e[28])&&r(t,"user_seq",m)},d(e){e&&a(t)}}}function U(e){let t;return{c(){t=u("Sequencing of the selected item is not required. Click to select items.")},m(e,s){i(e,t,s)},d(e){e&&a(t)}}}function H(e){let t;return{c(){t=u("Click to select. Drag and Drop to set sequence.")},m(e,s){i(e,t,s)},d(e){e&&a(t)}}}function $(e){let t,s,n,v,w,S,x,k,y,q,E,C,M,I,T,P,D,j,$,B,O,G,F,K=e[3].headingCorrect+"";x=new L({props:{handleReviewClick:e[10],reviewMode:e[0]}}),x.$on("setReview",e[4]),x.$on("unsetReview",e[5]);let J=e[2],V=[];for(let t=0;t<J.length;t+=1)V[t]=R(N(e,J,t));function z(e,t){return 1==e[3].allowSort||1==e[3].isSentence||1==e[3].isParagraph?H:U}let Y=z(e),Q=Y(e);return{c(){t=o("link"),n=l(),v=o("main"),w=o("div"),S=o("center"),c(x.$$.fragment),k=l(),y=o("center"),q=o("div"),E=o("div"),C=u(K),M=l(),I=o("ul");for(let e=0;e<V.length;e+=1)V[e].c();j=l(),$=o("div"),Q.c(),r(t,"onload","this.rel='stylesheet'"),r(t,"rel","preload"),r(t,"as","style"),r(t,"href",s=baseUrlTheme+"clsSMChoose/css/choose.min.css"),r(E,"class","choose_header font17 pl-4"),r(I,"id","sortable"),r(I,"totalcorrectans",T=e[3].totalcorrectans),r(I,"checkseq",P=e[3].allowSort),r(I,"class","ui-sortable w-auto mt-0 p-2"),r(I,"style",D="border-left:10px solid #d9e7fd;border-right: 10px solid #d9e7fd"),r($,"class","choose_bottom pl-4"),r($,"id","instruction"),r(q,"id",e[1]),r(q,"type",B="1"==e[3].isSentence?"sentence":"1"==e[3].isParagraph?"paragraph":"normal"),r(q,"class","bg-white")},m(s,o){d(X.head,t),i(s,n,o),i(s,v,o),d(v,w),d(w,S),f(x,S,null),d(w,k),d(w,y),d(y,q),d(q,E),d(E,C),d(q,M),d(q,I);for(let e=0;e<V.length;e+=1)V[e].m(I,null);d(q,j),d(q,$),Q.m($,null),O=!0,G||(F=[m(I,"mouseup",e[6].bind(this)),m(I,"mousemove",e[7].bind(this)),m(I,"mousedown",e[8].bind(this))],G=!0)},p(e,[t]){const s={};if(1&t&&(s.reviewMode=e[0]),x.$set(s),(!O||8&t)&&K!==(K=e[3].headingCorrect+"")&&h(C,K),524&t){let s;for(J=e[2],s=0;s<J.length;s+=1){const n=N(e,J,s);V[s]?V[s].p(n,t):(V[s]=R(n),V[s].c(),V[s].m(I,null))}for(;s<V.length;s+=1)V[s].d(1);V.length=J.length}(!O||8&t&&T!==(T=e[3].totalcorrectans))&&r(I,"totalcorrectans",T),(!O||8&t&&P!==(P=e[3].allowSort))&&r(I,"checkseq",P),Y!==(Y=z(e))&&(Q.d(1),Q=Y(e),Q&&(Q.c(),Q.m($,null))),(!O||2&t)&&r(q,"id",e[1]),(!O||8&t&&B!==(B="1"==e[3].isSentence?"sentence":"1"==e[3].isParagraph?"paragraph":"normal"))&&r(q,"type",B)},i(e){O||(p(x.$$.fragment,e),O=!0)},o(e){b(x.$$.fragment,e),O=!1},d(e){a(t),e&&a(n),e&&a(v),g(x),_(V,e),Q.d(),G=!1,A(F)}}}function B(e,t,s){let{cmed:n}=t,{showAns:o}=t,{xml:r}=t,{stopPreviewUpdate:i}=t,{editorState:a}=t,{isReview:l}=t,{uaXML:c}=t,u=n?"choose"+n:"choose";I.ajax_eId=n?"#choose"+n:"#choose";var d=[];let f={};k({xml:"",headingCorrect:"",allowSort:"",isSentence:"",isParagraph:"",chooseClass:"",totalcorrectans:"",stateXMLToJSON:""}).subscribe((e=>{s(3,f=e)}));function m(){var e="";e=("1"==f.isSentence||f.isParagraph,I.CheckResultchoose("#"+u)),y({uXml:e.u,ans:e.b}),a&&o(e.b)}function h(){console.log("checking"),b("none"),I.modeOn("on"),s(0,l=!0),I.review("#"+u,0),w.removeClass("#show_ans_group button","active"),w.removeClass("#show_ans_group .your-ans","active"),m()}function p(){b("auto"),s(0,l=!1),I.modeOn(),I.review("#"+u,0)}function b(e){w.selectAll("#sortable li").forEach((t=>{t.style.pointerEvents=e}))}return v((()=>{w.bind(document,"click",(function(){if(document.querySelector(".editorRender"))return document.querySelector(".editorRender").clientHeight})),w.listen(document,"click","#"+u,(function(){setTimeout((function(){m()}),100)})),w.listen(document,"click","#show_ans_group button",(e=>{w.removeClass("#show_ans_group button","active"),w.addClass(e,"active")}))})),S((()=>{if(r!=f.xml){if(1==i)return!1;n&&(s(1,u="choose"+n),I.ajax_eId="#choose"+n),s(3,f.xml=r,f),s(3,f.stateXMLToJSON=q(r),f),function(e){if(function(e){try{s(2,d=[]);let n=e.smxml.list.__cdata.split("\n"),o=1,r=0,i=0;n.forEach((function(e,t){""!=n[t].trim()&&("*"==n[t].trim().charAt(0)&&r++,d.push({value:n[t].trim(),isCorrect:"*"==n[t].trim().charAt(0)?"1":"0",seq:"*"==n[t].trim().charAt(0)?o:"0",user_answer:"0",optid:i}),"*"==n[t].trim().charAt(0)&&o++,i++)})),function(e){for(var t=e.length-1;t>0;t--){var s=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[s],e[s]=n}}(d),e=function(e){let t=e;return t.smxml.list._headingCorrect&&(t.smxml.list._headingcorrect=t.smxml.list._headingCorrect,delete t.smxml.list._headingCorrect),t.smxml.list._allowSort&&(t.smxml.list._allowsort=t.smxml.list._allowSort,delete t.smxml.list._allowSort),t.smxml.list._isParagraph&&(t.smxml.list._isparagraph=t.smxml.list._isParagraph,delete t.smxml.list._isParagraph),t.smxml.list._isSentence&&(t.smxml.list._issentence=t.smxml.list._isSentence,delete t.smxml.list._isSentence),t}(e),s(3,f.headingCorrect=e.smxml.list._headingcorrect,f),s(3,f.allowSort=e.smxml.list._allowsort?e.smxml.list._allowsort:"0",f),s(3,f.isSentence=e.smxml.list._issentence?e.smxml.list._issentence:"0",f),s(3,f.isParagraph=e.smxml.list._isparagraph?e.smxml.list._isparagraph:"0",f),s(3,f.totalcorrectans=r,f);var t=setTimeout(function(){w.find("#sortable",".sentence_li","all").forEach((function(e,t){e.setAttribute("user_seq",t+1)})),clearTimeout(t)}.bind(this),200)}catch(e){this.onError=e,console.warn({error:e.message,"function name":"parseXMLPreview","File name":"ChooseNReorderPreview.js"})}}(e),c){let e=q(c);if(e&&e.SMANS&&e.SMANS&&e.SMANS.list){let t=e.SMANS.list._useranswer.split(","),n=[];for(let e in t)if(t[e]){let o=t[e].split("|");for(let e in d)d[e].optid==o[0]&&(s(2,d[e].user_answer=o[2],d),s(2,d[e].user_seq=o[1],d),n.push(d[e]))}s(2,d=n)}}}(f.stateXMLToJSON);var e=setTimeout((function(){c||(w.selectAll("#sortable li").forEach((e=>{e.setAttribute("user_answer","0"),e.setAttribute("style","")})),w.selectAll("#sortable li .prefix").forEach((e=>{e.innerHTML=""}))),I.removeActive("#"+u),I.review("#"+u,0),I.init("#"+u),I.CheckResultchoose("#"+u);new C(w.find("#"+u,"#sortable"),{animation:150});"1"==f.allowSort&&"1"!=f.isSentence&&"1"!=f.isParagraph||new C(w.find("#"+u,"#sortable"),{onEnd(e){e.item;e.to,e.from,e.oldIndex,e.newIndex,e.oldDraggableIndex,e.newDraggableIndex,e.clone,e.pullMode}}),"1"!=f.isSentence&&"1"!=f.isParagraph||I.dragSenParItem("#"+u),clearTimeout(e)}),200)}})),e.$$set=e=>{"cmed"in e&&s(11,n=e.cmed),"showAns"in e&&s(12,o=e.showAns),"xml"in e&&s(13,r=e.xml),"stopPreviewUpdate"in e&&s(14,i=e.stopPreviewUpdate),"editorState"in e&&s(15,a=e.editorState),"isReview"in e&&s(0,l=e.isReview),"uaXML"in e&&s(16,c=e.uaXML)},e.$$.update=()=>{1&e.$$.dirty&&setTimeout((function(){l?h():p()}),200)},[l,u,d,f,h,p,function(e){"1"!=f.isSentence&&"1"!=f.isParagraph&&I.cmu("#"+u,e)},function(e,t){"1"!=f.isSentence&&"1"!=f.isParagraph&&I.cmm(e,t)},function(e,t){"1"!=f.isSentence&&"1"!=f.isParagraph&&(I.cmd(e,t),ISSPECIALMODULEUSERXMLCHANGE=1)},function(e){return'<div class="prefix pl-2 position-relative mr-2"'+("1"==f.isSentence?"nw":"")+'"></div>'+("1"==f.isParagraph?'<div class="pg_handle">&equiv;</div>':"")+("*"==e.value.charAt(0)?e.value.slice(1):e.value)},function(e,t){"c"==e?I.showAns("#"+u,t.currentTarget,"c"):I.showAns("#"+u,t.currentTarget,"u")},n,o,r,i,a,c]}export default class extends t{constructor(e){super(),s(this,e,B,$,n,{cmed:11,showAns:12,xml:13,stopPreviewUpdate:14,editorState:15,isReview:0,uaXML:16})}}
//# sourceMappingURL=ChooseNReorderPreview-fee30e56.js.map
