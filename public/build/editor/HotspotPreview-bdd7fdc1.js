import{E as t,S as e,i,s,D as n,e as a,b as r,f as o,h as l,j as c,k as d,a as h,n as p,t as m,o as u,p as g,X as w,A as f,W as x,r as v,c as b,m as y,d as A,q as _,g as S,u as k,K as C,_ as I,l as N,$ as M}from"./main-e1047681.js";import{I as T}from"./ItemHelper-dc05db53.js";import{s as L}from"./style-inject.es-1f59c1d0.js";const D=new t;class ${constructor(){this.userAnsXML="<SMANS></SMANS>",this.xaxis=[],this.yaxis=[],this.count=0,this.drawstr="",this.elemId="#hptmain0",this.labBinded=!0,this.result=!1,this.temp=0}readyThis(t,e,i,s){if(t="#"+t,!e){this.labBinded=!0;const e=function(e){if(this.labBinded){let i=e,s="";i.classList.contains("selected")?(i.setAttribute("data-userans",0),i.classList.remove("selected")):(i.setAttribute("data-userans",1),i.classList.add("selected")),D.find(t,"[type] .textClick.selected","all").forEach((function(t,e){s=0==e?t.textContent:s+"|"+t.textContent})),D.find(t,"[type]",{action:"attr",actionData:{"data-userans":s}})}},i=function(e){if(this.labBinded){let i="";"SPAN"==e.target?.nodeName?(D.select(e.target,"removeClass",["selecttext","selected"]),this.removespan(e.target,t,0)):this.highlightText(t),D.find(t,"[type] .selecttext.selected","all").forEach((function(t,e){i=0==e?t.textContent:i+"|"+t.textContent}));let s=D.find(t,"[type]");D.select(s,"attr",{"data-userhtml":s.innerHTML,"data-userans":i})}};D.listen(t,"touchstart",".textClick",e.bind(this)),D.listen(t,"touchend",".textClick",e.bind(this)),D.listen(t,"click",".textClick",e.bind(this)),D.listen(t,"touchstart",'[type="textselect"]',i.bind(this)),D.listen(t,"touchend",'[type="textselect"]',i.bind(this)),D.listen(t,"click",'[type="textselect"]',i.bind(this))}}check_Ans(t){let e={inNativeIsCorrect:!1,userAnswers:""};this.userAnsXML="<smans type='4'>\\n",this.result=!0,this.temp=0;let i=D.select(t).children;for(let e=0;e<i.length;e++)this.userAnsXML=this.checkChildAnswer(t,i[e],this.userAnsXML);return this.userAnsXML+="</smans>",window.ISSPECIALMODULEUSERXMLCHANGE=1,e.userAnswers=D.select("#special_module_user_xml").value,"undefined"!=typeof calculatePoint&&calculatePoint(D.select(t).getAttribute("totalcorrectans"),temp),window.inNative&&(window.getHeight?.(),e.inNativeIsCorrect=this.result,window.postMessage(JSON.stringify(e),"*")),{uXml:this.userAnsXML,ans:this.result}}checkChildAnswer(t,e,i){let s=e.getAttribute("type");switch(s){case"textclick":case"textselect":var n=e.getAttribute("data-correctans").split("|").sort().join("|"),a=e.getAttribute("data-userans").split("|").sort();n!=(a=(a=a.filter((function(t){return t}))).join("|"))&&(this.result=!1),"undefined"!=typeof calculatePoint&&D.find(e,"p","all").forEach((t=>{t.classList.contains("selected")&&t.getAttribute("data-userans")==t.getAttribute("data-correctans")&&this.temp++})),this.userAnsXML+="textselect"==s?`<div id="${e.getAttribute("id")}" data-userHtml="${escape(e.getAttribute("data-userhtml"))}" data-userAns="${escape(e.getAttribute("data-userans"))}"></div>\\n`:`<div id="${e.getAttribute("id")}" data-userAns="${escape(e.getAttribute("data-userans"))}"></div>\\n`}return this.userAnsXML}showansdrag(t,e,i){void 0===i&&(i=0);let s=D.select(t).children;if(s)for(let n=0;n<s.length;n++)this.showchilddragans(t,s[n],e,i)}showchilddragans(t,e,i,s){let n=D.select(e);switch(n.getAttribute("type")){case"textclick":if("c"==i){D.find(n,".show_correct,.show_incorrect","all").length>0&&(D.find(n,".show_correct,.show_incorrect",{action:"removeClass",actionData:["show_correct","show_incorrect"]}),D.find(n,".correct_incorrect_icon",{action:"remove"}),D.find(n,".correct_incorrect_icon",{action:"removeAttr",actionData:"style"}));let s=e.getAttribute("data-correctans").split("|");e.getAttribute("type");s.forEach((e=>{this.selectText(t,e,i,"selected")}))}else if("u"==i){e.getAttribute("type");try{var a=decodeURIComponent(e.getAttribute("data-userans"))}catch(t){a=decodeURIComponent(unescape(e.getAttribute("data-userans")))}if(a=(a=a.split("|")).filter((function(t){return t})),void 0!==s&&1==s){D.find(t,".selected",{action:"removeClass",actionData:"selected"});var r=e.getAttribute("data-correctans").split("|");a.forEach((e=>{let s="show_incorrect";D.findInArray(e,r)?(s="show_correct",this.selectText(t,e,i,s)):this.selectText(t,e,i,s)}))}else a.forEach((e=>{this.selectText(t,e,"c","selected"),D.select(t+" p span").length&&D.select(t+" p span").remove(),D.select(".textClick","removeClass",["show_incorrect","show_correct"])}))}break;case"textselect":if("c"==i){D.find(n,".show_correct,.show_incorrect").length>0&&(D.find(n,".show_correct,.show_incorrect",{action:"removeClass",actionData:["show_correct","show_incorrect"]}),D.find(n,".correct_incorrect_icon",{action:"removeAttr",actionData:"style"}));r=e.getAttribute("data-correctans").split("|"),e.getAttribute("type");D.select(e,"html",e.getAttribute("data-correcthtml").replace(/<span>/g,"</span>"))}else if("u"==i){e.getAttribute("type");try{a=decodeURIComponent(e.getAttribute("data-userans"))}catch(t){a=decodeURIComponent(unescape(e.getAttribute("data-userans")))}if(a=(a=a.split("|")).filter((function(t){return t})),""!=e.getAttribute("data-userhtml")||"undefined"==e.getAttribute("data-userhtml")){var o=e.getAttribute("data-userhtml");try{o=decodeURIComponent(o);var l=decodeURIComponent(o)}catch(t){console.log(t)}D.select(e,"html",l)}if(void 0!==s&&1==s){let t='<span class="icomoon-new-24px-checkmark-circle-1 font-weight-bold" style="color:green;vertical-align:super;">',i='<span class="icomoon-new-24px-cancel-circle-1 font-weight-bold red" style="vertical-align: super;">';D.insert(e.querySelector('span[userans="1"]span[correctans="1"]'),'<span class="correct_incorrect_icon" style="position:absolute;z-index:100;width:18px;height:18px;bottom:17px;background:white;border-radius:12px;font-size: 18px;"> '+t+"</span></span>","beforeend"),D.insert(e.querySelector('span[userans="1"]span[correctans="0"]'),'<span class="correct_incorrect_icon" style="position:absolute;z-index:100;width:18px;height:18px;bottom:17px;background:white;border-radius:12px;font-size: 18px;"> '+i+"</span></span>","beforeend")}}break;case"imagehighlight":{let e=D.find(t,"canvas"),s=D.select("#special_module_parse").value,n=s.substring(s.indexOf("{"),s.lastIndexOf("}")+1);if(""!=n&&(n=JSON.parse(n)),this.drawOnCanvas(e,n,window.color),"c"==i){let t=e.getAttribute("correctans");""!=t&&(t=JSON.parse(t)),this.drawOnCanvas(e,t,"green")}break}}}calculateArea(t,e,i){return{top:Math.min.apply(Math,i),left:Math.min.apply(Math,e),width:Math.max.apply(Math,e)-Math.min.apply(Math,e),height:Math.max.apply(Math,i)-Math.min.apply(Math,i)}}getCoordinate(t,e,i,s){return 0==s?this.drawstr='{"'+ ++s+'":{"x":['+e+'],"y":['+i+"]}}":(this.drawstr=D.select("#special_module_parse").value,this.drawstr=this.drawstr.substring(this.drawstr.indexOf("{"),this.drawstr.lastIndexOf("}")+1),this.drawstr=this.drawstr.slice(0,-1),this.drawstr+=',"'+ ++s+'":{"x":['+e+'],"y":['+i+"]}}"),D.selectAll(D.select(t).children,"attr",{userans:this.drawstr}),this.createUserAnsXMLDraw(this.drawstr),this.userAnsXML}update_HTMLValue(){let t=D.parseHtml(D.select("#special_module_xml").value),e="",i="";if(t)for(let s of t.attributes)switch(na_attr.nameme){case"bgimg":e=s.value;break;case"path":i=s.value}let s=D.children(t,"div"),n=s.getAttribute("top"),a=s.getAttribute("left"),r=s.getAttribute("width"),o=s.getAttribute("height");D.select("#area","css",{height:o,top:n,width:r,left:a}),e&&i&&D.select("#im","attr",{src:i+"/"+e})}movetarget(t,e,i){let s;t.style.display="",!window.event&&i.layerX?(t.style.top=i.layerY-t.height/2+"px",t.style.left=i.layerX-t.width/2+"px"):(t.style.top=i.offsetY-t.height/2+"px",t.style.left=i.offsetX-t.width/2+"px"),s=this.checkmodule(t,e),this.createUserAnsXML(t.style.top,t.style.left);let n=document.getElementById("special_module_user_xml");n.value=this.userAnsXML,n=document.getElementById("answer"),n.checked=s>0,"undefined"!=typeof calculatePoint&&(this.temp=1==s,calculatePoint(1,s))}createUserAnsXMLDraw(t){this.userAnsXML='<SMANS type="4"><div userans="'+t+'"></div></SMANS>'}createUserAnsXML(t,e){this.userAnsXML='<SMANS type="4"><div targetTop="'+parseInt(t)+'" targetLeft="'+parseInt(e)+'" /></SMANS>'}checkmodule(t,e){let i=0;return parseInt(t.style.top)+t.height/2>=parseInt(e.style.top)&&parseInt(t.style.top)+t.height/2<=parseInt(e.style.top)+parseInt(e.style.height)&&parseInt(t.style.left)+t.width/2>=parseInt(e.style.left)&&parseInt(t.style.left)+t.width/2<=parseInt(e.style.left)+parseInt(e.style.width)&&(i=1),i}drawOnCanvas(t,e,i){if(t){let s=0!=t.toString().indexOf("d")?document.getElementById(t.getAttribute("id")):document.getElementById(t),n=null!=s?s.getContext("2d"):"",a=Object.keys(e).length;if(""!=e&&""!=n)for(let t=1;t<=a;t++)for(let s=0;s<=e[t].x.length;s++)n.beginPath(),n.lineWidth="4",n.strokeStyle=i,n.moveTo(e[t].x[s],e[t].y[s]),n.lineTo(e[t].x[s+1],e[t].y[s+1]),n.stroke()}}compareDrawing(t,e,i){let s=0,n=this.getAreaVal(t),a=this.getAreaVal(e),r=0,o=0,l=Object.keys(a).length,c=Object.keys(n).length;for(let t=1;t<=l;t++){for(let e=1;e<=c;e++)if(n[e].height<=a[t].height&&n[e].width<=a[t].width&&n[e].top>=a[t].top&&a[t].left+a[t].width-(n[e].left+n[e].width)>=0&&n[e].left>=a[t].left&&a[t].top+a[t].height-(n[e].top+n[e].height)>=0){r++;break}"undefined"!=typeof calculatePoint&&(t==r&&o++,calculatePoint(D.select(i).getAttribute("totalcorrectans"),o))}return l==r&&l==c&&(s=1),s}getAreaVal(t){let e=Object.keys(t).length;if(""!=t){let i=[];for(let s=1;s<=e;s++)i[s]=this.calculateArea("",t[s].x,t[s].y);return i}}selectText(t,e,i,s){let n=D.selectAll(t+" p");for(var a=0;a<n.length;a++){let t=n[a];if(t.textContent.trim()==e&&(t.classList.add(s),"u"==i)){let e;e="show_correct"==s?'<span class="icomoon-new-24px-checkmark-circle-1 font-weight-bold" style="color:green;vertical-align:7px">':'<span class="icomoon-new-24px-cancel-circle-1 font-weight-bold red" style="vertical-align:7px">',D.insert(t,'<span class="correct_incorrect_icon" style="position:absolute;z-index:100;width:18px;height:18px;bottom:16px;background:white;border-radius:12px;font-size: 18px;"> '+e+"</span></span>")}}}highlightText(t){if(0!=this.getSelected().getRangeAt(0).endOffset){this.snapSelectionToWord();let i=this.getSelected().getRangeAt(0),s=(i.startOffset,D.find(t,"[type]").getAttribute("data-correctans").split("|"));var e=i.toString();if(e=e.trim()){let t=D.findInArray(e,s)?1:0;this.pasteHtmlAtCaret("<span class='selecttext selected' correctans="+t+" userans='1'>"+e+"</span> ")}}}snapSelectionToWord(){let t;if(window.getSelection&&(t==window.getSelection()).modify){if(t=window.getSelection(),""!=t&&!t.isCollapsed){var e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);var i=e.collapsed;e.detach();var s=t.focusNode,n=t.focusOffset;t.collapse(t.anchorNode,t.anchorOffset),i?(D.findInArray(t.anchorNode.textContent.charAt(t.anchorOffset-1),[",",".","!","?",";",")","}"])&&(t.modify("move","backward","character"),t.modify("move","forward","word")),t.extend(s,n),t.modify("extend","forward","character"),t.modify("extend","backward","word")):(t.modify("move","forward","character"),t.modify("move","backward","word"),t.extend(s,n),D.findInArray(t.anchorNode.textContent.charAt(n-1),[",",".","!","?",";",")","}"])&&(t.modify("extend","backward","character"),t.modify("extend","forward","word")))}}else if(t==document.selection&&"Control"!=t.type){let e=t.createRange();if(e.text){for(e.expand("word");/\s$/.test(e.text);)e.moveEnd("character",-1);e.select()}}}pasteHtmlAtCaret(t){let e,i;if(window.getSelection){if(e=window.getSelection(),e.getRangeAt&&e.rangeCount){i=e.getRangeAt(0),i.deleteContents();var s=document.createElement("div");s.innerHTML=t;for(var n,a,r=document.createDocumentFragment();n=s.firstChild;)a=r.appendChild(n);i.insertNode(r),a&&(i=i.cloneRange(),i.setStartAfter(a),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)}getSelected(){if(window.getSelection)return window.getSelection();if(document.getSelection)return document.getSelection();var t=document.selection&&document.selection.createRange();return!!t.text&&t.text}removespan(t,e,i){let s=t.innerHTML,n=new RegExp("<\\/?span[^>]*>","g");s=s.replace(n,""),t.parentNode.replaceChild(document.createTextNode(s),t),i||D.find(e,"[type]",{action:"html",actionData:D.find(e,"[type]").innerHTML})}modeOnHot(t){D.selectAll(".test, .review","addClass","h"),t?(D.selectAll(".review","removeClass","h"),this.unBindLab(),this.showansdrag(this.elemId,"u",1)):(D.selectAll(".test","removeClass","h"),D.selectAll(".review","addClass","h"),this.bindLab(),this.showansdrag(this.elemId,"u",0))}unBindLab(){this.labBinded=!1,D.find(this.elemId,".hotArea0.hotArea",{action:"css",actionData:{display:"block"}}),D.find(this.elemId,".hotSpotImg",{action:"css",actionData:{pointerEvents:"none"}})}bindLab(){this.labBinded=!0,D.find(this.elemId,".hotArea0.hotArea",{action:"css",actionData:{display:"none"}}),D.find(this.elemId,".hotSpotImg",{action:"css",actionData:{pointerEvents:"auto"}})}}function O(t,e){return!0===isNaN(Number(t))?this.x=0:this.x=t,!0===isNaN(Number(e))?this.y=0:this.y=e,{X:this.x,Y:this.y}}const X=new t;class E{constructor(t){this.prevPoint=void 0,this.defaultOptions={target:"",penSize:1,width:t.width,height:t.height,cssClass:"",onClick:t=>{},onMove:t=>{},onPaint:t=>{},onRelease:t=>{}},this.penWidth=2,this.drawing=!1,this.cap="round",this.ID="dooScribCanvas"+Math.floor(100*Math.random()+1),this.drawingSurface="",t&&(this.Settings={...this.defaultOptions,...t}),!0===isNaN(this.Settings.height)&&(this.Settings.height=100),!0===isNaN(this.Settings.width)&&(this.Settings.width=100),this.init()}init(){let t=this.Settings.target;t?("hptmain0"==t.getAttribute("id")&&X.empty(t),X.insert(t,`<canvas id='${this.ID}' tabindex='0' class='relative ${this.Settings.cssClass}' type='${this.Settings.type}' correctans='${this.Settings.correctans}' userans=''  height='${this.Settings.height}' width='${this.Settings.width}'></canvas>`,"beforeend"),this.penSize(this.Settings.penSize),this.drawingSurface=document.getElementById(this.ID).getContext("2d"),this.drawingSurface.lineWidth=this.penSize(),this.drawingSurface.lineCap=this.cap,!1===this.hasTouch()?(document.getElementById(this.ID).addEventListener("mousedown",this.clickDown.bind(this),!0),document.getElementById(this.ID).addEventListener("mousemove",this.moved.bind(this),!0),document.addEventListener("mouseup",this.clickUp.bind(this),!0)):(document.getElementById(this.ID).addEventListener("touchstart",this.clickDown.bind(this),!0),document.getElementById(this.ID).addEventListener("touchmove",this.moved.bind(this),!0),document.getElementById(this.ID).addEventListener("touchend",this.clickUp.bind(this),!0))):console.error("Target not defined")}normalizeTouch(t){if(!0===this.hasTouch()){let e=window.scrollY;["touchstart","touchmove"].indexOf(t.type)>-1&&(t.clientX=t.targetTouches[0].pageX,t.clientY=t.targetTouches[0].pageY-e),["touchend"].indexOf(t.type)>-1&&(t.clientX=t.changedTouches[0].pageX,t.clientY=t.changedTouches[0].pageY-e)}return t}clickDown(t){if(!0===this.isDrawing())return;t||(t=window.event),!0===this.hasTouch()&&(t.preventDefault(),t=this.normalizeTouch(t));let e=X.offset(this.Settings.target),i=window.scrollY,s=new O(t.clientX-e.left,t.clientY-(e.top-i));return this.prevPoint=s,this.drawing=!0,this.Settings.onClick(s),!1}moved(t){t||(t=window.event),!0===this.hasTouch()&&(t.preventDefault(),t=this.normalizeTouch(t));var e=X.offset(this.Settings.target),i=window.scrollY,s=new O(t.clientX-e.left,t.clientY-(e.top-i));return!0===this.isDrawing()?(this.drawLine(this.prevPoint.X,this.prevPoint.Y,s.X,s.Y),this.prevPoint=s,this.Settings.onPaint(s)):this.Settings.onMove(s),!1}clickUp(t){if(!1===this.isDrawing())return;!0===this.hasTouch()&&(t.preventDefault(),t=this.normalizeTouch(t));let e=X.offset(this.Settings.target),i=window.scrollY,s=new O(t.clientX-e.left,t.clientY-(e.top-i));return this.Settings.onRelease(s),this.drawing=!1,!1}hasTouch(){return"ontouchstart"in window}penSize(t){return void 0!==t&&!1===isNaN(Number(t))&&(this.penWidth=t),this.penWidth}isDrawing(){if(this.Settings.editable)return this.drawing}lineCap(t){if(void 0!==t)switch(t){case"butt":case"round":case"square":this.cap=t}return this.cap}lineColor(t){if(void 0!==t){let e=X.parseHtml("<div id='stub' style='backgroundColor:white'></div>");e.style.backgroundColor=t;let i=e.style.backgroundColor;void 0!==i&&""!==i&&(window.color=t)}return window.color}context(){return this.drawingSurface}clearSurface(){let t=X.find(document,"canvas").getAttribute("width").replace("px",""),e=X.find(document,"canvas").getAttribute("height").replace("px","");this.drawingSurface.clearRect(0,0,t,e)}drawLine(t,e,i,s){void 0!==t&&void 0!==e&&void 0!==i&&void 0!==s&&!1===isNaN(Number(t))&&!1===isNaN(Number(e))&&!1===isNaN(Number(i))&&!1===isNaN(Number(s))&&(this.drawingSurface.lineCap=this.cap,this.drawingSurface.strokeStyle=window.color,this.drawingSurface.lineWidth=this.penWidth,this.drawingSurface.beginPath(),this.drawingSurface.moveTo(t,e),this.drawingSurface.lineTo(i,s),this.drawingSurface.stroke())}}function R(t,e,i,s,n){let a,r,o=13;var l,c;return r={x:t&&t.layerX,y:t&&t.layerY,top:0,left:0,uXml:"",ans:!1,ans_h:e,ans_w:i,ans_left:s,ans_top:n},t&&13!=t.which?t.layerX&&t.layerY?(r.top=t.layerY-o,r.left=t.layerX-o):(r.top=t.offsetY-o,r.left=t.offsetX-o):(r.top=7,r.left=7),a=function(t,e){let i=0,s=t.ans_top+t.ans_h,n=t.ans_left+t.ans_w;return t.top+e+4>t.ans_top&&t.top+parseInt(e/2)<s&&t.left+e>t.ans_left&&t.left+parseInt(e/2)<n&&(i=1),i}(r,o),r.uXml=(l=r.top,c=r.left,'<SMANS type="4"><div targetTop="'+parseInt(l)+'" targetLeft="'+parseInt(c)+'" /></SMANS>'),"undefined"!=typeof calculatePoint&&(temp=1==a?1:0,calculatePoint(1,temp)),r.ans=a>0,r}function z(t){n(t,"svelte-1mvfo84","main.svelte-1mvfo84{text-align:center !important;padding:1em;max-width:240px;margin:0 auto;font-size:26px}.targetImg.svelte-1mvfo84{display:none;position:absolute;z-index:10;width:24px;height:24px;border-radius:50%;background:#fff;color:#1c3ad4}.showBlock.svelte-1mvfo84{display:block}@media(min-width: 640px){main.svelte-1mvfo84{max-width:none}}")}function H(t){let e;return{c(){e=a("div"),e.innerHTML='<button tabindex="0" type="button" class="h h-imp svelte_items_test" id="set-review"></button> \n\t\t\t\t<button tabindex="0" type="button" class="h h-imp svelte_items_test" id="unset-review"></button>',o(e,"class","h h-imp"),o(e,"id","review_buttons")},m(t,i){l(t,e,i)},p:v,i:v,o:v,d(t){t&&u(e)}}}function P(t){let e,i;return e=new T({props:{handleReviewClick:t[24],customReviewMode:t[1],reviewMode:t[0]}}),e.$on("setReview",t[21]),e.$on("unsetReview",t[22]),{c(){b(e.$$.fragment)},m(t,s){y(e,t,s),i=!0},p(t,i){const s={};2&i[0]&&(s.customReviewMode=t[1]),1&i[0]&&(s.reviewMode=t[0]),e.$set(s)},i(t){i||(m(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){A(e,t)}}}function B(t){let e,i,s=t[23](t[19][t[16]])+"";return{c(){e=new M,i=_(),e.a=i},m(t,n){e.m(s,t,n),l(t,i,n)},p(t,i){65536&i[0]&&s!==(s=t[23](t[19][t[16]])+"")&&e.p(s)},d(t){t&&u(i),t&&e.d()}}}function Y(t){let e,i,s,n,d,h,p,m=t[18]&&j();return{c(){e=a("center"),i=a("div"),s=a("div"),s.innerHTML='<span class="icomoon-new-24px-reset-1 s3" style="vertical-align: text-top"></span>  \n\t\t\t\t\t\t\t<span class="position-relative bottom1">Reset</span>',n=r(),d=a("div"),p=r(),m&&m.c(),o(s,"id","reset"),S(s,"height","27px"),S(s,"width","90px"),S(s,"top","2px"),o(s,"class","reset btn btn-outline-primary position-relative btn-sm mt-sm2 mr-sm2 float-end"),S(i,"height","34px"),S(i,"width",window.inNative?window.innerWidth:t[4].imgwidth),S(i,"background","#d9e7fd"),S(i,"border-top","2px solid #96bbf6"),o(d,"id","hptmain0"),o(d,"totalcorrectans",t[2]),o(d,"dd",h=t[4].imgwidth),S(d,"width",t[4].imgwidth||"250px"),S(d,"height",t[4].imgheight||"600px"),S(d,"background-image","url('"+(J+t[15])+"')"),S(d,"background-repeat","no-repeat"),S(d,"position","relative"),S(d,"border",t[5]+"px solid "+t[6]),o(e,"key","imageHeight_3")},m(t,a){l(t,e,a),c(e,i),c(i,s),c(e,n),c(e,d),c(e,p),m&&m.m(e,null)},p(t,s){16&s[0]&&S(i,"width",window.inNative?window.innerWidth:t[4].imgwidth),4&s[0]&&o(d,"totalcorrectans",t[2]),16&s[0]&&h!==(h=t[4].imgwidth)&&o(d,"dd",h),16&s[0]&&S(d,"width",t[4].imgwidth||"250px"),16&s[0]&&S(d,"height",t[4].imgheight||"600px"),32768&s[0]&&S(d,"background-image","url('"+(J+t[15])+"')"),96&s[0]&&S(d,"border",t[5]+"px solid "+t[6]),t[18]?m||(m=j(),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(t){t&&u(e),m&&m.d()}}}function U(t){let e,i,s,n,d,h,p,m,g,w,f,x,v,b,y,A;return{c(){e=a("table"),i=a("tbody"),s=a("tr"),n=a("td"),d=a("div"),h=a("div"),p=a("img"),g=r(),w=a("div"),f=k(" "),x=r(),v=a("span"),o(p,"id","im0"),o(p,"tabindex","0"),S(p,"max-width","none"),S(p,"width",t[4].imgwidth),S(p,"height",t[4].imgheight),o(p,"class","hotSpotImg"),C(p.src,m=J+t[15])||o(p,"src",m),o(p,"alt",t[3]),o(w,"id","hotArea"),o(w,"class","hotArea hotArea hotAreaPreview"),S(w,"display",t[12]),S(w,"left",t[11]+"px"),S(w,"top",t[8]+"px"),S(w,"height",t[9]),S(w,"width",t[10]),o(v,"id","target"),o(v,"class","target targetImg icomoon-plus-circle-2 svelte-1mvfo84"),S(v,"left",t[13]+"px"),S(v,"top",t[14]+"px"),I(v,"showBlock",t[7]),o(h,"id","SM0"),o(h,"class","SM position-relative m-0 p-0"),o(h,"style",b=`\n\t\t\t\t\t\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\t\t\t\t\t\tmargin: 0px;\n\t\t\t\t\t\t\t\t\t\t\tpadding: 0px;\n\t\t\t\t\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\t\t\t\t\t\tborder: ${t[5]?t[5]+"px solid":""};\n\t\t\t\t\t\t\t\t\t\t\tborder-color: ${t[6]};\n\t\t\t\t\t\t\t\t\t\t`),o(d,"id","SM0"),o(d,"class","relative"),o(n,"class","border"),o(e,"id","hptmain0"),o(e,"class","smbase smhotspot border-0 h-auto w-auto uc-table no_overflow_wrapper")},m(a,r){l(a,e,r),c(e,i),c(i,s),c(s,n),c(n,d),c(d,h),c(h,p),c(h,g),c(h,w),c(w,f),c(h,x),c(h,v),y||(A=N(p,"click",t[20]),y=!0)},p(t,e){16&e[0]&&S(p,"width",t[4].imgwidth),16&e[0]&&S(p,"height",t[4].imgheight),32768&e[0]&&!C(p.src,m=J+t[15])&&o(p,"src",m),8&e[0]&&o(p,"alt",t[3]),4096&e[0]&&S(w,"display",t[12]),2048&e[0]&&S(w,"left",t[11]+"px"),256&e[0]&&S(w,"top",t[8]+"px"),512&e[0]&&S(w,"height",t[9]),1024&e[0]&&S(w,"width",t[10]),8192&e[0]&&S(v,"left",t[13]+"px"),16384&e[0]&&S(v,"top",t[14]+"px"),128&e[0]&&I(v,"showBlock",t[7]),96&e[0]&&b!==(b=`\n\t\t\t\t\t\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\t\t\t\t\t\tmargin: 0px;\n\t\t\t\t\t\t\t\t\t\t\tpadding: 0px;\n\t\t\t\t\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\t\t\t\t\t\tborder: ${t[5]?t[5]+"px solid":""};\n\t\t\t\t\t\t\t\t\t\t\tborder-color: ${t[6]};\n\t\t\t\t\t\t\t\t\t\t`)&&o(h,"style",b)},d(t){t&&u(e),y=!1,A()}}}function j(t){let e;return{c(){e=a("div"),o(e,"class","position-fixed index0"),S(e,"right","0"),S(e,"top","0"),S(e,"left","0"),S(e,"bottom","0"),S(e,"background","rgba(0,0,0,0.4)")},m(t,i){l(t,e,i)},d(t){t&&u(e)}}}function W(t){let e,i,s,n,g,w,f,x,v;const b=[P,H],y=[];function A(t,e){return"1"==t[19][t[16]]||"2"==t[19][t[16]]?0:1}function _(t,e){return"4"==t[19][t[16]]?U:"3"==t[19][t[16]]?Y:B}s=A(t),n=y[s]=b[s](t);let S=_(t),k=S(t);return{c(){e=a("main"),i=a("center"),n.c(),g=r(),w=a("div"),k.c(),f=r(),x=a("input"),o(w,"id","previewArea"),o(w,"class","relative"),o(x,"type","hidden"),o(x,"id","special_module_parse"),o(x,"name","special_module_parse"),o(x,"userans",""),x.value=t[17],o(e,"class","pt-0 svelte-1mvfo84")},m(t,n){l(t,e,n),c(e,i),y[s].m(i,null),c(i,g),c(i,w),k.m(w,null),c(e,f),c(e,x),v=!0},p(t,e){let a=s;s=A(t),s===a?y[s].p(t,e):(d(),h(y[a],1,1,(()=>{y[a]=null})),p(),n=y[s],n?n.p(t,e):(n=y[s]=b[s](t),n.c()),m(n,1),n.m(i,g)),S===(S=_(t))&&k?k.p(t,e):(k.d(1),k=S(t),k&&(k.c(),k.m(w,null))),(!v||131072&e[0])&&(x.value=t[17])},i(t){v||(m(n),v=!0)},o(t){h(n),v=!1},d(t){t&&u(e),y[s].d(),k.d()}}}L('#hptmain .drag-resize{position:absolute;left:90px;top:50px;border:none;z-index:8;text-align:center;font-size:0;line-height:20px;background-color:rgba(244,255,71,.6)!important;box-shadow:0 0 1px #000 inset;cursor:move}.tools{position:absolute;right:5px;z-index:101}.tools .labs-btn{padding:2px 5px}.drag-resize .tools{top:-28px;right:-3px}.elemActive{background:rgba(244,255,71,.6)!important;opacity:1!important}#option-toolbar{margin-bottom:0}.controls{list-style:none;margin:0;padding:0}.controls li{display:inline;padding:11px;float:left;font-size:13px}.controls li:hover,.selected-option{cursor:pointer;background-color:#ccc!important}#hotspot{width:700px;padding:4px;border-top-right-radius:10px;border-top-left-radius:10px;text-align:left;background-color:#ccc}.hotspotTxt{background:#fff;word-wrap:break-word;padding:1em;min-height:180px;text-align:left;overflow-y:scroll;border:1px solid #ccc;font-family:"open sans",Helvetica,Arial,"Times New Roman",sans-serif;font-size:14px}.hotspotTxt p{float:left;margin-bottom:3px}.textClick{border:1px solid transparent;padding:2px 0;margin-right:2px;cursor:pointer;border-radius:2px;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none}.selecttext.selected,.textClick.selected,.textClick.selected:hover{background-color:#ff9;border:1px solid #8a7300;border-radius:2px}.textClick:hover{background-color:#fcfcd3;border-color:#8a7300}.show_correct{background-color:#e7f4e1!important;border-color:#62ae41!important}.show_incorrect{border-color:#da1919!important;background-color:#fbdddd!important}.selecttext{border:1px solid transparent;padding:3px 0;margin-right:2px;position:relative;margin-left:-1px;margin-right:-1px;border-radius:2px}.drawSurface{cursor:crosshair}.h{display:none}.textClick.selected:focus{box-shadow:inset 0 0 0 1px transparent,inset 0 0 0 1px #fff,inset 0 0 0 2px #000;outline:0}.red{color:red}#hptmain0 tr td{border:0!important}');let J="//s3.amazonaws.com/jigyaasa_content_static/";function q(t,e,i){let{xml:s}=e,{uxml:n}=e,{ansStatus:a}=e,{isReview:r}=e,{showAns:o}=e,{editorState:l}=e,c=r;const d=new $;let h,p,m="",u=0,v="",b={textclick:"1",textselect:"2",imagehighlight:"3",hotspot:"4"},y={},A=0,_="gray",S=!1,k="",C="",I="",N="",M="none",T=0,L=0,D=0,O=0,X="",z="",H="",P=0,B=0,Y="",U="0",j="",W="",q="black",F="",V=0,G=[],K=[],Q=0,Z=0;var tt="textclick",et="",it="";function st(){switch(i(16,H=m.smxml.div._type),P=m.smxml._height,B=m.smxml._width,null!=H&&""!=H||i(16,H=m.smxml._name.toLowerCase()),tt=H,i(15,z=m.smxml._bgimg),b[H]){case"1":Q=m.smxml._height+"px",Z=m.smxml._width+"px",function(t){var e="",s=t.match(/%{(.*?)}%/gm);if(s){i(2,p=s.length);for(var n=0;n<s.length;n++)et=s[n].replace(/\s+/gm,"<uc:space>"),t=t.replace(s[n],et)}et="",t=t.split(" ");for(n=0;n<t.length;n++)t[n].match(/%{|%}/gm)?(t[n]=t[n].replace(/<uc:space>/gm," ").replace(/%{|}%/gm,""),e+='<p class="textClick" data-index="'+n+'" data-userans="0" data-correctans="1">'+t[n]+"</p>",et+=t[n]+"|"):e+='<p class="textClick" data-index="'+n+'" data-userans="0" data-correctans="0">'+t[n]+"</p>";et=et.replace(/\|$/gm,""),f.select(" #previewArea  #textID0").innerHTML=e}(m.smxml.div.__cdata),f.select(f.parent("#textID0"),"show","block"),f.selectAll('#drawPreview,table[id="hptmain2"]',"hide");break;case"2":isNaN(m.smxml._height)||(m.smxml._height=m.smxml._height+"px"),Q=m.smxml._height,Z=m.smxml._width+"px",function(t){et="";var e=t.match(/%{(.*?)}%/gm);if(e){for(var s=0;s<e.length;s+=1)et+=e[s].replace(/%{|}%/gm,"")+"|";it=t.replace(/%{/gm,'<span class="selecttext selected">').replace(/}%/gm,"<span>"),i(2,p=e.length),et=et.replace(/\|$/gm,"")}var n=t.replace(/%{|}%/gm,""),a=setTimeout(function(){f.select(" #previewArea  #textID0").innerHTML=n,clearTimeout(a)}.bind(self),100)}(m.smxml.div.__cdata),f.select(f.parent("#textID0"),"show","block"),f.selectAll('#drawPreview,table[id="hptmain2"]',"hide");break;case"3":{let t=new Image;t.addEventListener("load",(function(t){i(4,y.imgheight=m.smxml._height>this.height?m.smxml._height+"px":this.height+"px",y),i(4,y.imgwidth=m.smxml._width>this.width?m.smxml._width+"px":this.width+"px",y),i(5,A=m.smxml.div._border),i(6,_=m.smxml.div._bordercolor),f.find("#hptdraw0","canvas",{action:"attr",actionData:{height:y.imgheight,width:y.imgwidth}}),f.empty("#textID0"),ot()}),!1),t.setAttribute("src",J+m.smxml._bgimg)}break;case"4":{i(15,z=m.smxml._bgimg),i(3,v=m.smxml._alt),i(14,L=parseFloat(m.smxml.div._top)),i(13,T=parseFloat(m.smxml.div._left)+13),D=parseFloat(m.smxml.div._height),O=parseFloat(m.smxml.div._width),i(3,v=m.smxml.div._alt),X=m.smxml.div.type,i(5,A=m.smxml.div._border),i(6,_=m.smxml.div._bordercolor),i(10,I=m.smxml.div._width+"px"),i(9,C=m.smxml.div._height+"px"),i(11,N=parseInt(m.smxml.div._left)+4),i(8,k=parseInt(m.smxml.div._top)+2);let t=new Image;t.onload=function(){let t=this.height+"px",e=this.width+"px";i(4,y.imgheight=m.smxml.div._imgheight?m.smxml.div._imgheight+"px":"auto !important",y),i(4,y.imgwidth=m.smxml.div._imgwidth?m.smxml.div._imgwidth+"px":"auto !important",y),f.select("#hptmain0","css",{height:t,width:e})},t.src=J+m.smxml._bgimg}}}function nt(){r&&i(12,M="block");var t=new Image;if(t.onload=function(){"3"==b[H]?(i(4,y.imgheight=m.smxml._height>this.height?m.smxml._height+"px":this.height+"px",y),i(4,y.imgwidth=m.smxml._width>this.width?m.smxml._width+"px":this.width+"px",y)):(i(4,y.imgheight=m.smxml.div._imgheight?m.smxml.div._imgheight+"px":"auto !important",y),i(4,y.imgwidth=m.smxml.div._imgwidth?m.smxml.div._imgwidth+"px":"auto !important",y))},z&&(t.src=J+z),n){i(17,j=n);let t=w(n);t.SMANS&&t.SMANS.div&&(i(7,S=!0),i(13,T=t.SMANS.div._targetLeft),i(14,L=t.SMANS.div._targetTop))}}function at(t){let e={};"textclick"==tt||"textselect"==tt?(e=d.check_Ans("#previewArea #hptmain0"),i(30,h=e.ans)):(e=R(t,D,O,parseInt(N),parseInt(k)),i(7,S=!0),i(13,T=e.left),i(14,L=e.top),i(25,a=e.ans),i(30,h=a),l&&o(a?"Correct":"Incorrect")),x(e)}function rt(){if(i(0,r=!0),i(12,M="block"),"3"==b[H]){let t=f.find("#previewArea","canvas"),e=t.getAttribute("correctans");""!=e&&(e=JSON.parse(e)),d.drawOnCanvas(t,e,"green")}d.modeOnHot(1),f.select("#hptmain0","css",{pointerEvents:"none"})}function ot(){if(i(0,r=!1),i(12,M="none"),"3"==b[H]){f.find("#previewArea","canvas",{action:"remove"});var t=setTimeout((function(){!function(t,e){let n=f.find(t,"#hptmain0");t=n;let a=new E({target:n,width:+y.imgwidth.replace("px",""),height:+y.imgheight.replace("px",""),correctans:W,cssClass:"drawSurface",penSize:4,type:"imagehighlight",editable:!e,onMove(){},onClick(){},onPaint(t){G.push(t.X),K.push(t.Y)},onRelease(s){!function(t,e,s){let n="",a=!1;if(!s){F="";var r=document.querySelector("#special_module_parse").value;""!=(r=r.substring(r.indexOf("{"),r.lastIndexOf("}")+1))?(r=Object.keys(JSON.parse(r)).length,F=d.getCoordinate(e,G,K,r)):F=d.getCoordinate(e,G,K,V),window.inNative&&window.getHeight&&window.getHeight(),window.ISSPECIALMODULEUSERXMLCHANGE=1,f.select("#special_module_user_xml").value=F,i(17,j=F),G=[],K=[];let t=f.find(e,"canvas").getAttribute("correctans"),s=f.find(e,"canvas").getAttribute("userans");""!=s&&(s=JSON.parse(s)),""!=t&&(t=JSON.parse(t));let c=d.compareDrawing(s,t,e),p="Incorrect";c>0?(a=!0,p="Correct",i(4,y.answerType3=!0,y),l&&o("Correct")):(a=!1,p="Incorrect",i(4,y.answerType3=!1,y)),l&&o(p),n=f.select("#special_module_user_xml").value,c=c>0,i(30,h=c),x({ans:c,uXml:n}),f.select("#answer").checked=c>0,window.inNative&&window.postMessage(JSON.stringify({inNativeIsCorrect:a,userAnswers:n}),"*")}}(0,t,e)}});q=String(s.match(/linecolor=\"([^\"]+)\"/gm)),q=q.substring("11",q.length-1),e||f.listen("#previewArea","click","#reset",(()=>{a.clearSurface(),F="",V=0,i(17,j=""),f.selectAll(f.select(t).children,"attr",{userans:""}),i(30,h=!1)}));window.surface=a}("#previewArea",0);let e=f.find("#previewArea","canvas"),n=f.select("#special_module_parse").value,a=n.substring(n.indexOf("{"),n.lastIndexOf("}")+1);""!=a&&(a=JSON.parse(a)),d.drawOnCanvas(e,a,q),clearTimeout(t)}),500)}d.modeOnHot(),f.select("#hptmain0","css",{pointerEvents:"auto"})}return g((()=>{m=w(s),U=m.smxml.hotBorder,Y=m.smxml.hotBorderColor,st(),nt(),d.readyThis("hptmain0",r),r?d.modeOnHot(1):d.modeOnHot(),f.listen("#previewArea","keydown","#im0",(function(t,e){var s=f.select("#im0").getBoundingClientRect();switch(e.which){case 37:i(13,T=parseInt(T)-2),T<1&&i(13,T=1);break;case 38:i(14,L=parseInt(L)-2),L<1&&i(14,L=1);break;case 39:i(13,T=parseInt(T)+2),T+24>s.width&&i(13,T=s.width-24);break;case 40:i(14,L=parseInt(L)+2),L+24>s.height&&i(14,L=s.height-24);break;case 13:at()}console.log("ans_x",T),console.log("ans_y",L)})),f.listen("#previewArea","click",".textClick",(function(){at()})),f.listen("#previewArea","click",'[type="textselect"]',(function(){at()})),f.listen("#review_buttons","click","#set-review",(function(){rt()})),f.listen("#review_buttons","click","#unset-review",(function(){ot()}))})),t.$$set=t=>{"xml"in t&&i(26,s=t.xml),"uxml"in t&&i(27,n=t.uxml),"ansStatus"in t&&i(25,a=t.ansStatus),"isReview"in t&&i(0,r=t.isReview),"showAns"in t&&i(28,o=t.showAns),"editorState"in t&&i(29,l=t.editorState)},t.$$.update=()=>{if(1879048195&t.$$.dirty[0]|1&t.$$.dirty[1]&&r!=c&&(r?(rt(),l&&0==u&&(o(h?"Correct":"Incorrect"),i(31,u=1))):(i(31,u=0),ot()),i(1,c=r)),67108868&t.$$.dirty[0]|2&t.$$.dirty[1]&&s){let t=s.replace("\x3c!--[CDATA[","<![CDATA[").replace("]]--\x3e","]]>");t.match(/<\!\[CDATA\[{|<\!--\[CDATA\[{/gm)&&(i(32,W=t.toString().match(/{(.*)}/gim)),i(2,p=W.toString().match(/},"\d+"/gm)),i(2,p=p?p.pop():null),i(2,p=p?p.replace(/"|}|,/gm,""):1),t=t.replace(W,""),i(32,W=W[0])),m=w(s),st(),nt()}},[r,c,p,v,y,A,_,S,k,C,I,N,M,T,L,z,H,j,!1,b,at,rt,ot,function(t){switch(t){case"1":case"2":{let t="",e="";if(n){let i=w(n);window.test=n,i?.smans?.div&&(t=i.smans.div["_data-userAns"],e=i.smans.div["_data-userHtml"])}return`\n\t\t\t\t\t\t<div is id="hptmain0" totalCorrectAns=${p}>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tid="textID0" \n\t\t\t\t\t\t\t\ttype="${tt}" \n\t\t\t\t\t\t\t\tdata-correcthtml="${it}" \n\t\t\t\t\t\t\t\tdata-correctans="${et}"\n\t\t\t\t\t\t\t\tdata-userans="${t}" \n\t\t\t\t\t\t\t\tdata-userhtml="${e}" \n\t\t\t\t\t\t\t\tclass="drag-resize hotspotTxt" \n\t\t\t\t\t\t\t\tstyle="max-width:${Z}; height:${Q}; line-height: 1.4; font-size:17px!important;"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`}default:return"<div>Incorrect question type</div>"}},function(t,e){"c"==t?d.showansdrag("#hptmain0","c",1):d.showansdrag("#hptmain0","u",1)},a,s,n,o,l,h,u,W]}export default class extends e{constructor(t){super(),i(this,t,q,W,s,{xml:26,uxml:27,ansStatus:25,isReview:0,showAns:28,editorState:29},z,[-1,-1])}}
//# sourceMappingURL=HotspotPreview-bdd7fdc1.js.map
