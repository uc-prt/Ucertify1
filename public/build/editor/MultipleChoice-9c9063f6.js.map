{"version":3,"file":"MultipleChoice-9c9063f6.js","sources":["../../../clsSMMultipleChoice/MultipleChoice.svelte"],"sourcesContent":["<script>\r\n\t/**\r\n\t * File: MultipleChoice.svelte\r\n\t * Author: Pradeep Yadav\r\n\t * Description: Authoring file for multiple choice\r\n\t */\r\n\timport { onMount } from \"svelte\";\r\n\timport { writable } from \"svelte/store\";\r\n\timport { AH } from \"../helper/HelperAI.svelte\";\r\n\timport OptionContainer from \"./OptionContainer.svelte\";\r\n\texport let ucEditor;\r\n\texport let getChildXml;\r\n\texport let editorState;\r\n\texport let xml;\r\n\r\n\tlet state = {};\r\n\tlet hdd = writable({\r\n\t\t\tcorrectAnswers:\"\",\r\n\t\t\toptionData:\"\",\r\n\t\t\toptionDataCopy:\"\",\r\n\t\t\treviewMode:false,\r\n\t\t\txml:\"\",\r\n\t\t\toptionCounter: 1,\r\n\t\t});\r\n\tconst unsubscribe = hdd.subscribe((items)=> {\r\n\t\tstate = items;\r\n\t});\r\n\tlet letters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\".split('');\r\n\r\n\tonMount(async()=> {\r\n\t\tdidMount();\r\n\t})\r\n\r\n\t// Interate and load Options\r\n\tfunction didMount() {\r\n\t\tvar init = setTimeout(function() {\r\n\t\t\tloadOldType();\r\n\t\t\tvar loadTimer = setTimeout(function() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdocument.querySelectorAll(\"[id^='option']\").forEach((_this, i)=> {\r\n\t\t\t\t\t\tif (_this.querySelectorAll(\".pln\").length > 0) {\r\n\t\t\t\t\t\t\t_this.querySelectorAll(\".pln\").forEach((_this2)=> {\r\n\t\t\t\t\t\t\t\tif (_this2.nextElementSibling.length > 0 && _this.previousElementSibling.length > 0) {\r\n\t\t\t\t\t\t\t\t\tif (_this2.nextElementSibling.nodeName == \"BR\" && _this2.previousElementSibling.nodeName == \"BR\") {\r\n\t\t\t\t\t\t\t\t\t\t_this.nextElementSibling.remove();\r\n\t\t\t\t\t\t\t\t\t\t_this2.remove();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\txml ? editOption(i) : \"\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch(error) {\r\n\t\t\t\t\tconsole.log({err:\"Removing PrettyPrint  BR from Authoring Error\", func:'componentDidMount'});\r\n\t\t\t\t}\r\n\t\t\t\tucEditor.initEditor(false, \"#authoringSection .ebook_item_text\");\r\n\t\t\t\tclearTimeout(loadTimer);\r\n\t\t\t}, 3000);\r\n\t\t\tclearTimeout(init);\r\n\t\t}, 200);\r\n\t\tAH.listen(document, 'keydown', '.answer_container .delete_element', function(_this, event) {\r\n\t\t\tif ((event.keyCode == 13 || event.which == 13)) {\r\n\t\t\t\t// click the element which currently get the focus and enter key is down\r\n\t\t\t\tAH.trigger(_this, 'click');\r\n\t\t\t}\r\n        });\r\n        \r\n        // this condition used for that guid which is generated by the help of List Item module\r\n        if (editorState.ajaxData.parent_guid) {\r\n            // used for only show the preview\r\n            preview_edit = 1;\r\n            AI && AI.set('get_parent_guid', editorState.ajaxData.parent_guid);\r\n        }\r\n\t}\r\n\r\n\t// TO update modified options\r\n\tfunction updateProps(newData) {\r\n\t\teditorState.ajaxData.correct_answers = newData.correct_answers;\r\n\t\teditorState.ajaxData.answers = newData.answers;\r\n\t\tgetChildXml(editorState, \"mcqType\");\r\n\t}\r\n\r\n\t// Check options and set state\r\n\tfunction loadOldType() {\r\n\t\tstate.correctAnswers = editorState.ajaxData.correct_answers;\r\n\t\tstate.optionData = editorState.ajaxData.answers;\r\n\t\tstate.optionDataCopy = editorState.ajaxData.answers;\r\n\t\tstate.optionCounter = editorState.ajaxData.answers.length;\r\n\t}\r\n\r\n\t// Handle Edit of options\r\n\tfunction editOption(index){\r\n\t\tlet quesData = ucEditor.getContent(\"option\"+index);\r\n\t\tstate.optionDataCopy[index]['answer'] = AI.ignoreEnity(quesData);\r\n\t\tupdateProps({\r\n\t\t\tcorrect_answers: state.correctAnswers,\r\n\t\t\tanswers: state.optionDataCopy,\r\n\t\t});\r\n\t}\r\n\r\n\t//Handle Delete options\r\n\tfunction deleteOption(index) {\r\n\t\tlet temp = [];\r\n\t\tstate.optionDataCopy.map((data, i)=> {\r\n\t\t\tif (i != index) {\r\n\t\t\t\ttemp.push(data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tconsole.log(temp);\r\n\t\tstate.optionDataCopy = temp;\r\n\t\tupdateProps({\r\n\t\t\tcorrect_answers: state.correctAnswers,\r\n\t\t\tanswers: temp,\r\n\t\t});\r\n\t\tupdateOptionData(temp);\r\n\t}\r\n\r\n\t// Handle addition of new options\r\n\tfunction addOption(index) {\r\n\t\tlet temp1 = state.optionDataCopy;\r\n\t\tstate.optionCounter = state.optionCounter + 1;\r\n\t\ttemp1.push({\r\n\t\t\tanswer: \"Option\",\r\n\t\t\tid: \"id\" + (state.optionCounter),\r\n\t\t\tis_correct:\"0\",\r\n\t\t\tseq_str:\"\",\r\n\t\t\tseq_tag:\"\"\r\n\t\t});\r\n\t\tstate.optionDataCopy = temp1;\r\n\t\tupdateProps({\r\n\t\t\tcorrect_answers: state.correctAnswers,\r\n\t\t\tanswers: temp1,\r\n\t\t});\r\n\t\tupdateOptionData(temp1);\r\n\t\t\r\n\t\ttinymce.EditorManager.editors = [];//@saquib:added this line\r\n\t\tucEditor.initEditor();\r\n\t\tsetTimeout(()=> {\r\n\t\t\tucEditor.initEditor(false, \"#authoringSection .ebook_item_text\");\r\n\t\t},1000);\r\n\t}\r\n\r\n\t// Update option's data\r\n\tfunction updateOptionData(data) {\r\n\t\tdata = JSON.stringify(data);\r\n\t\tdata  = JSON.parse(data);\r\n\t\tstate.optionData = data;\r\n\t}\r\n\r\n\t// Handle checked\r\n\tfunction toggleChecked(index,e) {\r\n\t\tlet correctAnswers = 0;\r\n\t\tstate.optionDataCopy[index]['is_correct'] = ((e.target.checked) ? \"1\" : \"0\");\r\n\t\tfor (let i in state.optionDataCopy) {\r\n\t\t\tif (state.optionDataCopy[i][\"is_correct\"] == \"1\") {\r\n\t\t\t\tcorrectAnswers++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tstate.correctAnswers = correctAnswers;\r\n\t\tlet temp = state.optionDataCopy;\r\n\t\tupdateOptionData(temp);\r\n\t\tupdateProps({\r\n\t\t\tcorrect_answers: correctAnswers,\r\n\t\t\tanswers: state.optionDataCopy,\r\n\t\t});\r\n\t}\r\n</script>\r\n\r\n<div>\r\n\t{#if (state.optionData)}\r\n\t\t<OptionContainer \r\n\t\t\ttoggleChecked={toggleChecked} \r\n\t\t\tdeleteOption={deleteOption} \r\n\t\t\teditOption={editOption} \r\n\t\t\tletters={letters} \r\n\t\t\tcorrectAnswers={state.correctAnswers} \r\n\t\t\treviewMode={state.reviewMode} \r\n\t\t\tdata={state.optionData} \r\n\t\t/>\r\n\t{/if}\r\n\t<div class=\"mt-lg position-relative col-12 bottom20 pl-0\" style=\"padding-top: 8px;\">\r\n\t\t<button \r\n\t\t\tvariant=\"fab\" \r\n\t\t\tcolor=\"primary\"\r\n\t\t\taria-label=\"Add\"\r\n\t\t\ton:click={addOption}\r\n\t\t\tclass=\"rounded d-flex align-items-center btn btn-sm btn-outline-primary pr-md\"\r\n\t\t\tstyle=\"text-transform: none;\"\r\n\t\t>\r\n\t\t\t<span class=\"icomoon-plus pr-1\"></span>Add option\r\n\t\t</button> \r\n\t</div>\r\n</div>"],"names":[],"mappings":"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"}