{"version":3,"file":"SliderItemPreview-e3afaba9.js","sources":["../../../clsSMSlider/SliderItemPreview.svelte"],"sourcesContent":["<!--\r\n *  File Name   : SliderItemPreview.svelte\r\n *  Description : Container for Slider preview Module\r\n *  Author      : Rashmi Kumari\r\n *  Package     : svelte_items\r\n *  Last update : 19-Jan-2021\r\n *  Last Updated By : Rashmi Kumari\r\n-->\r\n<script>\r\n    import { onMount } from \"svelte\";\r\n    import l from '../src/libs/editorLib/language';\r\n    import ItemHelper from '../helper/ItemHelper.svelte';\r\n    import { AH, XMLToJSON, onUserAnsChange } from '../helper/HelperAI.svelte';\r\n    import './css/slider.min.css';\r\n\r\n    export let xml;\r\n    export let uxml;\r\n    export let showAns;\r\n    export let isReview;\r\n    export let editorState;\r\n    let localSliderData = [], userAnsXML, user_ans_tab = true ;\r\n    let state = {\r\n        datauserans: {}\r\n    };\r\n    let targetView      = \"none\";\r\n    let result, onError = \"\";\r\n    $: {\r\n\t\tif (isReview) {\r\n            targetView = \"block\";\r\n            // display the correct or incorrect according to the answer matched\r\n            displayAns();\r\n            setReview();\r\n\t\t} else {\r\n            targetView = \"none\";\r\n        }\r\n        if (xml != state.xml) {\r\n            // update the value of state 'xml'\r\n            state.xml = xml;\r\n            // updates the value of sliders elements and load the module\r\n            loadModule(xml);\r\n\r\n            // used to contain the json data of previous xml and next xml\r\n            let oldjsonraw, newjsonraw;\r\n            // assign the json data of previous xml into variable 'oldjsonraw'\r\n            oldjsonraw = XMLToJSON(xml == \"\" ? state.xml : xml);\r\n            // assign the json data of next xml into variable 'newjsonraw'\r\n            newjsonraw = XMLToJSON(state.xml);\r\n            // contains the array of json object having key slider of json oldjsonraw\r\n            let oldjson = jsontoArray(oldjsonraw.smxml.slider);\r\n            // contains the array of json object having key slider of json newjsonraw\r\n            let newjson = jsontoArray(newjsonraw.smxml.slider);\r\n            oldjson.map(function (data, i) {\r\n                if (newjson[i] != undefined) {\r\n                    if (data._defaultans != newjson[i]._defaultans) {\r\n                        /* updates the value of state 'datauserans' having key  'data.key' to the value of slider key at index 'i' of json jsonraw */\r\n                        state.datauserans[data._key] = newjson[i]._defaultans;\r\n                    }\r\n                }\r\n            })\r\n            if (uxml) {\r\n                let uaXML;\r\n                // converts user answer xml into json object and assign the value to uaXML variable\r\n                uaXML = XMLToJSON(uxml);\r\n                if (typeof (uaXML.smans.slider) != \"undefined\") { //@sneh: added this line because map function was generating error in quiz player\r\n                    localSliderData.map(function (data, i) {\r\n                        // updates the value of array state datauserans at defined index with the value of slider's key array at index 'i' of json uaXML \r\n                        state.datauserans[data.sliderid] = uaXML.smans.slider[i]._userAns;\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\t}\r\n    // function loadLibs() {\r\n    //     let config = {\r\n    //         preload: true,\r\n    //         type: 'stylesheet',\r\n    //         as: 'style'\r\n    //     }\r\n    //     AH.createLink(window.itemFolder + 'clsSMSlider/css/slider.min.css', config);\r\n\t\t\r\n    // }\r\n    onMount(() => {\r\n        //loadLibs();\r\n        loadModule(xml);\r\n        // used for native team\r\n        if (window.inNative) {\r\n            window.getHeight && window.getHeight();\r\n        }\r\n    });\r\n\r\n    // converts json into array\r\n    function jsontoArray(obj) {\r\n        if (Array.isArray(obj) == false) {\r\n            // contains json data\r\n            let temp = obj;\r\n            // creates array\r\n            obj = [];\r\n            // assign the json data at index 0 \r\n            obj[0] = temp;\r\n        }\r\n        // returns an array containing json data\r\n        return obj;\r\n    }\r\n\r\n    //checked\r\n    // updates the value of sliders elements and load the module\r\n    function loadModule(loadXml) {\r\n        loadXml = XMLToJSON(loadXml);\r\n        // parses the xml and updates the values of sliders elements\r\n        parseXMLPreview(loadXml);\r\n    }\r\n\r\n    //checked\r\n    // parses the xml and updates the values of sliders elements\r\n    function parseXMLPreview(SLIDERXML) {\r\n        try {\r\n            // contains array of slider object\r\n            let sliderData = SLIDERXML.smxml.slider;\r\n            // creates an array for storing the data to update the values of sliders elements\r\n            localSliderData = [];\r\n            if (sliderData) {\r\n                if (Array.isArray(sliderData) == false) {\r\n                    // creates an array\r\n                    sliderData = [];\r\n                    // assign the value of slider key at index zero\r\n                    sliderData[0] = SLIDERXML.smxml.slider;\r\n                }\r\n            }\r\n            for (let i = 0; i < sliderData.length; i++) {\r\n                localSliderData.push({\r\n                    // used to set the id of the range element of the slider at index 'i'\r\n                    sliderid: sliderData[i]._key,\r\n                    // used to set the value of range element of slider at index 'i' when correct answer button is clicked\r\n                    anskey: sliderData[i]._anskey,\r\n                    // used to set the title value of the slider at index 'i'\r\n                    title_val: sliderData[i]._title,\r\n                    // used to set the step value of the slider at index 'i'\r\n                    step_val: sliderData[i]._step,\r\n                    // used to set the default value of the slider at index 'i'\r\n                    defaultans: sliderData[i]._defaultans,\r\n                    // not used any where so can be remove it\r\n                    defaultans_id: \"defaultans\" + sliderData[i]._key,\r\n                    // not used any where so can be remove it\r\n                    title_id: \"title\" + sliderData[i]._key,\r\n                    // not used any where so can be remove it\r\n                    step_id: \"step\" + sliderData[i]._key,\r\n                    // not used any where so can be remove it\r\n                    sliderans: \"slider\" + sliderData[i]._key,\r\n                    // not used any where so can be remove it\r\n                    remove_item: \"remove_item\" + sliderData[i]._key,\r\n                    // not used any where so can be remove it\r\n                    minid: \"min\" + sliderData[i]._key,\r\n                    // not used any where so can be remove it\r\n                    maxid: \"max\" + sliderData[i]._key,\r\n                    sliderop: \"sliderop\" + sliderData[i]._key,\r\n                    // used to define the min value of the range element and value of label min of slider at index 'i'\r\n                    minval: sliderData[i]._minmax.split(\",\")[0],\r\n                    // used to define the max value of the range element and value of label max of slider at index 'i'\r\n                    maxval: sliderData[i]._minmax.split(\",\")[1],\r\n                });\r\n            }\r\n        } catch (error) {\r\n            onError = error;\r\n            console.log({\r\n                'error': error,\r\n                'function': 'parseXMLPreview',\r\n                'File': 'SliderItemPreview.js'\r\n            });\r\n        }\r\n    }\r\n\r\n    // display the correct or incorrect according to the answer matched\r\n    function displayAns() {\r\n        // contains correct or incorrect according to the return value of checkAns method\r\n        let ans = checkAns();\r\n        if (editorState) {\r\n            // shows the answer correct or incorrect according to the value of variable 'ans'\r\n            showAns(ans);\r\n        }\r\n    }\r\n\r\n    /* defines the user answer xml, checks the answer and returns correct or incorrect according to the match of result */\r\n    function checkAns() {\r\n        // used for switch on next question in prepengine if current question is attempted\r\n        ISSPECIALMODULEUSERXMLCHANGE = 1;\r\n        // used to create user answer xml\r\n        userAnsXML = \"<smans type='30'>\";\r\n        result = true;\r\n        localSliderData.map(function (data) {\r\n            state.datauserans[data.sliderid] = (state.datauserans[data.sliderid]) === undefined ? data.defaultans : state.datauserans[data.sliderid];\r\n            if (parseInt(data.anskey) != parseInt(state.datauserans[data.sliderid])) {\r\n                result = false;\r\n            } \r\n            userAnsXML += \"<slider id='\" + data.sliderid + \"' userAns='\" + state.datauserans[data.sliderid] + \"'></slider>\";\r\n        });\r\n        userAnsXML += \"</smans>\";\r\n        // defined this condition for not update the user answer xml if user has not performed anything\r\n        // if (localSliderData.length > 0) {\r\n        //     // defines the user answer xml\r\n        //     uxml = userAnsXML;\r\n        // }\r\n        if(!editorState) {\r\n            onUserAnsChange({uXml: userAnsXML, ans: result});\r\n        }\r\n        if (result) {\r\n            //AH.select(\"#answer\").checked = true; //@sneh : this was commented that's why in quiz player answer was not recording\r\n            return \"Correct\";\r\n        } else {\r\n            //AH.select(\"#answer\").checked = false; //@sneh : this was commented that's why in quiz player answer was not recording\r\n            return \"Incorrect\";\r\n        }\r\n    }\r\n\r\n    // change the value of state datauserans after changing the value of slider range\r\n    function handleRange() {\r\n        // updates the value of state datauserans at given key \r\n        state.datauserans[this.id] = this.value;\r\n        // updates the value of state datauserans\r\n        state.datauserans = state.datauserans;\r\n        // display the correct or incorrect according to the answer matched\r\n        displayAns();\r\n    }\r\n\r\n    //checked\r\n    // checks and show the answer, shows correct answer and your answer button and not allow the user to perform the task\r\n    function setReview() {\r\n        targetView = \"block\";\r\n        isReview = true;\r\n    }\r\n\r\n    //checked\r\n    // allow the user to perform the task and hides correct answer and your answer button\r\n    function unsetReview() {\r\n        targetView = \"none\";\r\n        isReview = false;\r\n    }\r\n\r\n    //checked\r\n    function handleReviewMode(mode) {\r\n        if (mode == 'c') {\r\n            user_ans_tab = false;\r\n        } else if (mode == 'u') {\r\n            user_ans_tab = true;\r\n        }\r\n    }\r\n    \r\n</script>\r\n{#if onError != \"\" }\r\n    <div class=\"alert alert-danger font-weight-bold\">\r\n        <span>{l.oops_msg} </span>\r\n    </div>\r\n{/if}\r\n<div class=\"text-center\">\r\n    <ItemHelper \r\n        on:setReview = {setReview}\r\n        on:unsetReview = {unsetReview}\r\n        reviewMode={isReview}\r\n        handleReviewClick = {handleReviewMode}\r\n    />\r\n    <div id=\"slidermain\">\r\n        <div class=\"slider_item_container\">\r\n            {#each localSliderData as data, i}\r\n                <div key={i} class=\"clearfix slider_container my-3 rounded w-100\">\r\n                    <div class=\"slider_heading_test text-start text-white bg-primary\" tabindex=\"0\">\r\n                        <span> {data.title_val}</span>\r\n                    </div>\r\n                    <div class=\"col-md-12 select_slider_test w-100 pt-3 px-3 pb-2\">\r\n                        <input\r\n                            id={data.sliderid}\r\n                            type=\"range\"\r\n                            name=\"sliderrange\"\r\n                            min={data.minval}\r\n                            max={data.maxval}\r\n                            step={data.step_val}\r\n                            class=\"slideritem\"\r\n                            value={(targetView == \"block\" && user_ans_tab == false) ? parseInt(data.anskey) : (state.datauserans[data.sliderid] == 0 || state.datauserans[data.sliderid] == undefined) ? parseInt(data.defaultans) : parseInt(state.datauserans[data.sliderid])}\r\n                            disabled={targetView == 'block' ? true : false}\r\n                            on:input={handleRange}\r\n                            tabindex=\"0\"\r\n                        />\r\n                        {#if (targetView == \"block\" && user_ans_tab == true)}\r\n                            {#if data.anskey == state.datauserans[data.sliderid]}\r\n                                <span class=\"correct_incorrect_icon_fill position-absolute\">\r\n                                    <span class=\"icomoon-new-24px-checkmark-circle-1 font-weight-bold text-success\"></span>\r\n                                </span>\r\n                            {:else}\r\n                                <span class=\"correct_incorrect_icon_fill position-absolute\">\r\n                                    <span class=\"icomoon-new-24px-cancel-circle-1 font-weight-bold text-danger\"></span>\r\n                                </span>\r\n                            {/if}\r\n                        {/if}\r\n                        <div class=\"range_details mt-2 row mx-0\">\r\n                            <div class=\"minRange float-start col px-0 text-start\" tabindex=\"0\">\r\n                                <span>{l.min_val}: {data.minval}</span>\r\n                            </div>\r\n                            <div class=\"rangevalue col px-0\" tabindex=\"0\">\r\n                                <div class=\"current_val\">\r\n                                    {#if !(targetView == \"block\" && user_ans_tab == false)}\r\n                                        <span>{l.current_val}: {(state.datauserans[data.sliderid] == 0  || state.datauserans[data.sliderid] == undefined) ? (data.defaultans) : (state.datauserans[data.sliderid])} </span>\r\n                                    {:else}\r\n                                        <span> {l.correct_val}: {data.anskey} </span>\r\n                                    {/if}\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"max_val float-end col px-0 text-end\" tabindex=\"0\">\r\n                                <span> {l.max_val}: {data.maxval} </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            {/each}\r\n        </div>\r\n    </div>\r\n</div>\r\n"],"names":["l","oops_msg","insert","append","ctx","anskey","datauserans","sliderid","correct_val","current_val","undefined","defaultans","title_val","min_val","minval","max_val","maxval","step_val","parseInt","length","jsontoArray","obj","Array","isArray","temp","userAnsXML","result","xml","uxml","showAns","isReview","editorState","localSliderData","user_ans_tab","state","targetView","onError","loadModule","loadXml","SLIDERXML","sliderData","smxml","slider","i","push","_key","_anskey","_title","_step","_defaultans","defaultans_id","title_id","step_id","sliderans","remove_item","minid","maxid","sliderop","_minmax","split","error","console","log","function","File","parseXMLPreview","XMLToJSON","displayAns","ans","ISSPECIALMODULEUSERXMLCHANGE","map","data","onUserAnsChange","uXml","checkAns","setReview","onMount","window","inNative","getHeight","oldjsonraw","newjsonraw","oldjson","newjson","uaXML","smans","_userAns","this","id","value","mode"],"mappings":"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"}