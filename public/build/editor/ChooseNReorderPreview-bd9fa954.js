import{G as e,S as t,i as s,s as o,e as r,f as n,h as i,o as a,b as l,c,u,j as d,m,l as f,x as h,t as p,a as b,d as g,D as _,y as A,p as v,A as w,a1 as S,F as x,w as k,X as y}from"./main-a1cb066e.js";import{I as q}from"./ItemHelper-4ba8e744.js";import{h as L}from"./hotkeys.esm-4c49bce2.js";import{S as E}from"./sortable.esm-143959dc.js";const C=new e;var M={};let I,P,T,D;M.ajax_eId="#choose",M.userAnsXML="",M.errorCatchFlag=1,C.listen(document,"keyup",".sm_input_text",(function(){""==document.querySelector(".sm_input_text").value&&document.querySelector(".add-option")?document.querySelector(".add-option").disabled=!0:document.querySelector(".add-option")&&(document.querySelector(".add-option").disabled=!1)})),M.update_XMLValue=function(){var e=[];if(C.selectAll(".choose_item_container textarea").forEach((t=>{if(t.value.length>0){const s=t.value.replace(/\r?\n/g,"||");C.prevElm(t,"input")&&C.prevElm(t,"input").checked?e.push("*"+s):e.push(s)}})),document.querySelector("#special_module_xml")){var t=document.querySelector("#special_module_xml").value;C.find(t,"list").setAttribute("headingCorrect",document.querySelector("#headingCorrect").value),C.find(t,"list").setAttribute("allowSort",document.querySelector("#allowSort").getAttribute("value")),C.find(t,"list").setAttribute("isSentence",document.querySelector("#isSentence").getAttribute("value")),C.find(t,"list").setAttribute("isParagraph",document.querySelector("#isParagraph").getAttribute("value")),C.find(t,"list").innerHTML="\x3c!--[CDATA["+e.join("\n")+"]]--\x3e",document.querySelector("#special_module_xml").value=formatXml(t.xml?t.xml:(new XMLSerializer).serializeToString(t[0]),!0)}},M.showAns=function(e,t,s){"c"==s?(M.review(e,1),M.sortList(e,"correct_seq")):"u"==s&&(M.review(e,0),M.sortList(e,"user_seq"))},M.sortList=function(e,t){var s=C.selectAll(e+" #sortable > li"),o=Array.from(s);o.sort((function(e,s){var o=parseInt(e.getAttribute(t));0===o&&(o=Number.MAX_VALUE);var r=parseInt(s.getAttribute(t));return 0===r&&(r=Number.MAX_VALUE),o-r})),C.selectAll(e+" #sortable > li").forEach((e=>{e.remove()})),o.forEach((t=>{C.find(e,"#sortable").append(t)}))},M.togseq=function(e){var t=C.find(e,"#sortable").getAttribute("checkSeq");C.find(e,"#sortable").setAttribute("checkSeq","1"==t?"0":"1"),C.find(e,"#instruction").innerHTML="1"==t?"":"Sequence Important"},M.review=function(e,t){var s=document.querySelector(e)?.querySelector("#sortable")?.getAttribute("checkSeq"),o=1==t?"is_correct":"user_answer",r=1==t?"correct_seq":"user_seq";"normal"==C.select(e).getAttribute?.("type")?C.find(e,"#sortable li","all").forEach((e=>{if("1"==s){if(1==e.getAttribute(o))var n=e.getAttribute(r);else n=0;C.find(e,".prefix").innerHTML=n>0?n:"",C.find(e,".prefix",{action:"removeClass",actionData:"tick"})}else 1==e.getAttribute(o)?C.find(e,".prefix",{action:"addClass",actionData:"tick"}):C.find(e,".prefix",{action:"removeClass",actionData:"tick"});1==e.getAttribute("user_answer")&&0==t||1==e.getAttribute("is_correct")&&1==t?e.classList.add("choose_sel"):e.classList.remove("choose_sel")})):"sentence"!=C.select(e).getAttribute?.("type")&&"paragraph"!=C.select(e).getAttribute?.("type")||M.setActiveClass(e,t)},M.CheckResultchoose=function(e){var t=!0,s=0;let o=C.find(e,"#sortable");var r=Array.isArray(o)?"":o.getAttribute("checkSeq"),n="";return C.find(e,"#sortable li","all").forEach((e=>{var o=e.getAttribute("user_seq"),i=e.getAttribute("user_answer");"1"==r?(o!=e.getAttribute("correct_seq")&&(t=!1),"undefined"!=typeof calculatePoint&&e.getAttribute("correct_seq")>0&&o==e.getAttribute("correct_seq")&&s++):(i!=e.getAttribute("is_correct")&&(t=!1),"undefined"!=typeof calculatePoint&&e.getAttribute("is_correct")>0&&i==e.getAttribute("is_correct")&&s++),n+=e.getAttribute("optID")+"|"+o+"|"+i+","})),"undefined"!=typeof calculatePoint&&calculatePoint(C.find(e,"#sortable").getAttribute("totalCorrectAns"),s),M.userAnsXML='<SMANS type="6"><list useranswer="'+n+'" /></SMANS>',ISSPECIALMODULEUSERXMLCHANGE=1,document.querySelector("#special_module_user_xml")&&(document.querySelector("#special_module_user_xml").value=M.userAnsXML),document.querySelector("#answer")&&(document.querySelector("#answer").checked=t),1==t?"Correct":"Incorrect"},M.touchHandler=function(e){var t=e.changedTouches[0],s="";switch(e.type){case"touchstart":s="mousedown";break;case"touchmove":s="mousemove";break;case"touchend":s="mouseup";break;default:return}var o=document.createEvent("MouseEvent");o.initMouseEvent(s,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(o)},M.init=function(e){document.addEventListener("touchstart",M.touchHandler,!0),document.addEventListener("touchmove",M.touchHandler,!0),document.addEventListener("touchend",M.touchHandler,!0),document.addEventListener("touchcancel",M.touchHandler,!0),C.bind(e,"touchstart",(function(e){e.preventDefault()})),C.bind(e,"touchmove",(function(e){e.preventDefault()}))},M.shouldselect=!1,M.readyThis=function(e){(null!=typeof isTouchable||isiPad)&&setTimeout((function(){C.find(e,"#sortable").removeAttribute("onmouseup"),C.listen(C.find("body",e),"click","#sortable",(function(){var t=window.event;M.ow=t.srcElement?t.srcElement:t.target,M.t=setTimeout((function(){M.setUserAns(e,M.ow,M.shouldselect)}),100)})),"0"!=document.querySelector("#sortable").getAttribute("checkseq")&&new E(C.find(e,"#sortable"),{onEnd:function(t){M.ow=t.srcElement?t.srcElement:t.target,M.t=setTimeout((function(){M.setUserAns(e,M.ow,M.shouldselect)}),100)}})}),200)},M.bindKeyup=function(e){var t=0;function s(e,t=1){if(e.id){let s=C.selectAll(".ks"),o=-1;for(let r=0;r<s.length;r++)if(e.id==s[r].id){o=t?r==s.length-1?0:r+1:0==r?s.length-1:r-1;break}-1!=o&&s[o].focus()}}function o(){var s,o;t=0,s=C.find(e,"#sortable .copied"),o=C.find(e,".ks").length,s.classList.contains("copied")&&(0==t?s.insertBefore(C.find(e,".ks:nth(0)")):s.insertAfter(C.find(e,".ks:nth("+t+")"))),C.find(e,".ks:nth("+t+")").focus(),t==o-1?t=0:t++}function r(){var e=!1;let t=C.selectAll("#sortable li"),s=C.select(":focus");if(s.nodeName){let o=s.getAttribute("id");for(let s=0;s<t.length;s++)if(o==t[s].getAttribute("id")){e=!0;break}}return e}L.unbind("down,up,enter,alt+down,delete,left,right,tab,shift+tab,esc","choose"+e),C.find(e,"#sortable li","all").forEach((e=>{e.classList.add("ks")})),C.bind(document,"click",(function(){r()||C.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"})})),C.listen(document,"keydown",e,(function(){L.setScope("choose"+e)})),L("down, up, enter, alt+down, delete, left, right, tab, shift+tab, esc","choose"+e,(function(t,n){switch(n.key){case"up":case"left":if(r()){var i=C.find(e,"#sortable .copied"),a=C.find(e,".ks").length;let o=C.select(".ks:focus"),r=C.selectAll(".ks")[0];o.id==r.id?i&&i.classList.contains("copied")?(i.insertAfter(C.find(e,".ks:nth("+(a-1)+")")),i.focus()):C.selectAll(".ks")[C.selectAll(".ks").length-1].focus():i&&i.classList.contains("copied")?(i.insertBefore(C.find(e,"#sortable .copied").previousElementSibling),i.focus()):s(o,0),t.preventDefault()}break;case"down":case"right":if(r()){console.log("check");i=C.find(e,"#sortable .copied"),C.selectAll(e+" .ks").length;let o=C.select(".ks:focus"),r=C.selectAll(".ks")[C.selectAll(".ks").length-1];if(o.id==r.id)i&&i.classList.contains("copied")?(i.insertBefore(C.find(e,".ks:nth(0)")),i.focus()):C.selectAll(".ks")[0].focus();else if(i&&i.classList.contains("copied")){var l=C.find(e,"#sortable .copied").nextSibling.cloneNode(!0);i.insertAfter(l,C.find(e,"#sortable .copied").nextSibling),i.focus()}else s(o,1);t.preventDefault()}break;case"enter":r()&&(t.preventDefault(),"0"==C.find(e,"#sortable").getAttribute("checkseq")?(M.ow=C.find(e,"#sortable li:focus","all")[0],M.t=setTimeout((function(){M.setUserAns(e,M.ow,!0)}),100)):"1"==C.find(e,"#sortable").getAttribute("checkseq")&&(C.find(e,"#sortable li:focus").classList.contains("copied")?(M.ow=C.find(e,"#sortable li:focus","all")[0],M.t=setTimeout((function(){M.setUserAns(e,M.ow,!C.find(e,"#sortable li:focus").classList.contains("choose_sel"))}),100),C.find(e,"#sortable li:focus",{action:"removeClass",actionData:"copied"})):(M.ow=C.find(e,"#sortable li:focus","all")[0],M.t=setTimeout((function(){M.setUserAns(e,M.ow,!C.find(e,"#sortable li:focus").classList.contains("choose_sel"))}),100),C.find(e,"#sortable li:focus",{action:"addClass",actionData:"copied"}))));break;case"alt+down":o();break;case"delete":r()&&(M.ow=C.find(e,"#sortable li:focus","all")[0],M.t=setTimeout((function(){M.setUserAns(e,M.ow,!0)}),100));break;case"tab":r()&&C.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"});let n=C.selectAll(".ks:focus"),c=C.selectAll(".ks")[C.selectAll(".ks").length-1];n.id==c.id&&(t.preventDefault(),C.selectAll(".ks")[0].focus());break;case"shift+tab":r()&&C.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"}),n=C.selectAll(".ks:focus"),c=C.selectAll(".ks")[C.selectAll(".ks").length-1],n.id==c.id&&(t.preventDefault(),C.selectAll(".ks")[C.selectAll(".ks").length].focus());break;case"esc":r()&&(t.preventDefault(),C.find(e,"#sortable .copied",{action:"removeClass",actionData:"copied"}),C.selectAll(".ks")[C.selectAll(".ks").length-1].focus(),C.selectAll(".ks")[C.selectAll(".ks").length-1].blur())}})),L.setScope("choose"+e)},M.cmd=function(e,t){M.shouldselect=!0},M.cmm=function(e,t){t||(t=window.event);var s=t.srcElement?t.srcElement:t.target;if(s.classList.contains("prefix")&&(s=s.parentElement),s){var o=s.getAttribute("user_answer");M.shouldselect=!1,"0"==o&&(M.shouldselect=!0)}},M.cmu=function(e,t,s=!1){s?M.ow=t:(t||(t=window.event),M.ow=t.srcElement?t.srcElement:t.target),M.ow.classList.contains("prefix")&&(M.ow=M.ow.parentElement),M.t=setTimeout((function(){M.setUserAns(e,M.ow,M.shouldselect)}),100)},M.setUserAns=function(e,t,s){if("IMG"==t.tagName?(I=C.parent(t,"li").getAttribute("user_answer"),P=C.parent(t,"li").getAttribute("user_seq"),T=C.find(e,"#sortable").getAttribute("checkSeq")):(I=t.getAttribute("user_answer"),P=t.getAttribute("user_seq"),T=C.find(e,"#sortable").getAttribute("checkSeq")),"UL"!=t.tagName){if(s)if("1"==I)if("IMG"==t.tagName){let e=C.parent(t,"li");C.setAttr(e,{user_answer:0}),e.classList.remove("choose_sel"),"1"!=T&&C.find(e,".prefix","all").classList.remove("tick")}else C.setAttr(t,{user_answer:0}),t.classList.remove("choose_sel"),"1"!=T&&C.find(t,".prefix",{action:"removeClass",actionData:"tick"});else if("IMG"==t.tagName){if(C.find(document.querySelector(t).parentElement,"li","all").setAttribute("user_answer",1),C.select(t.parentElement).classList.add("choose_sel"),"1"!=T){let e=C.parent(t,"li");C.find(e,".prefix").classList.add("tick")}}else C.setAttr(t,{user_answer:1}),t.classList.add("choose_sel"),"1"!=T&&C.find(t,".prefix",{action:"addClass",actionData:"tick"});if("1"==T){var o=1;C.find(e,"#sortable li","all").forEach((e=>{1==e.getAttribute("user_answer")?(C.find(e,".prefix").innerHTML=o,C.setAttr(e,{user_seq:o}),o++):(C.find(e,".prefix").innerHTML="",C.setAttr(e,{user_seq:0}))}))}M.CheckResultchoose(e),M.shouldselect=!1}else M.shouldselect=!1},M.removeItem=function(){C.remove(e1.parentElement.parentElement),document.querySelectorAll(".choose_item_container").innerHTML.trim().length<=200?document.querySelector(".message_content").style.display="block":document.querySelector(".message_content").style.display="none"},M.addItem=function(){document.querySelector(".message_content").style.display="none",C.insert(".choose_item_container",'<div class="clearfix mt choose_options"><div class="col-md-12 mt-head"><input class="choose_compls" type="checkbox"><textarea></textarea><span class="remove-item icomoon-24px-delete-1"></span></div></div>',"afterbegin")},M.setDragSequence=function(e,t,s){var o=1;C.find(e,"#sortable li","all").forEach((e=>{C.setAttr(e,{user_seq:o}),o++})),0==s&&C.find(e,"#sortable li","all").forEach((e=>{e.classList.remove("choose_sel")})),M.CheckResultSentenceChoose(e)},M.CheckResultSentenceChoose=function(e){var t=!0;T=C.find("#choose","#sortable").getAttribute("checkSeq");var s="";return C.find(e,"#sortable li","all").forEach((e=>{P=e.getAttribute("user_seq"),D=e.getAttribute("correct_seq"),I=e.getAttribute("user_answer"),P!=D&&0!=e.getAttribute("correct_seq")&&(t=!1),s+=e.getAttribute("optID")+"|"+P+"|"+I+","})),M.userAnsXML='<SMANS type="6"><list useranswer="'+s+'" /></SMANS>',ISSPECIALMODULEUSERXMLCHANGE=1,document.querySelector("#special_module_user_xml")&&(document.querySelector("#special_module_user_xml").value=M.userAnsXML),document.querySelector("#answer")&&C.setAttr("#answer",{checked:t}),1==t?"Correct":"Incorrect"},M.dragSenParItem=function(e){new E(C.find(e,"#sortable"),{onStart:function(e){console.log("start =>"+e)},onEnd:function(t){console.log("end =>"+t),M.setDragSequence(e,t.item)}}),M.CheckResultchoose(e)},M.setActiveClass=function(e,t){C.find(e,"#sortable").getAttribute("checkSeq");C.find(e,"#sortable li","all").forEach((e=>{1==e.getAttribute("user_answer")&&0==t||1==e.getAttribute("is_correct")&&1==t?e.classList.add("choose_sel"):e.classList.remove("choose_sel")}))},M.removeActive=function(e){C.find(e,"#sortable li","all").forEach((e=>{e.classList.remove("choose_sel")}))},M.labBinded=!0,M.sortable=!1,M.modeOn=function(e){C.selectAll(".test","addClass","h"),C.selectAll(".review","addClass","h"),e?(C.selectAll(".review","removeClass","h"),M.unBindLab(),void 0!==L&&L.unbind("down,up,enter,alt+down,delete,left,right,tab,shift+tab,esc","choose"+M.ajax_eId),C.find(M.ajax_eId,".copied","all").forEach((e=>{e.classList.remove("copied")})),null!=document.querySelector("#show_ans_group button")&&document.querySelector("#show_ans_group button").forEach((e=>{e.classList.contains("correct-ans btn-primary")?M.showAns(M.ajax_eId,e,"c"):e.classList.contains("your-ans btn-primary")&&M.showAns(M.ajax_eId,e,"u")}))):(C.selectAll(".test","removeClass","h"),setTimeout((function(){M.callBindKey()}),100),M.review(M.ajax_eId,0),M.bindLab())},M.callBindKey=function(){void 0!==L?M.bindKeyup(M.ajax_eId):(M.errorCatchFlag<=50?setTimeout((function(){M.callBindKey()}),100):console.log("hotkeys not found"),M.errorCatchFlag++)},M.unBindLab=function(){M.labBinded=!1,"normal"==document.querySelector(M.ajax_eId).getAttribute("type")&&C.find(M.ajax_eId,"#sortable").removeAttribute("onmouseup onmousemove onmousedown"),C.find(M.ajax_eId,"#sortable").classList.contains("ui-sortable")&&(M.sortable=!0)},M.bindLab=function(){M.labBinded=!0,C.bind(document.querySelector("#sortable"),"mouseup",(function(e){M.cmu(M.ajax_eId,e)})),C.bind(document.querySelector("#sortable"),"mousemove",(function(e){M.cmm(M.ajax_eId,e)})),C.bind(document.querySelector("#sortable"),"mousedown",(function(e){M.cmd(M.ajax_eId,e)})),Array.isArray(C.find(M.ajax_eId,"#sortable"))||new E(C.find(M.ajax_eId,"#sortable"),{animation:150,onEnd:function(e){M.cmu(M.ajax_eId,e.item,!0),C.select(M.ajax_eId).click()}}),"sentence"!=document.querySelector(M.ajax_eId)?.getAttribute?.("type")&&"paragraph"!=document.querySelector(M.ajax_eId)?.getAttribute?.("type")||M.dragSenParItem(M.ajax_eId)};const{document:j}=x;function X(e,t,s){const o=e.slice();return o[26]=t[s],o[28]=s,o}function N(e){let t,s,o,l,c,u,d,m,f,h,p=e[9](e[26])+"";return{c(){t=r("li"),n(t,"key",s=e[28]),n(t,"class",o="1"==e[3].isSentence?"sentence_li":"1"==e[3].isParagraph?"paragraph_li":""),n(t,"is_correct",l=e[26].isCorrect),n(t,"optid",c=e[26].optid),n(t,"correct_seq",u=e[26].seq),n(t,"user_answer",d=e[26].user_answer),n(t,"u",m=e[26].user_answer),n(t,"user_seq",f=e[26].user_seq?e[26].user_seq:e[28]),n(t,"id",h="id"+e[28]),n(t,"tabindex","0")},m(e,s){i(e,t,s),t.innerHTML=p},p(e,s){4&s&&p!==(p=e[9](e[26])+"")&&(t.innerHTML=p),8&s&&o!==(o="1"==e[3].isSentence?"sentence_li":"1"==e[3].isParagraph?"paragraph_li":"")&&n(t,"class",o),4&s&&l!==(l=e[26].isCorrect)&&n(t,"is_correct",l),4&s&&c!==(c=e[26].optid)&&n(t,"optid",c),4&s&&u!==(u=e[26].seq)&&n(t,"correct_seq",u),4&s&&d!==(d=e[26].user_answer)&&n(t,"user_answer",d),4&s&&m!==(m=e[26].user_answer)&&n(t,"u",m),4&s&&f!==(f=e[26].user_seq?e[26].user_seq:e[28])&&n(t,"user_seq",f)},d(e){e&&a(t)}}}function U(e){let t;return{c(){t=u("Sequencing of the selected item is not required. Click to select items.")},m(e,s){i(e,t,s)},d(e){e&&a(t)}}}function R(e){let t;return{c(){t=u("Click to select. Drag and Drop to set sequence.")},m(e,s){i(e,t,s)},d(e){e&&a(t)}}}function H(e){let t,s,o,v,w,S,x,k,y,L,E,C,M,I,P,T,D,H,$,B,O,G,F,K=e[3].headingCorrect+"";x=new q({props:{handleReviewClick:e[10],reviewMode:e[0]}}),x.$on("setReview",e[4]),x.$on("unsetReview",e[5]);let J=e[2],V=[];for(let t=0;t<J.length;t+=1)V[t]=N(X(e,J,t));function z(e,t){return 1==e[3].allowSort||1==e[3].isSentence||1==e[3].isParagraph?R:U}let Y=z(e),Q=Y(e);return{c(){t=r("link"),o=l(),v=r("main"),w=r("div"),S=r("center"),c(x.$$.fragment),k=l(),y=r("center"),L=r("div"),E=r("div"),C=u(K),M=l(),I=r("ul");for(let e=0;e<V.length;e+=1)V[e].c();H=l(),$=r("div"),Q.c(),n(t,"onload","this.rel='stylesheet'"),n(t,"rel","preload"),n(t,"as","style"),n(t,"href",s=editor.baseUrlTheme+"clsSMChoose/css/choose.min.css"),n(E,"class","choose_header font17 pl-4"),n(I,"id","sortable"),n(I,"totalcorrectans",P=e[3].totalcorrectans),n(I,"checkseq",T=e[3].allowSort),n(I,"class","ui-sortable w-auto mt-0 p-2"),n(I,"style",D="border-left:10px solid #d9e7fd;border-right: 10px solid #d9e7fd"),n($,"class","choose_bottom pl-4"),n($,"id","instruction"),n(L,"id",e[1]),n(L,"type",B="1"==e[3].isSentence?"sentence":"1"==e[3].isParagraph?"paragraph":"normal"),n(L,"class","bg-white")},m(s,r){d(j.head,t),i(s,o,r),i(s,v,r),d(v,w),d(w,S),m(x,S,null),d(w,k),d(w,y),d(y,L),d(L,E),d(E,C),d(L,M),d(L,I);for(let e=0;e<V.length;e+=1)V[e].m(I,null);d(L,H),d(L,$),Q.m($,null),O=!0,G||(F=[f(I,"mouseup",e[6].bind(this)),f(I,"mousemove",e[7].bind(this)),f(I,"mousedown",e[8].bind(this))],G=!0)},p(e,[t]){const s={};if(1&t&&(s.reviewMode=e[0]),x.$set(s),(!O||8&t)&&K!==(K=e[3].headingCorrect+"")&&h(C,K),524&t){let s;for(J=e[2],s=0;s<J.length;s+=1){const o=X(e,J,s);V[s]?V[s].p(o,t):(V[s]=N(o),V[s].c(),V[s].m(I,null))}for(;s<V.length;s+=1)V[s].d(1);V.length=J.length}(!O||8&t&&P!==(P=e[3].totalcorrectans))&&n(I,"totalcorrectans",P),(!O||8&t&&T!==(T=e[3].allowSort))&&n(I,"checkseq",T),Y!==(Y=z(e))&&(Q.d(1),Q=Y(e),Q&&(Q.c(),Q.m($,null))),(!O||2&t)&&n(L,"id",e[1]),(!O||8&t&&B!==(B="1"==e[3].isSentence?"sentence":"1"==e[3].isParagraph?"paragraph":"normal"))&&n(L,"type",B)},i(e){O||(p(x.$$.fragment,e),O=!0)},o(e){b(x.$$.fragment,e),O=!1},d(e){a(t),e&&a(o),e&&a(v),g(x),_(V,e),Q.d(),G=!1,A(F)}}}function $(e,t,s){let{cmed:o}=t,{showAns:r}=t,{xml:n}=t,{stopPreviewUpdate:i}=t,{editorState:a}=t,{isReview:l}=t,{uaXML:c}=t,u=o?"choose"+o:"choose";M.ajax_eId=o?"#choose"+o:"#choose";var d=[];let m={};k({xml:"",headingCorrect:"",allowSort:"",isSentence:"",isParagraph:"",chooseClass:"",totalcorrectans:"",stateXMLToJSON:""}).subscribe((e=>{s(3,m=e)}));function f(){var e="";e=("1"==m.isSentence||m.isParagraph,M.CheckResultchoose("#"+u)),a&&r(e)}function h(){console.log("checking"),b("none"),M.modeOn("on"),s(0,l=!0),M.review("#"+u,0),w.removeClass("#show_ans_group button","active"),w.removeClass("#show_ans_group .your-ans","active"),f()}function p(){b("auto"),s(0,l=!1),M.modeOn(),M.review("#"+u,0)}function b(e){w.selectAll("#sortable li").forEach((t=>{t.style.pointerEvents=e}))}return v((()=>{w.bind(document,"click",(function(){if(document.querySelector(".editorRender"))return document.querySelector(".editorRender").clientHeight})),w.listen(document,"click","#"+u,(function(){setTimeout((function(){f()}),100)})),w.listen(document,"click","#show_ans_group button",(e=>{w.removeClass("#show_ans_group button","active"),w.addClass(e,"active")}))})),S((()=>{if(n!=m.xml){if(1==i)return!1;o&&(s(1,u="choose"+o),M.ajax_eId="#choose"+o),s(3,m.xml=n,m),s(3,m.stateXMLToJSON=y(n),m),function(e){if(function(e){try{s(2,d=[]);let o=e.smxml.list.__cdata.split("\n"),r=1,n=0,i=0;o.forEach((function(e,t){""!=o[t].trim()&&("*"==o[t].trim().charAt(0)&&n++,d.push({value:o[t].trim(),isCorrect:"*"==o[t].trim().charAt(0)?"1":"0",seq:"*"==o[t].trim().charAt(0)?r:"0",user_answer:"0",optid:i}),"*"==o[t].trim().charAt(0)&&r++,i++)})),function(e){for(var t=e.length-1;t>0;t--){var s=Math.floor(Math.random()*(t+1)),o=e[t];e[t]=e[s],e[s]=o}}(d),e=function(e){let t=e;return t.smxml.list._headingCorrect&&(t.smxml.list._headingcorrect=t.smxml.list._headingCorrect,delete t.smxml.list._headingCorrect),t.smxml.list._allowSort&&(t.smxml.list._allowsort=t.smxml.list._allowSort,delete t.smxml.list._allowSort),t.smxml.list._isParagraph&&(t.smxml.list._isparagraph=t.smxml.list._isParagraph,delete t.smxml.list._isParagraph),t.smxml.list._isSentence&&(t.smxml.list._issentence=t.smxml.list._isSentence,delete t.smxml.list._isSentence),t}(e),s(3,m.headingCorrect=e.smxml.list._headingcorrect,m),s(3,m.allowSort=e.smxml.list._allowsort?e.smxml.list._allowsort:"0",m),s(3,m.isSentence=e.smxml.list._issentence?e.smxml.list._issentence:"0",m),s(3,m.isParagraph=e.smxml.list._isparagraph?e.smxml.list._isparagraph:"0",m),s(3,m.totalcorrectans=n,m);var t=setTimeout(function(){w.find("#sortable",".sentence_li","all").forEach((function(e,t){e.setAttribute("user_seq",t+1)})),clearTimeout(t)}.bind(this),200)}catch(e){this.onError=e,console.warn({error:e.message,"function name":"parseXMLPreview","File name":"ChooseNReorderPreview.js"})}}(e),window.uaXML){let e=y(c);if(e&&e.SMANS&&e.SMANS&&e.SMANS.list){let t=e.SMANS.list._useranswer.split(","),o=[];for(let e in t)if(t[e]){let r=t[e].split("|");for(let e in d)d[e].optid==r[0]&&(s(2,d[e].user_answer=r[2],d),s(2,d[e].user_seq=r[1],d),o.push(d[e]))}s(2,d=o)}}}(m.stateXMLToJSON);var e=setTimeout((function(){window.uaXML||(w.selectAll("#sortable li").forEach((e=>{e.setAttribute("user_answer","0"),e.setAttribute("style","")})),w.selectAll("#sortable li .prefix").forEach((e=>{e.innerHTML=""}))),M.removeActive("#"+u),M.review("#"+u,0),M.init("#"+u),M.CheckResultchoose("#"+u);new E(w.find("#"+u,"#sortable"),{animation:150});"1"==m.allowSort&&"1"!=m.isSentence&&"1"!=m.isParagraph||new E(w.find("#"+u,"#sortable"),{onEnd(e){e.item;e.to,e.from,e.oldIndex,e.newIndex,e.oldDraggableIndex,e.newDraggableIndex,e.clone,e.pullMode}}),"1"!=m.isSentence&&"1"!=m.isParagraph||M.dragSenParItem("#"+u),clearTimeout(e)}),200)}})),e.$$set=e=>{"cmed"in e&&s(11,o=e.cmed),"showAns"in e&&s(12,r=e.showAns),"xml"in e&&s(13,n=e.xml),"stopPreviewUpdate"in e&&s(14,i=e.stopPreviewUpdate),"editorState"in e&&s(15,a=e.editorState),"isReview"in e&&s(0,l=e.isReview),"uaXML"in e&&s(16,c=e.uaXML)},e.$$.update=()=>{1&e.$$.dirty&&setTimeout((function(){l?h():p()}),200)},[l,u,d,m,h,p,function(e){"1"!=m.isSentence&&"1"!=m.isParagraph&&M.cmu("#"+u,e)},function(e,t){"1"!=m.isSentence&&"1"!=m.isParagraph&&M.cmm(e,t)},function(e,t){"1"!=m.isSentence&&"1"!=m.isParagraph&&(M.cmd(e,t),ISSPECIALMODULEUSERXMLCHANGE=1)},function(e){return'<div class="prefix pl-2 position-relative mr-2"'+("1"==m.isSentence?"nw":"")+'"></div>'+("1"==m.isParagraph?'<div class="pg_handle">&equiv;</div>':"")+("*"==e.value.charAt(0)?e.value.slice(1):e.value)},function(e,t){"c"==e?M.showAns("#"+u,t.currentTarget,"c"):M.showAns("#"+u,t.currentTarget,"u")},o,r,n,i,a,c]}export default class extends t{constructor(e){super(),s(this,e,$,H,o,{cmed:11,showAns:12,xml:13,stopPreviewUpdate:14,editorState:15,isReview:0,uaXML:16})}}
//# sourceMappingURL=ChooseNReorderPreview-bd9fa954.js.map
