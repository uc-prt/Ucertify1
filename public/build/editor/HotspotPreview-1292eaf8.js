import{G as t,S as e,i,s,F as n,e as a,c as r,b as o,f as l,h as c,j as d,m as h,k as p,a as m,n as u,t as g,o as f,d as w,p as x,X as v,A as b,Z as y,q as A,r as S,g as _,u as k,M as C,a0 as I,l as N,a1 as $}from"./main-410076aa.js";import{I as M}from"./ItemHelper-e28132a5.js";import{s as T}from"./style-inject.es-1f59c1d0.js";const L=new t;class D{constructor(){this.userAnsXML="<SMANS></SMANS>",this.xaxis=[],this.yaxis=[],this.count=0,this.drawstr="",this.elemId="#hptmain0",this.labBinded=!0,this.result=!1,this.temp=0}readyThis(t,e,i,s){if(t="#"+t,!e){this.labBinded=!0;const e=function(e){if(this.labBinded){let i=e,s="";i.classList.contains("selected")?(i.setAttribute("data-userans",0),i.classList.remove("selected")):(i.setAttribute("data-userans",1),i.classList.add("selected")),L.find(t,"[type] .textClick.selected","all").forEach((function(t,e){s=0==e?t.textContent:s+"|"+t.textContent})),L.find(t,"[type]",{action:"attr",actionData:{"data-userans":s}})}},i=function(e){if(this.labBinded){let i="";"SPAN"==e.target?.nodeName?(L.select(e.target,"removeClass",["selecttext","selected"]),this.removespan(e.target,t,0)):this.highlightText(t),L.find(t,"[type] .selecttext.selected","all").forEach((function(t,e){i=0==e?t.textContent:i+"|"+t.textContent}));let s=L.find(t,"[type]");L.select(s,"attr",{"data-userhtml":s.innerHTML,"data-userans":i})}};L.listen(t,"touchstart",".textClick",e.bind(this)),L.listen(t,"touchend",".textClick",e.bind(this)),L.listen(t,"click",".textClick",e.bind(this)),L.listen(t,"touchstart",'[type="textselect"]',i.bind(this)),L.listen(t,"touchend",'[type="textselect"]',i.bind(this)),L.listen(t,"click",'[type="textselect"]',i.bind(this))}}check_Ans(t){let e={inNativeIsCorrect:!1,userAnswers:""};this.userAnsXML="<smans type='4'>\\n",this.result=!0,this.temp=0;let i=L.select(t).children;for(let e=0;e<i.length;e++)this.userAnsXML=this.checkChildAnswer(t,i[e],this.userAnsXML);return this.userAnsXML+="</smans>",window.ISSPECIALMODULEUSERXMLCHANGE=1,e.userAnswers=L.select("#special_module_user_xml").value,"undefined"!=typeof calculatePoint&&calculatePoint(L.select(t).getAttribute("totalcorrectans"),temp),window.inNative&&(window.getHeight?.(),e.inNativeIsCorrect=this.result,window.postMessage(JSON.stringify(e),"*")),{uXml:this.userAnsXML,status:this.result}}checkChildAnswer(t,e,i){let s=e.getAttribute("type");switch(s){case"textclick":case"textselect":var n=e.getAttribute("data-correctans").split("|").sort().join("|"),a=e.getAttribute("data-userans").split("|").sort();n!=(a=(a=a.filter((function(t){return t}))).join("|"))&&(this.result=!1),"undefined"!=typeof calculatePoint&&L.find(e,"p","all").forEach((t=>{t.classList.contains("selected")&&t.getAttribute("data-userans")==t.getAttribute("data-correctans")&&this.temp++})),this.userAnsXML+="textselect"==s?`<div id="${e.getAttribute("id")}" data-userHtml="${escape(e.getAttribute("data-userhtml"))}" data-userAns="${escape(e.getAttribute("data-userans"))}"></div>\\n`:`<div id="${e.getAttribute("id")}" data-userAns="${escape(e.getAttribute("data-userans"))}"></div>\\n`}return this.userAnsXML}showansdrag(t,e,i){void 0===i&&(i=0);let s=L.select(t).children;if(s)for(let n=0;n<s.length;n++)this.showchilddragans(t,s[n],e,i)}showchilddragans(t,e,i,s){let n=L.select(e);switch(n.getAttribute("type")){case"textclick":if("c"==i){L.find(n,".show_correct,.show_incorrect","all").length>0&&(L.find(n,".show_correct,.show_incorrect",{action:"removeClass",actionData:["show_correct","show_incorrect"]}),L.find(n,".correct_incorrect_icon",{action:"remove"}),L.find(n,".correct_incorrect_icon",{action:"removeAttr",actionData:"style"}));let s=e.getAttribute("data-correctans").split("|");e.getAttribute("type");s.forEach((e=>{this.selectText(t,e,i,"selected")}))}else if("u"==i){e.getAttribute("type");try{var a=decodeURIComponent(e.getAttribute("data-userans"))}catch(t){a=decodeURIComponent(unescape(e.getAttribute("data-userans")))}if(a=(a=a.split("|")).filter((function(t){return t})),void 0!==s&&1==s){L.find(t,".selected",{action:"removeClass",actionData:"selected"});var r=e.getAttribute("data-correctans").split("|");a.forEach((e=>{let s="show_incorrect";L.findInArray(e,r)?(s="show_correct",this.selectText(t,e,i,s)):this.selectText(t,e,i,s)}))}else a.forEach((e=>{this.selectText(t,e,"c","selected"),L.select(t+" p span").length&&L.select(t+" p span").remove(),L.select(".textClick","removeClass",["show_incorrect","show_correct"])}))}break;case"textselect":if("c"==i){L.find(n,".show_correct,.show_incorrect").length>0&&(L.find(n,".show_correct,.show_incorrect",{action:"removeClass",actionData:["show_correct","show_incorrect"]}),L.find(n,".correct_incorrect_icon",{action:"removeAttr",actionData:"style"}));r=e.getAttribute("data-correctans").split("|"),e.getAttribute("type");L.select(e,"html",e.getAttribute("data-correcthtml").replace(/<span>/g,"</span>"))}else if("u"==i){e.getAttribute("type");try{a=decodeURIComponent(e.getAttribute("data-userans"))}catch(t){a=decodeURIComponent(unescape(e.getAttribute("data-userans")))}if(a=(a=a.split("|")).filter((function(t){return t})),""!=e.getAttribute("data-userhtml")||"undefined"==e.getAttribute("data-userhtml")){var o=e.getAttribute("data-userhtml");try{o=decodeURIComponent(o);var l=decodeURIComponent(o)}catch(t){console.log(t)}L.select(e,"html",l)}if(void 0!==s&&1==s){let t='<span class="icomoon-new-24px-checkmark-circle-1 font-weight-bold" style="color:green;vertical-align:super;">',i='<span class="icomoon-new-24px-cancel-circle-1 font-weight-bold red" style="vertical-align: super;">';L.insert(e.querySelector('span[userans="1"]span[correctans="1"]'),'<span class="correct_incorrect_icon" style="position:absolute;z-index:100;width:18px;height:18px;bottom:17px;background:white;border-radius:12px;font-size: 18px;"> '+t+"</span></span>","beforeend"),L.insert(e.querySelector('span[userans="1"]span[correctans="0"]'),'<span class="correct_incorrect_icon" style="position:absolute;z-index:100;width:18px;height:18px;bottom:17px;background:white;border-radius:12px;font-size: 18px;"> '+i+"</span></span>","beforeend")}}break;case"imagehighlight":{let e=L.find(t,"canvas"),s=L.select("#special_module_parse").value,n=s.substring(s.indexOf("{"),s.lastIndexOf("}")+1);if(""!=n&&(n=JSON.parse(n)),this.drawOnCanvas(e,n,window.color),"c"==i){let t=e.getAttribute("correctans");""!=t&&(t=JSON.parse(t)),this.drawOnCanvas(e,t,"green")}break}}}calculateArea(t,e,i){return{top:Math.min.apply(Math,i),left:Math.min.apply(Math,e),width:Math.max.apply(Math,e)-Math.min.apply(Math,e),height:Math.max.apply(Math,i)-Math.min.apply(Math,i)}}getCoordinate(t,e,i,s){return 0==s?this.drawstr='{"'+ ++s+'":{"x":['+e+'],"y":['+i+"]}}":(this.drawstr=L.select("#special_module_parse").value,this.drawstr=this.drawstr.substring(this.drawstr.indexOf("{"),this.drawstr.lastIndexOf("}")+1),this.drawstr=this.drawstr.slice(0,-1),this.drawstr+=',"'+ ++s+'":{"x":['+e+'],"y":['+i+"]}}"),L.selectAll(L.select(t).children,"attr",{userans:this.drawstr}),this.createUserAnsXMLDraw(this.drawstr),this.userAnsXML}update_HTMLValue(){let t=L.parseHtml(L.select("#special_module_xml").value),e="",i="";if(t)for(let s of t.attributes)switch(na_attr.nameme){case"bgimg":e=s.value;break;case"path":i=s.value}let s=L.children(t,"div"),n=s.getAttribute("top"),a=s.getAttribute("left"),r=s.getAttribute("width"),o=s.getAttribute("height");L.select("#area","css",{height:o,top:n,width:r,left:a}),e&&i&&L.select("#im","attr",{src:i+"/"+e})}movetarget(t,e,i){let s;t.style.display="",!window.event&&i.layerX?(t.style.top=i.layerY-t.height/2+"px",t.style.left=i.layerX-t.width/2+"px"):(t.style.top=i.offsetY-t.height/2+"px",t.style.left=i.offsetX-t.width/2+"px"),s=this.checkmodule(t,e),this.createUserAnsXML(t.style.top,t.style.left);let n=document.getElementById("special_module_user_xml");n.value=this.userAnsXML,n=document.getElementById("answer"),n.checked=s>0,"undefined"!=typeof calculatePoint&&(this.temp=1==s,calculatePoint(1,s))}createUserAnsXMLDraw(t){this.userAnsXML='<SMANS type="4"><div userans="'+t+'"></div></SMANS>'}createUserAnsXML(t,e){this.userAnsXML='<SMANS type="4"><div targetTop="'+parseInt(t)+'" targetLeft="'+parseInt(e)+'" /></SMANS>'}checkmodule(t,e){let i=0;return parseInt(t.style.top)+t.height/2>=parseInt(e.style.top)&&parseInt(t.style.top)+t.height/2<=parseInt(e.style.top)+parseInt(e.style.height)&&parseInt(t.style.left)+t.width/2>=parseInt(e.style.left)&&parseInt(t.style.left)+t.width/2<=parseInt(e.style.left)+parseInt(e.style.width)&&(i=1),i}drawOnCanvas(t,e,i){if(t){let s=0!=t.toString().indexOf("d")?document.getElementById(t.getAttribute("id")):document.getElementById(t),n=null!=s?s.getContext("2d"):"",a=Object.keys(e).length;if(""!=e&&""!=n)for(let t=1;t<=a;t++)for(let s=0;s<=e[t].x.length;s++)n.beginPath(),n.lineWidth="4",n.strokeStyle=i,n.moveTo(e[t].x[s],e[t].y[s]),n.lineTo(e[t].x[s+1],e[t].y[s+1]),n.stroke()}}compareDrawing(t,e,i){let s=0,n=this.getAreaVal(t),a=this.getAreaVal(e),r=0,o=0,l=Object.keys(a).length,c=Object.keys(n).length;for(let t=1;t<=l;t++){for(let e=1;e<=c;e++)if(n[e].height<=a[t].height&&n[e].width<=a[t].width&&n[e].top>=a[t].top&&a[t].left+a[t].width-(n[e].left+n[e].width)>=0&&n[e].left>=a[t].left&&a[t].top+a[t].height-(n[e].top+n[e].height)>=0){r++;break}"undefined"!=typeof calculatePoint&&(t==r&&o++,calculatePoint(L.select(i).getAttribute("totalcorrectans"),o))}return l==r&&l==c&&(s=1),s}getAreaVal(t){let e=Object.keys(t).length;if(""!=t){let i=[];for(let s=1;s<=e;s++)i[s]=this.calculateArea("",t[s].x,t[s].y);return i}}selectText(t,e,i,s){let n=L.selectAll(t+" p");for(var a=0;a<n.length;a++){let t=n[a];if(t.textContent.trim()==e&&(t.classList.add(s),"u"==i)){let e;e="show_correct"==s?'<span class="icomoon-new-24px-checkmark-circle-1 font-weight-bold" style="color:green;vertical-align:7px">':'<span class="icomoon-new-24px-cancel-circle-1 font-weight-bold red" style="vertical-align:7px">',L.insert(t,'<span class="correct_incorrect_icon" style="position:absolute;z-index:100;width:18px;height:18px;bottom:16px;background:white;border-radius:12px;font-size: 18px;"> '+e+"</span></span>")}}}highlightText(t){if(0!=this.getSelected().getRangeAt(0).endOffset){this.snapSelectionToWord();let i=this.getSelected().getRangeAt(0),s=(i.startOffset,L.find(t,"[type]").getAttribute("data-correctans").split("|"));var e=i.toString();if(e=e.trim()){let t=L.findInArray(e,s)?1:0;this.pasteHtmlAtCaret("<span class='selecttext selected' correctans="+t+" userans='1'>"+e+"</span> ")}}}snapSelectionToWord(){let t;if(window.getSelection&&(t==window.getSelection()).modify){if(t=window.getSelection(),""!=t&&!t.isCollapsed){var e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);var i=e.collapsed;e.detach();var s=t.focusNode,n=t.focusOffset;t.collapse(t.anchorNode,t.anchorOffset),i?(L.findInArray(t.anchorNode.textContent.charAt(t.anchorOffset-1),[",",".","!","?",";",")","}"])&&(t.modify("move","backward","character"),t.modify("move","forward","word")),t.extend(s,n),t.modify("extend","forward","character"),t.modify("extend","backward","word")):(t.modify("move","forward","character"),t.modify("move","backward","word"),t.extend(s,n),L.findInArray(t.anchorNode.textContent.charAt(n-1),[",",".","!","?",";",")","}"])&&(t.modify("extend","backward","character"),t.modify("extend","forward","word")))}}else if(t==document.selection&&"Control"!=t.type){let e=t.createRange();if(e.text){for(e.expand("word");/\s$/.test(e.text);)e.moveEnd("character",-1);e.select()}}}pasteHtmlAtCaret(t){let e,i;if(window.getSelection){if(e=window.getSelection(),e.getRangeAt&&e.rangeCount){i=e.getRangeAt(0),i.deleteContents();var s=document.createElement("div");s.innerHTML=t;for(var n,a,r=document.createDocumentFragment();n=s.firstChild;)a=r.appendChild(n);i.insertNode(r),a&&(i=i.cloneRange(),i.setStartAfter(a),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)}getSelected(){if(window.getSelection)return window.getSelection();if(document.getSelection)return document.getSelection();var t=document.selection&&document.selection.createRange();return!!t.text&&t.text}removespan(t,e,i){let s=t.innerHTML,n=new RegExp("<\\/?span[^>]*>","g");s=s.replace(n,""),t.parentNode.replaceChild(document.createTextNode(s),t),i||L.find(e,"[type]",{action:"html",actionData:L.find(e,"[type]").innerHTML})}modeOnHot(t){L.selectAll(".test, .review","addClass","h"),t?(L.selectAll(".review","removeClass","h"),this.unBindLab(),this.showansdrag(this.elemId,"u",1)):(L.selectAll(".test","removeClass","h"),L.selectAll(".review","addClass","h"),this.bindLab(),this.showansdrag(this.elemId,"u",0))}unBindLab(){this.labBinded=!1,L.find(this.elemId,".hotArea0.hotArea",{action:"css",actionData:{display:"block"}}),L.find(this.elemId,".hotSpotImg",{action:"css",actionData:{pointerEvents:"none"}})}bindLab(){this.labBinded=!0,L.find(this.elemId,".hotArea0.hotArea",{action:"css",actionData:{display:"none"}}),L.find(this.elemId,".hotSpotImg",{action:"css",actionData:{pointerEvents:"auto"}})}}function O(t,e){return!0===isNaN(Number(t))?this.x=0:this.x=t,!0===isNaN(Number(e))?this.y=0:this.y=e,{X:this.x,Y:this.y}}const X=new t;class E{constructor(t){this.prevPoint=void 0,this.defaultOptions={target:"",penSize:1,width:t.width,height:t.height,cssClass:"",onClick:t=>{},onMove:t=>{},onPaint:t=>{},onRelease:t=>{}},this.penWidth=2,this.drawing=!1,this.cap="round",this.ID="dooScribCanvas"+Math.floor(100*Math.random()+1),this.drawingSurface="",t&&(this.Settings={...this.defaultOptions,...t}),!0===isNaN(this.Settings.height)&&(this.Settings.height=100),!0===isNaN(this.Settings.width)&&(this.Settings.width=100),this.init()}init(){let t=this.Settings.target;t?("hptmain0"==t.getAttribute("id")&&X.empty(t),X.insert(t,`<canvas id='${this.ID}' tabindex='0' class='relative ${this.Settings.cssClass}' type='${this.Settings.type}' correctans='${this.Settings.correctans}' userans=''  height='${this.Settings.height}' width='${this.Settings.width}'></canvas>`,"beforeend"),this.penSize(this.Settings.penSize),this.drawingSurface=document.getElementById(this.ID).getContext("2d"),this.drawingSurface.lineWidth=this.penSize(),this.drawingSurface.lineCap=this.cap,!1===this.hasTouch()?(document.getElementById(this.ID).addEventListener("mousedown",this.clickDown.bind(this),!0),document.getElementById(this.ID).addEventListener("mousemove",this.moved.bind(this),!0),document.getElementById(this.ID).addEventListener("mouseup",this.clickUp.bind(this),!0)):(document.getElementById(this.ID).addEventListener("touchstart",this.clickDown.bind(this),!0),document.getElementById(this.ID).addEventListener("touchmove",this.moved.bind(this),!0),document.getElementById(this.ID).addEventListener("touchend",this.clickUp.bind(this),!0))):console.error("Target not defined")}normalizeTouch(t){if(!0===this.hasTouch()){let e=window.scrollY;["touchstart","touchmove"].indexOf(t.type)>-1&&(t.clientX=t.targetTouches[0].pageX,t.clientY=t.targetTouches[0].pageY-e),["touchend"].indexOf(t.type)>-1&&(t.clientX=t.changedTouches[0].pageX,t.clientY=t.changedTouches[0].pageY-e)}return t}clickDown(t){if(!0===this.isDrawing())return;t||(t=window.event),!0===this.hasTouch()&&(t.preventDefault(),t=this.normalizeTouch(t));let e=X.offset(this.Settings.target),i=window.scrollY,s=new O(t.clientX-e.left,t.clientY-(e.top-i));return this.prevPoint=s,this.drawing=!0,this.Settings.onClick(s),!1}moved(t){t||(t=window.event),!0===this.hasTouch()&&(t.preventDefault(),t=this.normalizeTouch(t));var e=X.offset(this.Settings.target),i=window.scrollY,s=new O(t.clientX-e.left,t.clientY-(e.top-i));return!0===this.isDrawing()?(this.drawLine(this.prevPoint.X,this.prevPoint.Y,s.X,s.Y),this.prevPoint=s,this.Settings.onPaint(s)):this.Settings.onMove(s),!1}clickUp(t){if(!1===this.isDrawing())return;!0===this.hasTouch()&&(t.preventDefault(),t=this.normalizeTouch(t));let e=X.offset(this.Settings.target),i=window.scrollY,s=new O(t.clientX-e.left,t.clientY-(e.top-i));return this.Settings.onRelease(s),this.drawing=!1,!1}hasTouch(){return"ontouchstart"in window}penSize(t){return void 0!==t&&!1===isNaN(Number(t))&&(this.penWidth=t),this.penWidth}isDrawing(){if(this.Settings.editable)return this.drawing}lineCap(t){if(void 0!==t)switch(t){case"butt":case"round":case"square":this.cap=t}return this.cap}lineColor(t){if(void 0!==t){let e=X.parseHtml("<div id='stub' style='backgroundColor:white'></div>");e.style.backgroundColor=t;let i=e.style.backgroundColor;void 0!==i&&""!==i&&(window.color=t)}return window.color}context(){return this.drawingSurface}clearSurface(){let t=X.find(document,"canvas").getAttribute("width").replace("px",""),e=X.find(document,"canvas").getAttribute("height").replace("px","");this.drawingSurface.clearRect(0,0,t,e)}drawLine(t,e,i,s){void 0!==t&&void 0!==e&&void 0!==i&&void 0!==s&&!1===isNaN(Number(t))&&!1===isNaN(Number(e))&&!1===isNaN(Number(i))&&!1===isNaN(Number(s))&&(this.drawingSurface.lineCap=this.cap,this.drawingSurface.strokeStyle=window.color,this.drawingSurface.lineWidth=this.penWidth,this.drawingSurface.beginPath(),this.drawingSurface.moveTo(t,e),this.drawingSurface.lineTo(i,s),this.drawingSurface.stroke())}}function R(t,e,i,s,n){let a,r={x:t.layerX,y:t.layerY,top:0,left:0,uXml:"",ans:!1,ans_h:e,ans_w:i,ans_left:s,ans_top:n};var o,l;return t.layerX&&t.layerY?(r.top=t.layerY-13,r.left=t.layerX-13):(r.top=t.offsetY-13,r.left=t.offsetX-13),a=function(t,e){let i=0,s=t.ans_top+t.ans_h,n=t.ans_left+t.ans_w;return t.top+e>t.ans_top&&t.top+parseInt(e/2)<s&&t.left+e>t.ans_left&&t.left+parseInt(e/2)<n&&(i=1),i}(r,13),r.uXml=(o=r.top,l=r.left,'<SMANS type="4"><div targetTop="'+parseInt(o)+'" targetLeft="'+parseInt(l)+'" /></SMANS>'),"undefined"!=typeof calculatePoint&&(temp=1==a?1:0,calculatePoint(1,temp)),r.ans=a>0,r}function z(t){n(t,"svelte-11usv4u","main.svelte-11usv4u{text-align:center !important;padding:1em;max-width:240px;margin:0 auto;font-size:26px}.targetImg.svelte-11usv4u{display:none;position:absolute;z-index:10;width:17px;height:15px;border-radius:50%;background:#fff;color:#1c3ad4}.showBlock.svelte-11usv4u{display:block}@media(min-width: 640px){main.svelte-11usv4u{max-width:none}}")}function H(t){let e,i,s=t[22](t[18][t[15]])+"";return{c(){e=new $,i=A(),e.a=i},m(t,n){e.m(s,t,n),c(t,i,n)},p(t,i){32768&i[0]&&s!==(s=t[22](t[18][t[15]])+"")&&e.p(s)},i:S,o:S,d(t){t&&f(i),t&&e.d()}}}function P(t){let e,i,s,n,a,l=t[22](t[18][t[15]])+"";return e=new M({props:{handleReviewClick:t[23],reviewMode:t[0]}}),e.$on("setReview",t[20]),e.$on("unsetReview",t[21]),{c(){r(e.$$.fragment),i=o(),s=new $,n=A(),s.a=n},m(t,r){h(e,t,r),c(t,i,r),s.m(l,t,r),c(t,n,r),a=!0},p(t,i){const n={};1&i[0]&&(n.reviewMode=t[0]),e.$set(n),(!a||32768&i[0])&&l!==(l=t[22](t[18][t[15]])+"")&&s.p(l)},i(t){a||(g(e.$$.fragment,t),a=!0)},o(t){m(e.$$.fragment,t),a=!1},d(t){w(e,t),t&&f(i),t&&f(n),t&&s.d()}}}function B(t){let e,i,s,n,r,h,p,m=t[17]&&U();return{c(){e=a("center"),i=a("div"),s=a("div"),s.innerHTML='<span class="icomoon-new-24px-reset-1 s3" style="vertical-align: text-top"></span>  \n\t\t\t\t\t\t\t<span class="position-relative bottom1">Reset</span>',n=o(),r=a("div"),p=o(),m&&m.c(),l(s,"id","reset"),_(s,"height","27px"),_(s,"width","90px"),_(s,"top","2px"),l(s,"class","reset btn btn-outline-primary position-relative btn-sm mt-sm2 mr-sm2 float-end"),_(i,"height","34px"),_(i,"width",window.inNative?window.innerWidth:t[3].imgwidth),_(i,"background","#d9e7fd"),_(i,"border-top","2px solid #96bbf6"),l(r,"id","hptmain0"),l(r,"totalcorrectans",t[1]),l(r,"dd",h=t[3].imgwidth),_(r,"width",t[3].imgwidth||"250px"),_(r,"height",t[3].imgheight||"600px"),_(r,"background-image","url('"+(W+t[14])+"')"),_(r,"background-repeat","no-repeat"),_(r,"position","relative"),_(r,"border","2px solid #d9e7fd"),l(e,"key","imageHeight_3")},m(t,a){c(t,e,a),d(e,i),d(i,s),d(e,n),d(e,r),d(e,p),m&&m.m(e,null)},p(t,s){8&s[0]&&_(i,"width",window.inNative?window.innerWidth:t[3].imgwidth),2&s[0]&&l(r,"totalcorrectans",t[1]),8&s[0]&&h!==(h=t[3].imgwidth)&&l(r,"dd",h),8&s[0]&&_(r,"width",t[3].imgwidth||"250px"),8&s[0]&&_(r,"height",t[3].imgheight||"600px"),16384&s[0]&&_(r,"background-image","url('"+(W+t[14])+"')"),t[17]?m||(m=U(),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},i:S,o:S,d(t){t&&f(e),m&&m.d()}}}function Y(t){let e,i,s,n,r,h,p,m,u,g,w,x,v,b,y,A,$,M;return{c(){e=a("table"),i=a("tbody"),s=a("tr"),n=a("td"),r=a("div"),h=a("div"),p=a("img"),u=o(),g=a("div"),w=k(" "),v=o(),b=a("span"),l(p,"id","im0"),l(p,"tabindex","0"),_(p,"max-width","none"),_(p,"width",t[3].imgwidth),_(p,"height",t[3].imgheight),l(p,"class","hotSpotImg"),C(p.src,m=W+t[14])||l(p,"src",m),l(p,"alt",t[2]),l(g,"id","hotArea"),l(g,"class","hotArea hotArea hotAreaPreview"),l(g,"style",x=`\n\t\t\t\t\t\t\t\t\t\t\t\tdisplay: ${t[11]};\n\t\t\t\t\t\t\t\t\t\t\t\tleft:${t[10]};\n\t\t\t\t\t\t\t\t\t\t\t\ttop:${t[7]};\n\t\t\t\t\t\t\t\t\t\t\t\theight:${t[8]};\n\t\t\t\t\t\t\t\t\t\t\t\twidth:${t[9]};\n\t\t\t\t\t\t\t\t\t\t\t`),l(b,"id","target"),l(b,"class","target targetImg icomoon-plus-circle-2 svelte-11usv4u"),l(b,"style",y=`\n\t\t\t\t\t\t\t\t\t\t\t\tleft:${t[12]}px;\n\t\t\t\t\t\t\t\t\t\t\t\ttop:${t[13]}px;\n\t\t\t\t\t\t\t\t\t\t\t`),I(b,"showBlock",t[6]),l(h,"id","SM0"),l(h,"class","SM position-relative m-0 p-0"),l(h,"style",A=`\n\t\t\t\t\t\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\t\t\t\t\t\tmargin: 0px;\n\t\t\t\t\t\t\t\t\t\t\tpadding: 0px;\n\t\t\t\t\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\t\t\t\t\t\tborder: ${t[4]?t[4]+"px solid":""};\n\t\t\t\t\t\t\t\t\t\t\tborder-color: ${t[5]};\n\t\t\t\t\t\t\t\t\t\t`),l(r,"id","SM0"),l(r,"class","relative"),l(n,"class","border"),l(e,"id","hptmain0"),l(e,"class","smbase smhotspot border-0 h-auto w-auto uc-table")},m(a,o){c(a,e,o),d(e,i),d(i,s),d(s,n),d(n,r),d(r,h),d(h,p),d(h,u),d(h,g),d(g,w),d(h,v),d(h,b),$||(M=N(p,"click",t[19]),$=!0)},p(t,e){8&e[0]&&_(p,"width",t[3].imgwidth),8&e[0]&&_(p,"height",t[3].imgheight),16384&e[0]&&!C(p.src,m=W+t[14])&&l(p,"src",m),4&e[0]&&l(p,"alt",t[2]),3968&e[0]&&x!==(x=`\n\t\t\t\t\t\t\t\t\t\t\t\tdisplay: ${t[11]};\n\t\t\t\t\t\t\t\t\t\t\t\tleft:${t[10]};\n\t\t\t\t\t\t\t\t\t\t\t\ttop:${t[7]};\n\t\t\t\t\t\t\t\t\t\t\t\theight:${t[8]};\n\t\t\t\t\t\t\t\t\t\t\t\twidth:${t[9]};\n\t\t\t\t\t\t\t\t\t\t\t`)&&l(g,"style",x),12288&e[0]&&y!==(y=`\n\t\t\t\t\t\t\t\t\t\t\t\tleft:${t[12]}px;\n\t\t\t\t\t\t\t\t\t\t\t\ttop:${t[13]}px;\n\t\t\t\t\t\t\t\t\t\t\t`)&&l(b,"style",y),64&e[0]&&I(b,"showBlock",t[6]),48&e[0]&&A!==(A=`\n\t\t\t\t\t\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\t\t\t\t\t\tmargin: 0px;\n\t\t\t\t\t\t\t\t\t\t\tpadding: 0px;\n\t\t\t\t\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\t\t\t\t\t\tborder: ${t[4]?t[4]+"px solid":""};\n\t\t\t\t\t\t\t\t\t\t\tborder-color: ${t[5]};\n\t\t\t\t\t\t\t\t\t\t`)&&l(h,"style",A)},i:S,o:S,d(t){t&&f(e),$=!1,M()}}}function U(t){let e;return{c(){e=a("div"),l(e,"class","position-fixed index0"),_(e,"right","0"),_(e,"top","0"),_(e,"left","0"),_(e,"bottom","0"),_(e,"background","rgba(0,0,0,0.4)")},m(t,i){c(t,e,i)},d(t){t&&f(e)}}}function j(t){let e,i,s,n,x,v,b,y,A,S;s=new M({}),s.$on("setReview",t[20]),s.$on("unsetReview",t[21]);const _=[Y,B,P,H],k=[];function C(t,e){return"4"==t[18][t[15]]?0:"3"==t[18][t[15]]?1:"1"==t[18][t[15]]?2:3}return v=C(t),b=k[v]=_[v](t),{c(){e=a("main"),i=a("center"),r(s.$$.fragment),n=o(),x=a("div"),b.c(),y=o(),A=a("input"),l(x,"id","previewArea"),l(x,"class","relative"),l(A,"type","hidden"),l(A,"id","special_module_parse"),l(A,"name","special_module_parse"),l(A,"userans",""),A.value=t[16],l(e,"class","svelte-11usv4u")},m(t,a){c(t,e,a),d(e,i),h(s,i,null),d(i,n),d(i,x),k[v].m(x,null),d(e,y),d(e,A),S=!0},p(t,e){let i=v;v=C(t),v===i?k[v].p(t,e):(p(),m(k[i],1,1,(()=>{k[i]=null})),u(),b=k[v],b?b.p(t,e):(b=k[v]=_[v](t),b.c()),g(b,1),b.m(x,null)),(!S||65536&e[0])&&(A.value=t[16])},i(t){S||(g(s.$$.fragment,t),g(b),S=!0)},o(t){m(s.$$.fragment,t),m(b),S=!1},d(t){t&&f(e),w(s),k[v].d()}}}T('#hptmain .drag-resize{position:absolute;left:90px;top:50px;border:none;z-index:8;text-align:center;font-size:0;line-height:20px;background-color:rgba(244,255,71,.6)!important;box-shadow:0 0 1px #000 inset;cursor:move}.tools{position:absolute;right:5px;z-index:101}.tools .labs-btn{padding:2px 5px}.drag-resize .tools{top:-28px;right:-3px}.elemActive{background:rgba(244,255,71,.6)!important;opacity:1!important}#option-toolbar{margin-bottom:0}.controls{list-style:none;margin:0;padding:0}.controls li{display:inline;padding:11px;float:left;font-size:13px}.controls li:hover,.selected-option{cursor:pointer;background-color:#ccc!important}#hotspot{width:700px;padding:4px;border-top-right-radius:10px;border-top-left-radius:10px;text-align:left;background-color:#ccc}.hotspotTxt{background:#fff;word-wrap:break-word;padding:1em;min-height:180px;text-align:left;overflow-y:scroll;border:1px solid #ccc;font-family:"open sans",Helvetica,Arial,"Times New Roman",sans-serif;font-size:14px}.hotspotTxt p{float:left;margin-bottom:3px}.textClick{border:1px solid transparent;padding:2px 0;margin-right:2px;cursor:pointer;border-radius:2px;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none}.selecttext.selected,.textClick.selected,.textClick.selected:hover{background-color:#ff9;border:1px solid #8a7300;border-radius:2px}.textClick:hover{background-color:#fcfcd3;border-color:#8a7300}.show_correct{background-color:#e7f4e1!important;border-color:#62ae41!important}.show_incorrect{border-color:#da1919!important;background-color:#fbdddd!important}.selecttext{border:1px solid transparent;padding:3px 0;margin-right:2px;position:relative;margin-left:-1px;margin-right:-1px;border-radius:2px}.drawSurface{cursor:crosshair}.h{display:none}.textClick.selected:focus{box-shadow:inset 0 0 0 1px transparent,inset 0 0 0 1px #fff,inset 0 0 0 2px #000;outline:0}.red{color:red}#hptmain0 tr td{border:0!important}');let W="//s3.amazonaws.com/jigyaasa_content_static/";function J(t,e,i){let{xml:s}=e,{uxml:n}=e,{ansStatus:a}=e,{isReview:r}=e,{showAns:o}=e,{editorState:l}=e;const c=new D;let d,h,p="",m=0,u="",g={textclick:"1",textselect:"2",imagehighlight:"3",hotspot:"4"},f={},w=0,A="gray",S=!1,_="",k="",C="",I="",N="none",$=0,M=0,T=0,L=0,O="",X="",z="",H=0,P=0,B="",Y="",U="black",j="",J=0,q=[],F=[],V=0,G=0;var Z="textclick",K="",Q="";function tt(){switch(i(15,z=p.smxml.div._type),H=p.smxml._height,P=p.smxml._width,null!=z&&""!=z||i(15,z=p.smxml._name.toLowerCase()),Z=z,i(14,X=p.smxml._bgimg),g[z]){case"1":V=p.smxml._height+"px",G=p.smxml._width+"px",function(t){var e="",s=t.match(/%{(.*?)}%/gm);if(s){i(1,h=s.length);for(var n=0;n<s.length;n++)K=s[n].replace(/\s+/gm,"<uc:space>"),t=t.replace(s[n],K)}K="",t=t.split(" ");for(n=0;n<t.length;n++)t[n].match(/%{|%}/gm)?(t[n]=t[n].replace(/<uc:space>/gm," ").replace(/%{|}%/gm,""),e+='<p class="textClick" data-index="'+n+'" data-userans="0" data-correctans="1">'+t[n]+"</p>",K+=t[n]+"|"):e+='<p class="textClick" data-index="'+n+'" data-userans="0" data-correctans="0">'+t[n]+"</p>";K=K.replace(/\|$/gm,""),b.select(" #previewArea  #textID0").innerHTML=e}(p.smxml.div.__cdata),b.select(b.parent("#textID0"),"show","block"),b.selectAll('#drawPreview,table[id="hptmain2"]',"hide");break;case"2":isNaN(p.smxml._height)||(p.smxml._height=p.smxml._height+"px"),V=p.smxml._height,G=p.smxml._width+"px",function(t){K="";var e=t.match(/%{(.*?)}%/gm);if(e){for(var s=0;s<e.length;s+=1)K+=e[s].replace(/%{|}%/gm,"")+"|";Q=t.replace(/%{/gm,'<span class="selecttext selected">').replace(/}%/gm,"<span>"),i(1,h=e.length),K=K.replace(/\|$/gm,"")}var n=t.replace(/%{|}%/gm,""),a=setTimeout(function(){b.select(" #previewArea  #textID0").innerHTML=n,clearTimeout(a)}.bind(self),100)}(p.smxml.div.__cdata),b.select(b.parent("#textID0"),"show","block"),b.selectAll('#drawPreview,table[id="hptmain2"]',"hide");break;case"3":{let t=new Image;t.addEventListener("load",(function(t){i(3,f.imgheight=p.smxml._height>this.height?p.smxml._height+"px":this.height+"px",f),i(3,f.imgwidth=p.smxml._width>this.width?p.smxml._width+"px":this.width+"px",f),b.find("#hptdraw0","canvas",{action:"attr",actionData:{height:f.imgheight,width:f.imgwidth}}),b.empty("#textID0"),nt()}),!1),t.setAttribute("src",W+p.smxml._bgimg)}break;case"4":{i(14,X=p.smxml._bgimg),i(2,u=p.smxml._alt),i(13,M=parseFloat(p.smxml.div._top)),i(12,$=parseFloat(p.smxml.div._left)+13),T=parseFloat(p.smxml.div._height),L=parseFloat(p.smxml.div._width),i(2,u=p.smxml.div._alt),O=p.smxml.div.type,i(4,w=p.smxml.div._border),i(5,A=p.smxml.div._bordercolor),i(9,C=p.smxml.div._width+"px"),i(8,k=p.smxml.div._height+"px"),i(10,I=parseInt(p.smxml.div._left)+4+"px"),i(7,_=parseInt(p.smxml.div._top)+2+"px");let t=new Image;t.onload=function(){let t=this.height+"px",e=this.width+"px";i(3,f.imgheight=p.smxml.div._imgheight?p.smxml.div._imgheight+"px":"auto !important",f),i(3,f.imgwidth=p.smxml.div._imgwidth?p.smxml.div._imgwidth+"px":"auto !important",f),b.select("#hptmain0","css",{height:t,width:e})},t.src=W+p.smxml._bgimg}}}function et(){r&&i(11,N="block");var t=new Image;if(t.onload=function(){"3"==g[z]?(i(3,f.imgheight=p.smxml._height>this.height?p.smxml._height+"px":this.height+"px",f),i(3,f.imgwidth=p.smxml._width>this.width?p.smxml._width+"px":this.width+"px",f)):(i(3,f.imgheight=p.smxml.div._imgheight?p.smxml.div._imgheight+"px":"auto !important",f),i(3,f.imgwidth=p.smxml.div._imgwidth?p.smxml.div._imgwidth+"px":"auto !important",f))},X&&(t.src=W+X),n){i(16,B=n);let t=v(n);t.SMANS&&t.SMANS.div&&(i(6,S=!0),i(12,$=t.SMANS.div._targetLeft),i(13,M=t.SMANS.div._targetTop))}}function it(t){let e={};"textclick"==Z||"textselect"==Z?e=c.check_Ans("#previewArea #hptmain0"):(e=R(t,T,L,parseInt(I),parseInt(_)),i(6,S=!0),i(12,$=e.left),i(13,M=e.top),i(24,a=e.ans),i(29,d=a),l&&o(a?"Correct":"Incorrect")),y(e)}function st(){if(i(11,N="block"),"3"==g[z]){let t=b.find("#previewArea","canvas"),e=t.getAttribute("correctans");""!=e&&(e=JSON.parse(e)),c.drawOnCanvas(t,e,"green")}c.modeOnHot(1),b.select("#hptmain0","css",{pointerEvents:"none"})}function nt(){if(i(11,N="none"),"3"==g[z]){b.find("#previewArea","canvas",{action:"remove"});var t=setTimeout((function(){!function(t,e){let n=b.find(t,"#hptmain0");t=n;let a=new E({target:n,width:+f.imgwidth.replace("px",""),height:+f.imgheight.replace("px",""),correctans:Y,cssClass:"drawSurface",penSize:4,type:"imagehighlight",editable:!e,onMove(){},onClick(){},onPaint(t){q.push(t.X),F.push(t.Y)},onRelease(s){!function(t,e,s){let n="",a=!1;if(!s){j="";var r=document.querySelector("#special_module_parse").value;""!=(r=r.substring(r.indexOf("{"),r.lastIndexOf("}")+1))?(r=Object.keys(JSON.parse(r)).length,j=c.getCoordinate(e,q,F,r)):j=c.getCoordinate(e,q,F,J),window.inNative&&window.getHeight&&window.getHeight(),window.ISSPECIALMODULEUSERXMLCHANGE=1,b.select("#special_module_user_xml").value=j,i(16,B=j),q=[],F=[];let t=b.find(e,"canvas").getAttribute("correctans"),s=b.find(e,"canvas").getAttribute("userans");""!=s&&(s=JSON.parse(s)),""!=t&&(t=JSON.parse(t));let h=c.compareDrawing(s,t,e),p="Incorrect";h>0?(a=!0,p="Correct",i(3,f.answerType3=!0,f),l&&o("Correct")):(a=!1,p="Incorrect",i(3,f.answerType3=!1,f)),l&&o(p),n=b.select("#special_module_user_xml").value,h=h>0,i(29,d=h),y({ans:h,uXml:n}),b.select("#answer").checked=h>0,window.inNative&&window.postMessage(JSON.stringify({inNativeIsCorrect:a,userAnswers:n}),"*")}}(0,t,e)}});U=String(s.match(/linecolor=\"([^\"]+)\"/gm)),U=U.substring("11",U.length-1),e||b.listen("#previewArea","click","#reset",(()=>{a.clearSurface(),j="",J=0,i(16,B=""),b.selectAll(b.select(t).children,"attr",{userans:""}),i(29,d=!1)}));window.surface=a}("#previewArea",0);let e=b.find("#previewArea","canvas"),n=b.select("#special_module_parse").value,a=n.substring(n.indexOf("{"),n.lastIndexOf("}")+1);""!=a&&(a=JSON.parse(a)),c.drawOnCanvas(e,a,U),clearTimeout(t)}),500)}c.modeOnHot(),b.select("#hptmain0","css",{pointerEvents:"auto"})}return x((async()=>{p=v(s),tt(),et(),c.readyThis("hptmain0",r),r?c.modeOnHot(1):c.modeOnHot(),b.listen("#previewArea","click",".textClick",(function(){it()})),b.listen("#previewArea","click",'[type="textselect"]',(function(){it()}))})),t.$$set=t=>{"xml"in t&&i(25,s=t.xml),"uxml"in t&&i(26,n=t.uxml),"ansStatus"in t&&i(24,a=t.ansStatus),"isReview"in t&&i(0,r=t.isReview),"showAns"in t&&i(27,o=t.showAns),"editorState"in t&&i(28,l=t.editorState)},t.$$.update=()=>{if(2013265921&t.$$.dirty[0]&&(r?(st(),l&&0==m&&(o(d?"Correct":"Incorrect"),i(30,m=1))):(i(30,m=0),nt())),33554434&t.$$.dirty[0]|1&t.$$.dirty[1]&&s){let t=s.replace("\x3c!--[CDATA[","<![CDATA[").replace("]]--\x3e","]]>");t.match(/<\!\[CDATA\[{|<\!--\[CDATA\[{/gm)&&(i(31,Y=t.toString().match(/{(.*)}/gim)),i(1,h=Y.toString().match(/},"\d+"/gm)),i(1,h=h?h.pop():null),i(1,h=h?h.replace(/"|}|,/gm,""):1),t=t.replace(Y,""),i(31,Y=Y[0])),p=v(s),tt(),et()}},[r,h,u,f,w,A,S,_,k,C,I,N,$,M,X,z,B,!1,g,it,st,nt,function(t){switch(t){case"1":case"2":{let t="",e="";if(n){let i=v(n);window.test=n,i?.smans?.div&&(t=i.smans.div["_data-userAns"],e=i.smans.div["_data-userHtml"])}return`\n\t\t\t\t\t\t<div is id="hptmain0" totalCorrectAns=${h}>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tid="textID0" \n\t\t\t\t\t\t\t\ttype="${Z}" \n\t\t\t\t\t\t\t\tdata-correcthtml="${Q}" \n\t\t\t\t\t\t\t\tdata-correctans="${K}"\n\t\t\t\t\t\t\t\tdata-userans="${t}" \n\t\t\t\t\t\t\t\tdata-userhtml="${e}" \n\t\t\t\t\t\t\t\tclass="drag-resize hotspotTxt" \n\t\t\t\t\t\t\t\tstyle="max-width:${G}; height:${V}; line-height: 1.4; font-size:17px!important;"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`}default:return"<div>Incorrect question type</div>"}},function(t,e){"c"==t?c.showansdrag("#hptmain0","c",1):c.showansdrag("#hptmain0","u",1)},a,s,n,o,l,d,m,Y]}export default class extends e{constructor(t){super(),i(this,t,J,j,s,{xml:25,uxml:26,ansStatus:24,isReview:0,showAns:27,editorState:28},z,[-1,-1])}}
//# sourceMappingURL=HotspotPreview-1292eaf8.js.map
