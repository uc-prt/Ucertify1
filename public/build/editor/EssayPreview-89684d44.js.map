{"version":3,"file":"EssayPreview-89684d44.js","sources":["../../../clsSMEssay/eaasy_new_react.js","../../../clsSMEssay/EssayPreview.svelte"],"sourcesContent":["\r\n\r\nconst essayUploadUrl = 'http://ucertify.com/reactUpload.php/';//remove hard code, use from constant\r\nimport JUI from '../src/libs/javscript_helper/JUI.js';\r\nlet editor;\r\nexport default class EssayNewReact extends JUI {\r\n    constructor(eid, essayEditor) {\r\n        super();\r\n        this.timer = {};\r\n        this.eid = eid;\r\n        this.essay_ready(eid, essayEditor);\r\n    }\r\n\r\n    // getting the essay module ready\r\n    essay_ready(eid, essayEditor) {\r\n        let filePath;\r\n        let eidNode = document.querySelector(eid);\r\n        editor = essayEditor;\r\n        setTimeout(()=> {\r\n            this.bind('#drop a', 'click', (event)=> {\r\n                this.find(event.target.parentNode, 'input').click();\r\n            });\r\n\r\n            // it initialize the knob plugin listen for clicks on the cancel icon. \r\n            \r\n            //SUNEDITOR.create(this.find(eid, '#essay_edit'), { toolbarSelector: '[data-role=editor2-toolbar]' });\r\n            this.selectAll('[data-role=magic-overlay]').forEach(function(_this) {\r\n                var overlay = _this,\r\n                    target = _this.dataset['target'];\r\n                // overlay.offset(target.offset()).width(target.outerWidth()).height(target.outerHeight());\r\n            });\r\n\r\n            essayEditor.onChange = (contents, core)=> {\r\n                this.updateXML(eid, 200, contents);\r\n            }\r\n            essayEditor.onKeyDown = (e, core)=> {\r\n                if (e.keyCode == 86 || e.keyCode == 67) {\r\n                    this.updateXML(eid, 200, e.target.innerHTM);\r\n                }\r\n            }\r\n\r\n            let ua = window.navigator.userAgent;\r\n            let ms_old_ie = ua.indexOf('MSIE ');\r\n            let ms_new_ie = ua.indexOf('Trident/');\r\n            this.listen(eidNode, 'click', 'a.essay_dwl_file', (_this)=> {\r\n                if ((ms_old_ie > -1) || (ms_new_ie > -1)) {\r\n                    var path = _this.getAttribute('href');\r\n                    _this.removeAttribute('href');\r\n                    window.open(path);\r\n                    setTimeout(()=> { this.select('a.essay_dwl_file').setAttribute('href', path) }, 500);\r\n                }\r\n                setTimeout(()=> { this.select('#center').remove(); }, 500);\r\n            });\r\n        }, 500);\r\n    }\r\n\r\n    // for getting path of the s3\r\n    getPath() {\r\n        let path = \"\"\r\n        if (typeof test_session_uid != \"undefined\") {\r\n            var folder = this.getForlderName(test_session_uid);\r\n            path = \"//s3.amazonaws.com/test_session/\" + folder + '/';\r\n        } else if (typeof user_guid != 'undefined') {\r\n            path = \"//s3.amazonaws.com/test_session/\" + user_guid + '/';\r\n        }\r\n        return path;\r\n    }\r\n\r\n    getUploads(...media) { \r\n        let path = this.getPath();\r\n        console.log(\"Upload media selected\", media);\r\n        let allExt = \",\" + this.select(this.eid).getAttribute('data-filetypeexts');\r\n        Array.prototype.forEach.call(media[0], (_f)=> {\r\n            let form_data = new FormData();\r\n            form_data.append('Filedata', _f);\r\n            let file_ext = _f.name.split('.');\r\n            let tpl = this.parseHtml('<li class=\"working\"><span class=\"download\" disabled=\"disabled\"><a target=\"_blank\" onclick=\"setTimeout(function(){activate(0)},500);\" href=\"' + path + _f.name + '\" title=\"Download File\"  class=\"essay_dwl_file icomoon-file-download\"></a></span><span class=\"filename\"></span><span class=\"fileSize\"></span><span class=\"abort\">abort</span><div id=\"progressbar\"><div class=\"bar\" style={{width: \"0\"}}></div></div></li>');\r\n            this.find(tpl, '.filename', {action: 'text', actionData: _f.name});\r\n            this.insert(this.find(tpl, '.fileSize'), `<i>${this.formatFileSize(_f.size)}</i>`, 'beforeend');\r\n            if (this.find(this.eid, '.essay_upload_status li', 'all').length >= this.select(this.eid).getAttribute('data-limit')) {\r\n                this.showmsg('The number of files uploaded exceeds the queue size limit (' + this.select(this.eid).getAttribute('data-limit') + ')');\r\n            } else if (!this.findInArray(file_ext[1].toLowerCase(), allExt.split(\",*.\")) ) {\r\n                this.showmsg('The file format/file extension is not valid.');\r\n            } else {\r\n                this.find(this.eid, '.essay_upload_status', {action: 'addClass', actionData: 'working_file'});\r\n                //data.context = tpl.appendTo(\".essay_upload_status\");\r\n                this.select(\".essay_upload_status\").append(tpl);\r\n                this.essay_sendFile_ToServer(this.eid, form_data, status);\r\n            }\r\n        });\r\n    }\r\n\r\n    // Helper function that formats the file sizes\r\n    formatFileSize(bytes) {\r\n        if (typeof bytes !== 'number') {\r\n            return '';\r\n        }\r\n\r\n        if (bytes >= 1000000000) {\r\n            return (bytes / 1000000000).toFixed(2) + ' GB';\r\n        }\r\n\r\n        if (bytes >= 1000000) {\r\n            return (bytes / 1000000).toFixed(2) + ' MB';\r\n        }\r\n\r\n        return (bytes / 1000).toFixed(2) + ' KB';\r\n    }\r\n\r\n    //It Calculate the completion percentage of the upload on progress event.\r\n    essay_sendFile_ToServer(eid, formData, status) {\r\n        this.activate(1);\r\n        let tsuid = (typeof test_session_uid == \"undefined\") ? \"\" : test_session_uid;\r\n        let uploadURL = essayUploadUrl + \"?func=essay&exts=\" + this.select(eid).dataset['filetypeexts'] + \"&test_session_uid=\" + tsuid; //Upload URL\r\n        console.log(uploadURL)\r\n        this.ajax({\r\n            url: uploadURL,\r\n            dataType: 'text',\r\n            formData: true,\r\n            contentType: false,\r\n            processData: false,\r\n            cache: false,\r\n            data: formData,\r\n        }).then(()=> {\r\n            this.activate(0);\r\n            this.select(\".essay_upload_status\", 'css', {display: 'block'});\r\n            this.select('#progressbar .bar', 'remove');\r\n            this.selectAll('.download', 'removeAttr', 'disabled');\r\n            this.updateXML(this.eid);\r\n            //status.setProgress(100);\r\n            this.showmsg(\"File uploaded sucessfully.\");\r\n        }).catch((...e)=> {\r\n            this.activate(0);\r\n            console.log('File is recorded but not uploaded due to server error.',e);\r\n            this.select('#progressbar .bar', 'remove');\r\n            this.selectAll('.download', 'removeAttr', 'disabled');\r\n        });\r\n    }\r\n\r\n    // it returns array of extracted data.\r\n    ext_array(exts) { \r\n        let ext_arr = [];\r\n        this.selectAll(exts.split(',')).forEach((val, i)=> {\r\n            let _ext = val.split('.');\r\n            ext_arr.push(_ext[1]);\r\n        });\r\n        return ext_arr;\r\n    }\r\n\r\n    updateXML(essayID, time, content) {\r\n        if (this.timer['updateXML']) clearTimeout(this.timer['updateXML']);\r\n        this.timer['updateXML'] = setTimeout(()=> {\r\n            let val = content || editor.getContents();\r\n            let file_str = \"\";\r\n            this.find(essayID,'.essay_upload_status li', 'all').forEach((_this)=> {\r\n                if (file_str == \"\") {\r\n                    file_str = _this.querySelector('.filename').innerHTML; \r\n                } else {\r\n                    file_str = file_str + ',' + _this.querySelector('.filename').innerHTML;\r\n                }\r\n            });\r\n            if (window.inNative) {\r\n                window.getHeight();\r\n            }\r\n            let userAnsXML = `<smans type='5'><userans><![CDATA[${val}]]></userans><upload><![CDATA[${file_str}]]></upload><path><![CDATA[${this.getPath()}]]></path></smans>`;\r\n            window.ISSPECIALMODULEUSERXMLCHANGE = 1;\r\n            this.select('#special_module_user_xml', 'value', userAnsXML);\r\n            // from onUserAnsChange \r\n            globalThis.saveUserAnswerInSapper?.({uXml: userAnsXML, ans: \"manual\"});\r\n            if (window.inNative) window.postMessage(JSON.stringify({userAnsXML, essayPreview: true}), \"*\");\r\n        }, time);\r\n    }\r\n\r\n    // it removes the file.\r\n    remove_file(item, eid) {\r\n        let filename = this.parent(item).querySelector('.filename').innerHTML;\r\n        if (this.find(eid, '.essay_upload_status li', 'all').length <= 1) this.find(eid, '.essay_upload_status').classList.remove('working_file');\r\n        this.activate(1);\r\n        this.ajax({\r\n            url: essayUploadUrl, \r\n            data: { \"action\": \"remove_file\", \"file_name\": filename }\r\n        }).then((data)=> {\r\n            this.parent(item).remove();\r\n            this.updateXML(eid);\r\n            this.activate(0);\r\n        });\r\n    }\r\n\r\n    // for getting folder name of the s3 of file\r\n    getForlderName(test_session_uid) {\r\n        let folder = test_session_uid;\r\n        if (test_session_uid > 856399 || test_session_uid < 700000) {\r\n            let last = this.str_pad(test_session_uid % 10000, 4, '0');\r\n            let first = this.str_pad(Math.floor(test_session_uid / 10000), 1, '0');\r\n            folder = first + \"/\" + last;\r\n        }\r\n        return folder;\r\n\r\n    }\r\n\r\n    // used in this.getForlderName\r\n    // it takes three arguments first is string second is length, third is padstring.\r\n    // it checks if string.length is less than length then is returns the string with padstring and string otherwise it returns string.\r\n    str_pad(str, length, padstring) {\r\n        while (str.length < length) {\r\n            str = padString + str;\r\n        }\r\n        return str;\r\n    }\r\n\r\n    /*\r\n    ** it adds the class ‘h’ to the element have class review and test and after that if it \r\n    ** is called with passing argument have value then it hides the element have id ‘upload’ and class ‘abort’ \r\n    ** otherwise shows the element have class ‘abort’ and set the attribute contenteditable \r\n    ** to true to the element have id ‘essay_edit’ \r\n    */\r\n    modeOn(modeType) {\r\n        this.selectAll('.test, .review', 'addClass', 'h');\r\n        if (modeType) {\r\n            this.selectAll('#upload, .abort', 'hide');\r\n        } else {\r\n            // jQuery(elemId).find('#upload').show();\r\n            this.select('#essay_edit').setAttribute('contenteditable', 'true');\r\n            this.selectAll('.abort', 'show');\r\n        }\r\n    }\r\n}\r\n","<script>\r\n    import { beforeUpdate, onMount } from \"svelte\";\r\n    import {AH, XMLToJSON, onUserAnsChange} from '../helper/HelperAI.svelte';\r\n    import ItemHelper from '../helper/ItemHelper.svelte';\r\n    import sunEditor from 'suneditor';\r\n    import plugins from 'suneditor/src/plugins';\r\n    import EssayNewReact from './eaasy_new_react.js';\r\n    import '../helper/sunEditor/src/assets/css/suneditor.css';\r\n\r\n    export let xml;\r\n    export let uxml;\r\n    export let isReview;\r\n    export let editorState;\r\n    let ucEssay;\r\n    let files;\r\n    let state = {\r\n        userans: '',\r\n        appPath: \"\",\r\n        essayStr: '',\r\n        userAns: '',\r\n        site_url: \"\"\r\n    };\r\n    let essay_class = \"working_file\";\r\n    let eid = \"essayPreviewContainer\";\r\n    let localEssayData = {};\r\n    let uAns =\"\";\r\n    let essayEditor;\r\n    const headingArray = [{\"font\": \"fontSize 6\",\"text\": \"Heading 1\"}, {\"font\": \"fontSize 5\",\"text\": \"Heading 2\"}, {\"font\": \"fontSize 4\",\"text\": \"Heading 3\"},{\"font\": \"fontSize 3\",\"text\": \"Heading 4\"},{\"font\": \"fontSize 2\",\"text\": \"Heading 5\"},{\"font\": \"fontSize 1\",\"text\": \"Heading 6\"}];\r\n\r\n    $: essay_class = isReview ? \"working_file h\" : \"working_file\";\r\n\r\n    onMount(()=> {\r\n        editorState && AH.set(editorState.content_type+\"_refresh\", setEssayContent.bind(this));\r\n        loadXML(xml, uxml);\r\n        // Intialize editor plugin\r\n        initEdit();\r\n        addTabIndex();\r\n    });\r\n\r\n    function addTabIndex() {\r\n        var se_menu = AH.selectAll('.se-menu-list');\r\n        se_menu.forEach(function(curr, index) {\r\n            let se_menu_list = curr.getElementsByTagName('li');\r\n            for (var i = 0; i < se_menu_list.length; ++i) {\r\n                AH.select(se_menu_list[i]).setAttribute('tabindex', 0);\r\n            }\r\n        });\r\n    }\r\n\r\n    function initEdit() {\r\n        essayEditor = sunEditor.create('essay_edit', { \r\n            height: '300px',\r\n            value: uAns,\r\n            width: 'auto',\r\n            toolbarContainer:\"#essayPreviewToolbar\",\r\n            placeholder: \"Write text here.\",\r\n            resizingBar: false,\r\n            showPathLabel: false,     \r\n            plugins:plugins,\r\n            defaultStyle: \"padding-left: 10px\",\r\n            buttonList: [\r\n                ['formatBlock'],\r\n                ['bold', 'italic', 'underline'],\r\n                ['link'],\r\n                ['list', 'outdent', 'indent', 'align'],\r\n                ['removeFormat'],\r\n            ],\r\n        });\r\n        let elemId = '#' + eid;\r\n        ucEssay = new EssayNewReact(elemId, essayEditor);\r\n        //ucEssay.essay_ready();\r\n    }\r\n\r\n    function setEssayContent() {\r\n        console.log(\"set Content\")\r\n        essayEditor.setContents(uAns);\r\n    }\r\n        \r\n    // it is called when state updated\r\n    beforeUpdate(()=> {\r\n        if (xml != state.xml) {\r\n            state.xml = xml ;\r\n            console.log(\"Updating from Preview\");\r\n            loadXML(xml, uxml);\r\n        }\r\n    });\r\n    \r\n    // its for loading the xml.\r\n    function loadXML(essayXML, uxml) {\r\n        let essayUser = (uxml) ? XMLToJSON(uxml) : \"\";\r\n        essayXML = XMLToJSON(essayXML);\r\n       // userxml_is_empty = updateAttrToLower(userxml_is_empty);\r\n        // if(userxml_is_empty) {\r\n        //     if(!userxml_is_empty.smans) {\r\n        //         uaxml = \"\";\r\n        //     }\r\n        // }\r\n        // Parsing XMLs\r\n        try {\r\n            let essay = essayXML.smxml.default ? essayXML.smxml.default : essayXML.smxml;\r\n            uAns = essayUser && (essayUser.smans.userans).charCodeAt(0)!=10 ? essayUser.smans.userans : (essay.__cdata !== undefined ? essay.__cdata : '');\r\n            //self.userAnsXML = $('#special_module_user_xml').val();\r\n            localEssayData = {\r\n                userans: uAns,\r\n                filetypeexts: essay._filetypeexts,\r\n                limit: essay._limit,\r\n                type: essay._type == \"5\" ? \"0\" : essay._type,\r\n                upload: essayUser ? essayUser.smans.upload : \"\",\r\n                path: essayUser ? essayUser.smans.path : \"\",\r\n            };\r\n        } catch(error) {\r\n            console.log({error, func:'loadXml', file:'EssayPreview.svelte'});\r\n        }\r\n    }\r\n    \r\n    // its update attributes of user answer xml to lowercase.\r\n    function updateAttrToLower(data) {\r\n        let isLower = false;\r\n        if(data.SMANS) {\r\n            data.smans = data.SMANS;\r\n            delete data.SMANS;\r\n            isLower = true;\r\n        }\r\n        return data;\r\n    }\r\n    \r\n    // calls on click of abort\r\n    function handleClick(e) {\r\n        ucEssay.remove_file(e.currentTarget, '#' + eid);\r\n    }\r\n\r\n    // calls when review mode is on\r\n    function setReview() {\r\n        isReview = true;\r\n        essayEditor.disabled(); // Disable editing for module\r\n        ucEssay.modeOn(\"on\");\r\n    }\r\n    \r\n    // calls when review mode is off after on\r\n    function unsetReview(type) {\r\n        isReview = false;\r\n        essayEditor.enabled(); // Enable editing for module\r\n        if (type != 0) {\r\n            AH.select('#upload', 'show');\r\n            AH.select('#upload', 'removeClass', 'h');\r\n        }\r\n        ucEssay.modeOn('');\r\n    }\r\n</script>\r\n<main>\r\n    <p id =\"demo\"></p>\r\n    <div>\r\n        {#if localEssayData }\r\n            <ItemHelper \r\n                on:setReview = {setReview}\r\n                on:unsetReview = {unsetReview.bind(this, localEssayData.type)}\r\n            />\r\n            <div \r\n                id={eid} \r\n                data-filetypeexts={localEssayData.filetypeexts} \r\n                data-limit={localEssayData.limit} \r\n                class=\"essay-container m-auto hero-unit\"\r\n            >\r\n                <div id=\"essayPreviewToolbar\" class=\"sun-editor\"></div>\r\n                <textarea id=\"essay_edit\" class=\"text-left editor sun-editor-editable\" ></textarea>\r\n                <div id=\"upload\" class={window.isReview == true || isReview == true || localEssayData.type == \"0\" ? \"h\" : \"\"}>\r\n                    <div id=\"drop\">\r\n                        Drag & Drop Files Here\r\n                        <div class=\"text-center\" style=\"font-size: 12px;font-weight: normal;position:relative;top:45px; word-wrap:break-word\">You can upload upto {localEssayData.limit} {localEssayData.filetypeexts} files.</div>\r\n                        <a href=\"#upl\" class=\"essay-btn btn btn-light darkgrey_border\">Browse</a>\r\n                        <input \r\n                            type=\"file\" \r\n                            name=\"upl\" \r\n                            bind:files \r\n                            on:change={(event)=> ucEssay.getUploads(files, event)}\r\n                            id=\"upl\" \r\n                            multiple=\"multiple\" \r\n                            style=\"opacity:0.5\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n                <ul class={localEssayData.type == \"0\" ? \"essay_upload_status text-left h\" : \"essay_upload_status text-left working_file\" } style=\"list-style-type: none;\">\r\n                    {#if localEssayData.upload != '' }\r\n                        {#each localEssayData.upload.split(',') as uploaded, index}\r\n                            <li class=\"working\">\r\n                                <span class=\"download\">\r\n                                    <a target=\"_blanks\" href={localEssayData.path + uploaded} title='Download File' class=\"essay_dwl_file\">\r\n                                        <i class=\"icomoon-file-download\"></i>\r\n                                    </a>\r\n                                </span>\r\n                                <span class=\"filename\">{uploaded}</span>\r\n                                {#if !isReview}\r\n                                    <span class=\"abort\" on:click={handleClick}>abort</span>\r\n                                {/if}\r\n                            </li>\r\n                        {/each}\r\n                    {/if}\r\n                </ul>\r\n            </div>\r\n\r\n        {/if}\r\n    </div>\r\n</main>\r\n<style>\r\n    .hero-unit {\r\n        border: 1px solid #ccc;\r\n        width: 84%;\r\n        padding: 18px!important;\r\n        font-size: 15px!important;\r\n        margin-bottom: 30px;\r\n        font-weight: 200;\r\n        line-height: 30px;\r\n        color: inherit;\r\n        background-color: #eeeeee;\r\n        -webkit-border-radius: 6px;\r\n        -moz-border-radius: 6px;\r\n        border-radius: 6px;\r\n    }\r\n    .essay_upload_status {\r\n        margin-top: 10px;\r\n    }\r\n    .abort {\r\n        padding-left: 15px;\r\n        cursor: pointer;\r\n    }\r\n    .essay-btn, #essayfile-button, #editfiles {\r\n        display: inline-block;\r\n        padding: 4px 8px;\r\n        font-size: 12px;\r\n        line-height: 20px;\r\n        text-align: center;\r\n        vertical-align: middle;\r\n        cursor: pointer;\r\n        color: #333333;\r\n        text-shadow: 0 1px 1px rgba(255, 255, 255, 0.75);\r\n        background-color: #f5f5f5;\r\n        background-image: -moz-linear-gradient(top, #ffffff, #e6e6e6);\r\n        background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#ffffff), to(#e6e6e6));\r\n        background-image: -webkit-linear-gradient(top, #ffffff, #e6e6e6);\r\n        background-image: -o-linear-gradient(top, #ffffff, #e6e6e6);\r\n        background-image: linear-gradient(to bottom, #ffffff, #e6e6e6);\r\n        background-repeat: repeat-x;\r\n        /* filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffffff', endColorstr='#ffe6e6e6', GradientType=0); */\r\n        border-color: #e6e6e6 #e6e6e6 #bfbfbf;\r\n        border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);\r\n        /* filter: progid:DXImageTransform.Microsoft.gradient(enabled = false); */\r\n        border: 1px solid #cccccc;\r\n        border-bottom-color: #b3b3b3;\r\n        -webkit-border-radius: 4px;\r\n        -moz-border-radius: 4px;\r\n        border-radius: 4px;\r\n        -webkit-box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\r\n        -moz-box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\r\n        box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\r\n    }\r\n    #upload {\r\n        font-family: 'PT Sans Narrow', sans-serif;\r\n        background-color: #E0E0E0;\r\n        background-image: -webkit-linear-gradient(top, #E0E0E0, #E0E0E0);\r\n        background-image: -moz-linear-gradient(top, #E0E0E0, #E0E0E0);\r\n        background-image: linear-gradient(top, #E0E0E0, #E0E0E0);\r\n        width: 100%;\r\n        /* padding: 30px; */\r\n        padding: 30px 30px 0;\r\n        border-radius: 3px;\r\n        border-collapse: separate;\r\n        border: 1px solid rgb(204, 204, 204);\r\n        margin-top: 2px;\r\n    }\r\n    #drop {\r\n        background-color: #EEEEEE;\r\n        padding: 25px 30px;\r\n        margin-bottom: 30px;\r\n        border: 20px solid rgba(0, 0, 0, 0);\r\n        border-radius: 3px;\r\n        text-align: center;\r\n        font-size: 16px;\r\n        font-weight: bold;\r\n        color: #7f858a;\r\n        border: 1px solid #CCCCCC;\r\n    }\r\n    /* .can_upload {\r\n        font-size: 12px;\r\n        font-weight: 100;\r\n        position: relative;\r\n        top: 45px;\r\n        overflow-wrap: break-word;\r\n    } */\r\n    #drop a {\r\n        /* background-color: #007a96; */\r\n        padding: 12px 5%;\r\n        color: #2B2E31;\r\n        font-size: 14px;\r\n        border-radius: 2px;\r\n        cursor: pointer;\r\n        display: inline-block;\r\n        margin-top: 12px;\r\n        margin-bottom: 12px;\r\n        line-height: 1;\r\n        text-decoration: none;\r\n        position: relative;\r\n        top: 30px;\r\n    }\r\n    #drop input {\r\n        display: none;\r\n    }\r\n    .essay-btn {\r\n        margin-bottom: 15px;\r\n    }\r\n    .essay-container {\r\n        width: 89%;\r\n    }\r\n</style>"],"names":["editor","EssayNewReact","JUI","[object Object]","eid","essayEditor","super","this","timer","essay_ready","eidNode","document","querySelector","setTimeout","bind","event","find","target","parentNode","click","selectAll","forEach","_this","dataset","onChange","contents","core","updateXML","onKeyDown","e","keyCode","innerHTM","ua","window","navigator","userAgent","ms_old_ie","indexOf","ms_new_ie","listen","path","getAttribute","removeAttribute","open","select","setAttribute","remove","test_session_uid","getForlderName","user_guid","media","getPath","console","log","allExt","Array","prototype","call","_f","form_data","FormData","append","file_ext","name","split","tpl","parseHtml","action","actionData","insert","formatFileSize","size","length","showmsg","findInArray","toLowerCase","essay_sendFile_ToServer","status","bytes","toFixed","formData","activate","tsuid","uploadURL","essayUploadUrl","ajax","url","dataType","contentType","processData","cache","data","then","display","catch","exts","ext_arr","val","i","_ext","push","essayID","time","content","clearTimeout","getContents","file_str","innerHTML","inNative","getHeight","userAnsXML","ISSPECIALMODULEUSERXMLCHANGE","globalThis","saveUserAnswerInSapper","uXml","ans","postMessage","JSON","stringify","essayPreview","item","filename","parent","classList","file_name","folder","last","str_pad","Math","floor","str","padstring","padString","modeType","ctx","limit","filetypeexts","type","upload","isReview","ucEssay","files","xml","uxml","editorState","state","userans","appPath","essayStr","userAns","site_url","localEssayData","uAns","setEssayContent","setContents","loadXML","essayXML","essayUser","XMLToJSON","essay","smxml","default","smans","charCodeAt","undefined","__cdata","_filetypeexts","_limit","_type","error","func","file","onMount","AH","set","content_type","sunEditor","create","height","value","width","toolbarContainer","placeholder","resizingBar","showPathLabel","plugins","defaultStyle","buttonList","curr","index","se_menu_list","getElementsByTagName","beforeUpdate","remove_file","currentTarget","disabled","modeOn","enabled","getUploads"],"mappings":"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"}