{"version":3,"file":"Essay-59fdb09e.js","sources":["../../../clsSMEssay/Essay.svelte"],"sourcesContent":["<script>\n    import { beforeUpdate,onMount } from \"svelte\";\n    import { AH, XMLToJSON } from \"../helper/HelperAI.svelte\";\n    import SUNEDITOR from 'suneditor';\n    import plugins from 'sunEditor/src/plugins';\n    import { Checkbox } from 'svelte-mui/src';\n    export let xml;\n    export let getChildXml;\n    export let l;\n    let isUpload = false;\n    let author_xml;\n    const headingArray = [{\"font\": \"fontSize 6\",\"text\": \"Heading 1\"}, {\"font\": \"fontSize 5\",\"text\": \"Heading 2\"}, {\"font\": \"fontSize 4\",\"text\": \"Heading 3\"},{\"font\": \"fontSize 3\",\"text\": \"Heading 4\"},{\"font\": \"fontSize 2\",\"text\": \"Heading 5\"},{\"font\": \"fontSize 1\",\"text\": \"Heading 6\"}];\n    let essayAuthEditor;\n    let timer = null;\n    let state = {\n        files_number : 1,\n        cdata : true,\n    };\n    \n    onMount(()=> {\n        initEdit();\n        let listenrTarget = AH.find('#SM_essay', 'a,button,input,select');\n        AH.listenAll(listenrTarget, \"blur\", (e)=> { \n            console.log(e.target);\n            updateXML(500); \n        });\n        // AH.listenAll(listenrTarget, \"keyup\", ()=> { updateXML(500); });\n        // AH.listenAll(listenrTarget, \"keydown\", ()=> { updateXML(500); });\n\n        AH.bind(\"#files_number\", 'keydown', (e)=> {\n            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {\n                AH.select(\"#err_txt\").innerHTML = \"Digits Only\";\n                AH.selectAll(\"#err_txt\", 'show');\n                return false;\n            }\n        });\n\n        // if ((navigator.userAgent.indexOf(\"MSIE \") > -1 || navigator.userAgent.indexOf(\"Trident/\")) > -1) {\n        //     jQuery('#uploadChk').keyup(function(e) { if (e.keyCode == 32) this.click() });\n        // }\n\n        let parsedXmlNode = AH.parseHtml(xml);\n        if (AH.find(parsedXmlNode, 'default') && AH.find(parsedXmlNode, 'default').getAttribute('type') == 1) {\n            AH.selectAll('.upload-area', 'removeClass', 'h');\n            AH.select('#uploadChk').checked = true;\n            console.log(AH.find(parsedXmlNode, 'default').getAttribute('fileTypeExts'));\n            AH.select(`#choose_ext option[value=\"${AH.find(parsedXmlNode, 'default').getAttribute('fileTypeExts')}\"]`, 'attr',{selected: 'selected'});\n            AH.select('#files_number').value = AH.find(parsedXmlNode, 'default').getAttribute('limit');\n        }\n\n        //updateXML();\n        parseXml(xml);\n    });\n\n    function initEdit() {\n        essayAuthEditor = SUNEDITOR.create('essay_editorAuth', { \n            width: 'auto',\n            toolbarContainer: \"#essayToolbar\",\n            placeholder: \"Write text here.\",\n            plugins: plugins, \n            resizingBar: false,\n            showPathLabel: false,\n            buttonList: [\n                ['formatBlock'],\n                ['bold', 'italic', 'underline'],\n                ['list', 'outdent', 'indent', 'align'],\n                ['removeFormat'],\n            ] \n        });\n\n        essayAuthEditor.onChange = (content, core)=> {\n            updateXML(1000, content);\n        }\n        essayAuthEditor.onKeyDown = (e, core)=> {\n            if (e.keyCode == 86 || e.keyCode == 67) {\n                updateXML(1000);\n            }\n        }\n    }\n    // // it detects any change in xml.\n    // beforeUpdate(()=> {\n    //     if (xml != author_xml) {\n    //         author_xml = xml;\n    //         parseXml(xml);\n    //     }\n    // });\n    \n\n    // if xml change the it updates cdata\n    function parseXml(xml) {\n        if (state.cdata) {\n            state.cdata = false;\n            let qxml = XMLToJSON(xml);\n            if ( AI.isValid(qxml) && AI.isValid(qxml.smxml.default) ) {\n                essayAuthEditor.setContents(qxml.smxml.default.__cdata);\n            }\n        }\n    }\n\n    // it checks the no .of files for upload. \n    function maxLengthCheck(e, maxLength) {\n        state.files_number = e.value;\n        if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {\n            AH.select(\"#err_txt\").innerHTML = \"Digits Only\";\n            AH.selectAll(\"#err_txt\", 'show');\n            return false;\n        }\n    }\n\n    // it updates the xml;\n    function updateXML(time, content) {\n        if (timer) {\n            clearTimeout(timer);\n        }\n        timer = setTimeout(function() {\n            let val = content || essayAuthEditor.getContents();\n            let xmlDom = AH.parseHtml(xml);\n            let chooseExtOpt = AH.selectAll(\"#choose_ext option\", \"selected\")[0];\n            let defaultDom = xmlDom.querySelector('default');\n            if (AH.select(\"#uploadChk\").checked) {\n                if (defaultDom) {\n                    AH.setAttr(defaultDom, {\n                        'type': 1,\n                        'fileTypeExts': (chooseExtOpt ? chooseExtOpt.value : \"\"),\n                        'limit': AH.select('#files_number').value\n                    });\n                } else {\n                    let defHtml = AH.parseHtml(`<default type=\"1\" fileTypeExts=\"${chooseExtOpt ? chooseExtOpt.value : ''}\" limit=\"${AH.select('#files_number').value}\"></default>`);\n                    xmlDom.appendChild(defHtml);\n                }\n            } else if (defaultDom) {\n                defaultDom.setAttribute('type', 0)\n                defaultDom.removeAttribute(...['fileTypeExts', 'limit']);\n            }\n\n            if (defaultDom) {\n                defaultDom.innerHTML = `<!--[CDATA[${val}]]-->`;\n            } else {\n                let defHtml = AH.parseHtml(`<default type=\"0\"><!--[CDATA[${val}]]--></default>`);\n                xmlDom.appendChild(defHtml);\n                //xmlDom.querySelector('default').innerHTML = '';\n            }\n            //console.log(xmlDom);\n            author_xml = formatXml(xmlDom.outerHTML);\n            getChildXml(author_xml);\n        }, time);\n    }\n</script>\n\n<main id=\"SM_essay\">\n    <div class=\"hero-unit\">\n        <div id=\"essayToolbar\" class=\"sun-editor\"></div>\n        <textarea id=\"essay_editorAuth\" class=\"text-left editor sun-editor-editable\"></textarea>\n        <Checkbox \t\n            bind:checked={isUpload}\n            on:click={updateXML}\n            id=\"uploadChk\"\n            name=\"uploadChk\"\n            color=\"primary\"\n        >\n            <span>Upload</span>\n        </Checkbox>\n        {#if isUpload}\n            <div class=\"upload-area mt-3 text-left\">\n                <div class=\"row\">\n                    <div class=\"col-sm-3\">\n                        <label for=\"choose_ext\" class=\"mb-0 pt-sm1 font14\">{l.file_extension_text} </label>\n                    </div>\n                    <div class=\"col-sm-8\">\n                        <select name=\"choose_ext\" id=\"choose_ext\" class=\"form-control form-control-md\" on:blur=\"{()=> updateXML(500)}\">\n                            <option value=\"*.txt,*.doc,*.docx,*.pdf,*.jpg,*.png,*.gif,*.bmp,*.jpeg\" selected=\"selected\">All(*.*)</option>\n                            <option value=\"*.txt\">*.txt</option>\n                            <option value=\"*.pdf\">*.pdf</option>\n                            <option value=\"*.doc,*.docx\">*.doc,*.docx</option>\n                            <option value=\"*.doc,*.docx,*.pdf\">*.doc,*.docx,*.pdf</option>\n                            <option value=\"*.jpg,*.png,*.gif,*.bmp,*.jpeg\">*.jpg,*.png,*.gif,*.bmp,*.jpeg</option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"row mt-2\">\n                    <div class=\"col-sm-3\">\n                        <label for=\"files_number\" class=\"mb-0 font14 pt-1\">{l.number_of_files} </label>\n                    </div>\n                    <div class=\"col-sm-8\">\n                        <input \n                            type=\"number\" \n                            class=\"form-control form-control-md float-left filenumber\" \n                            name=\"files_number\" \n                            id=\"files_number\" \n                            value={state.files_number} \n                            step=\"1\" \n                            min=\"1\" \n                            max=\"10\" \n                            on:change={maxLengthCheck.bind(this, 2)} \n                            required=\"required\"\n                        />\n                        <small class=\"font11\">{l.you_can_upload}</small>\n                    </div>\n                </div>\n            </div>\n        {/if}\n    </div>\n</main>\n<style>\n    .hero-unit {\n        border: 1px solid #ccc;\n        width: 84%;\n        padding: 18px!important;\n        font-size: 15px!important;\n        margin-bottom: 30px;\n        font-weight: 200;\n        line-height: 30px;\n        color: inherit;\n        background-color: #eeeeee;\n        -webkit-border-radius: 6px;\n        -moz-border-radius: 6px;\n        border-radius: 6px;\n    }\n    #essay_editorAuth {\n        max-height: 250px;\n        height: 250px;\n        background-color: white;\n        border-collapse: separate;\n        border: 1px solid rgb(204, 204, 204);\n        padding: 4px;\n        box-sizing: content-box;\n        -webkit-box-shadow: rgba(0, 0, 0, 0.0745098) 0px 1px 1px 0px inset;\n        box-shadow: rgba(0, 0, 0, 0.0745098) 0px 1px 1px 0px inset;\n        border-top-right-radius: 3px;\n        border-bottom-right-radius: 3px;\n        border-bottom-left-radius: 3px;\n        border-top-left-radius: 3px;\n        overflow: scroll;\n        outline: none;\n    }\n    .essay-btn, .essay-btn-add {\n        display: inline-block;\n        padding: 4px 8px;\n        font-size: 12px;\n        line-height: 20px;\n        text-align: center;\n        vertical-align: middle;\n        cursor: pointer;\n        color: #333333;\n        text-shadow: 0 1px 1px rgba(255, 255, 255, 0.75);\n        background-color: #f5f5f5;\n        background-image: -moz-linear-gradient(top, #ffffff, #e6e6e6);\n        background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#ffffff), to(#e6e6e6));\n        background-image: -webkit-linear-gradient(top, #ffffff, #e6e6e6);\n        background-image: -o-linear-gradient(top, #ffffff, #e6e6e6);\n        background-image: linear-gradient(to bottom, #ffffff, #e6e6e6);\n        background-repeat: repeat-x;\n        filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffffff', endColorstr='#ffe6e6e6', GradientType=0);\n        border-color: #e6e6e6 #e6e6e6 #bfbfbf;\n        border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);\n        filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);\n        border: 1px solid #cccccc;\n        border-bottom-color: #b3b3b3;\n        -webkit-border-radius: 4px;\n        -moz-border-radius: 4px;\n        border-radius: 4px;\n        -webkit-box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\n        -moz-box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\n        box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);\n    }\n    .dropdown-item {\n        display: block;\n        width: 100%;\n        padding: 4px 12px;\n        clear: both;\n        font-weight: 400;\n        color: #212529;\n        text-align: inherit;\n        white-space: nowrap;\n        background-color: transparent;\n        border: 0;\n    }\n    .essay-btn {\n        margin-bottom: 15px;\n    }\n    .essay-container .upload-area #files_number {\n        width: 115px;\n    }\n    .essay-container {\n        width: 89%;\n    }\n</style>"],"names":["SUNEDITOR"],"mappings":"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"}