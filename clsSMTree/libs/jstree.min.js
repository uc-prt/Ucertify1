/**
 * jstree - javascript tree manipulation and visualization
 * @version v4.0.0
 * @link https://www.jstree.com
 * @license MIT
 */
/**
 * jstree - javascript tree manipulation and visualization
 * @version v4.0.0
 * @link https://www.jstree.com
 * @license MIT
 */
class Flat{_empty(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}constructor(t,e){this.dataSource=e,this.dataSource.count||(this.dataSource.count=()=>0),this.dataSource.create||(this.dataSource.create=()=>document.createElement("div")),this.dataSource.wrapper||(this.dataSource.wrapper=()=>document.createElement("div")),this.container=this._empty(t),this.wrapper=this.dataSource.wrapper(),this.wrapper.className+=" vakata-scroller-wrapper",this.container.appendChild(this.wrapper),this.count=0,this.render()}render(){this.updateAll(!0)}updateItem(t,e,i=!0){this.dataSource.update(t,e,i)}updateAll(t=!0){if(t){this.count=this.dataSource.count();let t=document.createDocumentFragment();for(let e=0;e<this.count;e++){let e=this.dataSource.create();e.className+=" vakata-scroller-item",t.appendChild(e)}this._empty(this.wrapper).appendChild(t)}let e=this.wrapper.firstChild;for(let i=0;i<this.count;i++)this.updateItem(i,e,!t),e=e.nextSibling||this.wrapper.firstChild}}class InfiniteScroller{_empty(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}_offset(t){return t.getBoundingClientRect().top+t.ownerDocument.defaultView.pageYOffset}_scrollParent(t){for(;t&&"body"!==(t.tagName||"body").toLowerCase();){if(-1!==t.className.indexOf("vakata-scroller-parent"))return t;let e=getComputedStyle(t,null);if("auto"===e.getPropertyValue("overflow")||"scroll"===e.getPropertyValue("overflow")||"auto"===e.getPropertyValue("overflow-y")||"scroll"===e.getPropertyValue("overflow-y"))return t;t=t.parentNode}return document.documentElement}_debounce(t,e){let i;return()=>{let r=arguments;clearTimeout(i),i=setTimeout(()=>t.apply(this,r),e)}}_processScroll(){let t=this.scrollParent.scrollTop-this._state.scroll-this._state.topPosition,e=this._state.render*this._state.height/4,i=Math.floor(Math.abs(t-e)/this._state.height),r=()=>{let t=this._state.topPosition;(t+=this._state.render*this._state.height)<this._state.count*this._state.height&&(this._state.index++,this._state.top.pos=t,this._state.bottom=this._state.top,this._state.top=this._state.top.nextSibling||this.wrapper.firstChild,this._state.topPosition=this._state.index*this._state.height,this._state.bottomPosition=this._state.topPosition+(this._state.render-1)*this._state.height)},s=()=>{let t=this._state.bottomPosition;(t-=this._state.render*this._state.height)>=0&&(this._state.index--,this._state.bottom.pos=t,this._state.top=this._state.bottom,this._state.bottom=this._state.bottom.previousSibling||this.wrapper.lastChild,this._state.topPosition=this._state.index*this._state.height,this._state.bottomPosition=this._state.topPosition+(this._state.render-1)*this._state.height)};if(t>e)for(let t=0;t<i;t++)r();if(t<e)for(let t=0;t<i;t++)s();let a=this._state.top;for(let t=0;t<this._state.render;t++)a.style.transform="translateY("+a.pos+"px)",a=a.nextSibling||this.wrapper.firstChild;this.updateAll()}_wrapperWidth(t=!1){let e=0,i=this.wrapper.firstChild,r=this.wrapper.width||this.wrapper.offsetWidth;t&&(this.wrapper.style.minWidth="none");do{i.width&&i.width>e&&(e=i.width)}while(i=i.nextSibling);(t||r!==e)&&(this.wrapper.width=e,this.wrapper.style.minWidth=e+"px")}constructor(t,e){this.dataSource=e,this.dataSource.count||(this.dataSource.count=()=>0),this.dataSource.create||(this.dataSource.create=()=>document.createElement("div")),this.dataSource.wrapper||(this.dataSource.wrapper=()=>document.createElement("div")),this._state={height:0,count:this.dataSource.count(),scroll:0,render:0,visible:0,index:0,top:null,bottom:null},this.container=this._empty(t),this.wrapper=this.dataSource.wrapper(),this.wrapper.className+=" vakata-scroller-wrapper",this.wrapper.style.position="relative",this.container.appendChild(this.wrapper),this.scrollParent=this._scrollParent(this.wrapper);let i=this.scrollParent===document.documentElement?window:this.scrollParent;this.render(),window.addEventListener("resize",this._debounce(this.render,50)),i.addEventListener("scroll",()=>{this.scrollID&&window.cancelAnimationFrame(this.scrollID),this.scrollID=window.requestAnimationFrame(()=>this._processScroll())})}render(){let t=this.dataSource.create();t.className+=" vakata-scroller-item",t.innerHTML="&nbsp;",this.wrapper.appendChild(t),this._state.height=t.offsetHeight,this._state.count=this.dataSource.count(),this.wrapper.removeChild(t),this.wrapper.style.height=this._state.count*this._state.height+"px",this._state.scroll=0,this.scrollParent!==this.container&&(this._state.scroll=this.scrollParent===document.documentElement?this._offset(this.container):this._offset(this.container)-this._offset(this.scrollParent)),this._state.visible=Math.min(window.innerHeight,this.scrollParent.offsetHeight),this._state.render=2*Math.max(1,Math.ceil(this._state.visible/this._state.height));let e=document.createDocumentFragment();for(let t=0;t<this._state.render;t++){let i=this.dataSource.create();i.className+=" vakata-scroller-item",i.style.willChange="transform",i.style.position="absolute",i.style.minWidth="100%",i.style.height=this._state.height+"px",i.style.transform="translateY("+this._state.height*t+"px)",e.appendChild(i)}this._empty(this.wrapper).appendChild(e),this._state.top=this.wrapper.firstChild,this._state.topPosition=0,this._state.index=0,this._state.bottom=this.wrapper.lastChild,this._state.bottomPosition=this._state.height*(this._state.render-1),this._processScroll(),this.updateAll(!0)}updateItem(t,e,i=!0){this.dataSource.update(t,e,i)}updateAll(t=!0){let e=this.dataSource.count();e!==this._state.count&&(this._state.count=e,this.wrapper.style.height=this._state.count*this._state.height+"px");let i=this._state.top;for(let e=this._state.index;e<this._state.index+this._state.render;e++)this.updateItem(e,i,!t),i=i.nextSibling||this.wrapper.firstChild}}class TreeNode{constructor(t={}){this.data=t,this.parent=null,this.children=[]}getParent(){return this.isRoot()?null:this.parent}hasParent(){return!this.isRoot()}isRoot(){return null===this.parent||this.parent.data===TreeNode.getRootSymbol()}hasChildren(){return this.children.length>0}isEmpty(){return 0===this.children.length}getAncestors(){for(var t=[],e=this.getParent();e&&e.data!==TreeNode.getRootSymbol();)t.push(e),e=e.getParent();return t}getIndex(){return null===this.parent?0:this.parent.children.indexOf(this)}isLast(){if(null===this.parent)return!0;var t=this.parent.children;return t[t.length-1]===this}getChildren(){return this.children}getDescendants(){var t=[];let e=function(i){for(let r of i.children)t.push(r),e(r)};return e(this),t}addChild(t,e){return Array.isArray(t)?(t.forEach((t,i)=>this.addChild(t,void 0===e?e:e+i)),this):(t.parent&&t.parent.children.splice(t.parent.children.indexOf(t),1),t.parent=this,void 0===e?this.children.push(t):this.children.splice(e,0,t),this)}delete(){return this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent=null,this}empty(){this.children=[]}move(t,e){t.addChild(this,e)}copy(t,e){t.addChild(TreeNode.fromJSON(this.toJSON("children","data"),"children","data"),e)}get(t,e=null){return this.data[t]||e}set(t,e){return this.data[t]=e,this}data(t){return void 0!==t&&(this.data=t),this.data}toJSON(t="children",e=""){if(e)return{[e]:this.data,[t]:this.children.map(i=>i.toJSON(t,e))};let i=this.data;return i[t]=this.children.map(i=>i.toJSON(t,e)),i}toFlatJSON(t="id",e="id",i="parent",r="position",s=""){let a=[],n=o=>{if(s)a.push({[e]:o.data[t],[i]:o.parent?o.parent.data[t]:null,[r]:o.getIndex(),[s]:o.data});else{let s=o.data;s[e]=o.data[t],s[i]=o.parent?o.parent.data[t]:null,s[r]=o.getIndex(),a.push(s)}o.children.forEach(n)};return n(this),a}static fromJSON(t,e="children",i=""){if(Array.isArray(t))return t.map(t=>TreeNode.fromJSON(t,e));if(!i){let r={},s=[];for(let i of Object.keys(t))i!==e?r[i]=t[i]:s=t[i];let a=new TreeNode(r);return s&&s.forEach(t=>a.addChild(TreeNode.fromJSON(t,e,i))),a}let r=new TreeNode(t[i]);return t[e]&&t[e].forEach(t=>r.addChild(TreeNode.fromJSON(t,e,i))),r}static fromFlatJSON(t,e="id",i="parent",r="position",s=""){var a=new Map;return t.forEach(t=>{a[t[e]]={data:s?t[s]:t,children:[]}}),a.forEach((t,e)=>{a.has(e[i])&&a.get(e[i]).children.push(e)}),r&&a.forEach((t,e)=>{e.children.sort((function(t,e){return(t=t[r])===(e=e[r])?0:t<e?-1:1}))}),a.forEach((t,e)=>{a.has(e[i])&&a.delete(t)}),TreeNode.fromJSON(Array.from(a.values()),"children","data")}static getRootSymbol(){return TreeNode.root||(TreeNode.root=Symbol("Root symbol")),TreeNode.root}static getRoot(){return new TreeNode(TreeNode.getRootSymbol())}}class Tree{constructor(){this.root=TreeNode.getRoot()}addRoot(t,e){return this.root.addChild(t,e)}getRoots(){return this.root.getChildren()}isEmpty(){return this.root.isEmpty()}empty(){return this.root.empty()}toJSON(t="children",e=""){return this.root.toJSON(t,e).children}toFlatJSON(t="id",e="id",i="parent",r="position",s=""){let a=this.root.toFlatJSON(t,e,i,r,s);return delete a[0],a}_normalizeCriteria(t){return"function"==typeof t?t:("object"!=typeof t&&(t={id:t}),function(e){for(let i of t.keys())if(e.data[i]!==t[i])return!1;return!0})}find(t){t=this._normalizeCriteria(t);let e=[];for(let i of this)t(i)&&e.push(i);return e}findFirst(t){t=this._normalizeCriteria(t);for(let e of this)if(t(e))return e;return null}*filter(t){t=this._normalizeCriteria(t);for(let e of this)t(e)&&(yield e)}*[Symbol.iterator](){let t=function*(e){for(let i of e.children)yield i,yield*t(i)};yield*t(this.root)}}class jsTree{_extend(t){t=t||{};for(let e=1;e<arguments.length;e++){let i=arguments[e];if(i)for(let e in i)i.hasOwnProperty(e)&&("object"==typeof i[e]&&null!==i[e]?t[e]=this._extend(t[e],i[e]):t[e]=i[e])}return t}constructor(t={},e=null){if(this.options=this._extend({},jsTree.defaults,t),this.tree=new Tree,this.events={},this.handlers={create:[],render:[]},this._nodeList=[],this._renderer=null,this.on("select deselect selectAll deselectAll\n             check uncheck checkAll uncheckAll\n             enable disable enableAll disableAll\n             rename",()=>this.redraw()),this.on("open close openAll closeAll\n             hide show hideAll showAll\n             empty create delete move copy",()=>this.redraw(!0)),e&&this.render(e),this.options.data instanceof Function){let t=this;this.options.data(null,(function(e){t.empty().create(e,null)}),(function(){}))}else this.empty().create(t.data,null)}addCreateHandler(t){this.handlers.create.push(t)}addRenderHandler(t){this.handlers.render.push(t)}node(t){if(t instanceof TreeNode)return t;if(t instanceof HTMLElement){for(;!t.classList.contains("jstree-node");){if(!t.parentNode||t.parentNode===window.document)return null;t=t.parentNode}return this._nodeList[parseInt(t.getAttribute("data-index"),10)]||null}return"object"!=typeof t&&"function"!=typeof t&&(t={[this.options.idProperty]:t}),this.tree.findFirst(t)}find(t){return"object"!=typeof t&&"function"!=typeof t&&(t={[this.options.idProperty]:t}),this.tree.find(t)}*filter(t){"object"!=typeof t&&"function"!=typeof t&&(t={[this.options.idProperty]:t}),yield*this.tree.filter(t)}*[Symbol.iterator](){yield*this.tree[Symbol.iterator]()}getState(t,e,i=null){return this.node(t).data.state&&void 0!==this.node(t).data.state[e]?this.node(t).data.state[e]:i}setState(t,e,i){return(t=this.node(t)).data.state||(t.data.state={}),t.data.state[e]!==i&&(t.data.state[e]=i,t._dirty=!0),this}trigger(t,e={}){return e.event=t,e.instance=this,this.events[t]&&this.events[t].forEach(t=>t(e)),this.events["*"]&&this.events["*"].forEach(t=>t(e)),this}on(t,e){let i=t.split(" ");return i.length>1?(i.forEach(t=>this.on(t,e)),this):(t=i[0],this.events[t]||(this.events[t]=[]),this.events[t].push(e),this)}off(t,e=null){let i=t.split(" ");if(i.length>1)return i.forEach(t=>this.off(t,e)),this;if(t=i[0],this.events[t]){null===e&&(this.events[t]=[]),-1!==this.events[t].indexOf(e)&&this.events[t].splice(this.events[t].indexOf(e),1)}return this}open(t){return Array.isArray(t)?(t.forEach(t=>this.open(t)),this):((t=this.node(t))&&(this.setState(t,"opened",!0),this.trigger("open",{node:t})),this)}close(t){return Array.isArray(t)?(t.forEach(t=>this.close(t)),this):((t=this.node(t))&&(this.setState(t,"opened",!1),this.trigger("close",{node:t})),this)}openAll(){for(let t of this.tree)this.setState(t,"opened",!0);return this.trigger("openAll"),this}closeAll(){for(let t of this.tree)this.setState(t,"opened",!1);return this.trigger("closeAll"),this}hide(t){return Array.isArray(t)?(t.forEach(t=>this.hide(t)),this):((t=this.node(t))&&(this.setState(t,"hidden",!0),this.trigger("hide",{node:t})),this)}show(t){return Array.isArray(t)?(t.forEach(t=>this.show(t)),this):((t=this.node(t))&&(this.setState(t,"hidden",!1),this.trigger("show",{node:t})),this)}hideAll(){for(let t of this.tree)this.setState(t,"hidden",!0);return this.trigger("hideAll"),this}showAll(){for(let t of this.tree)this.setState(t,"hidden",!1);return this.trigger("showAll"),this}select(t){return Array.isArray(t)?(t.forEach(t=>this.select(t)),this):((t=this.node(t))&&(this.setState(t,"selected",!0),this.trigger("select",{node:t})),this)}deselect(t){return Array.isArray(t)?(t.forEach(t=>this.deselect(t)),this):((t=this.node(t))&&(this.setState(t,"selected",!1),this.trigger("deselect",{node:t})),this)}selectAll(){for(let t of this.tree)this.setState(t,"selected",!0);return this.trigger("selectAll"),this}deselectAll(){for(let t of this.tree)this.setState(t,"selected",!1);return this.trigger("deselectAll"),this}getSelected(){return this.tree.find((function(t){return t.data&&t.data.state&&t.data.state.selected}))}check(t){return Array.isArray(t)?(t.forEach(t=>this.check(t)),this):((t=this.node(t))&&(this.setState(t,"checked",!0),this.setState(t,"indeterminate",!1),this.trigger("check",{node:t})),this)}uncheck(t){return Array.isArray(t)?(t.forEach(t=>this.uncheck(t)),this):((t=this.node(t))&&(this.setState(t,"checked",!1),this.setState(t,"indeterminate",!1),this.trigger("uncheck",{node:t})),this)}checkAll(){for(let t of this.tree)this.setState(t,"checked",!0),this.setState(t,"indeterminate",!1);return this.trigger("checkAll"),this}uncheckAll(){for(let t of this.tree)this.setState(t,"checked",!1),this.setState(t,"indeterminate",!1);return this.trigger("uncheckAll"),this}getChecked(){return this.tree.find((function(t){return t.data&&t.data.state&&t.data.state.checked}))}getTopChecked(){let t=function*(e){for(let i of e.children)e.data.state&&e.data.state.checked&&(yield i),yield*t(i)};return Array.from(t(this.root))}getBottomChecked(){let t=function*(e){for(let i of e.children)e.data.state&&e.data.state.checked&&!i.children.length&&(yield i),yield*t(i)};return Array.from(t(this.root))}getIndeterminate(){return this.tree.find((function(t){return t.data&&t.data.state&&t.data.state.indeterminate}))}enable(t){return Array.isArray(t)?(t.forEach(t=>this.enable(t)),this):((t=this.node(t))&&(this.setState(t,"disabled",!1),this.trigger("enable",{node:t})),this)}disable(t){return Array.isArray(t)?(t.forEach(t=>this.disable(t)),this):((t=this.node(t))&&(this.setState(t,"disabled",!0),this.trigger("disable",{node:t})),this)}enableAll(){for(let t of this.tree)this.setState(t,"disabled",!1);return this.trigger("enableAll"),this}disableAll(){for(let t of this.tree)this.setState(t,"disabled",!0);return this.trigger("disableAll"),this}edit(t){throw new Error("Not defined",t)}empty(){return this.tree.empty(),this.trigger("empty"),this}parseNode(t,e=null){if(t instanceof TreeNode)return t;if(e||(e=this.options.format),"string"==typeof t){let i={};e.data?i[e.data][e.title]=t:i[e.title]=t,t=i}return e.flat?TreeNode.fromFlatJSON(t,e.id,e.parent,e.position,e.data):TreeNode.fromJSON(t,e.children,e.data)}create(t,e=null,i=null,r=null){if(t=this.parseNode(t,r),null===e)this.tree.addRoot(t,i);else{if(!(e=this.node(e)))throw new Error("Invalid parent");e.addChild(t,i)}return t._dirty=!0,this.trigger("create",{node:t,parent:e,index:i}),this}move(t,e,i=null){throw new Error("Not defined",t,e,i)}copy(t,e,i=null){throw new Error("Not defined",t,e,i)}delete(t){return Array.isArray(t)?(t.forEach(t=>this.enable(t)),this):((t=this.node(t)).remove(),this.trigger("delete",{node:t}),this)}*visible(){let t=function*(e){for(let i of e.children)i.data.state&&i.data.state.hidden||(yield i,i.data.state&&i.data.state.opened&&(yield*t(i)))};yield*t(this.tree.root)}redraw(t=!1){this.redrawID&&window.cancelAnimationFrame(this.redrawID),this.redrawID=window.requestAnimationFrame(()=>{this._nodeList||(t=!0),t&&(this._nodeList=Array.from(this.visible())),this._renderer&&this._renderer.updateAll(t)})}render(t){let e=this;t.jsTree=e,t.classList.add("jstree"),t.addEventListener("click",(function(t){let i=t.target;i&&i.classList.contains("jstree-closed")&&e.open(i),i&&i.classList.contains("jstree-opened")&&e.close(i),i&&i.classList.contains("jstree-node-icon")&&(i=i.parentNode),i&&i.classList.contains("jstree-node-text")&&(t.preventDefault(),e.deselectAll(),e.select(i))})),this._nodeList=Array.from(this.visible()),this._renderer=new Flat(t,{create:function(){let t=document.createElement("div");return t.classList.add("jstree-node"),this.handlers.create.forEach(e=>e.call(this,t)),t}.bind(this),update:function(t,e,i=!0){let r=this._nodeList[t];if(!r)return void(e.style.display="none");if(i&&!r._dirty)return;e.style.display="block";let s="";r.getAncestors().reverse().forEach((function(t){t.isLast()?s+='<i class="jstree-icon">&nbsp;</i>':s+='<i class="jstree-icon jstree-icon-v">&nbsp;</i>'}));let a="leaf";this.getState(r,"loaded",!0)?r.hasChildren()&&(a=this.getState(r,"opened")?"opened":"closed"):a="closed",r.isLast()?s+=`<i class="jstree-icon jstree-icon-v2 jstree-icon-h"><span class="jstree-${a}">&nbsp;</span></i>`:s+=`<i class="jstree-icon jstree-icon-v jstree-icon-h"><span class="jstree-${a}">&nbsp;</span></i>`,a=this.getState(r,"selected",!1)?"jstree-selected":"",s+=`<a class="jstree-node-text ${a}" href="#"><i class="jstree-icon jstree-node-icon">&nbsp;</i> ${r.data.text}</a>`,e.setAttribute("data-index",t),e.innerHTML=s,this.handlers.render.forEach(t=>t.call(this,e,r)),r._dirty=!1}.bind(this),count:()=>this._nodeList.length})}static instance(t){if(t instanceof HTMLElement){for(;void 0===t.jsTree;){if(!t.parentNode||t.parentNode===window.document)return null;t=t.parentNode}return t.jsTree}return null}}jsTree.defaults={data:(t,e)=>e([]),massload:!1,format:{flat:!1,id:"id",children:"children",parent:null,position:null,data:null,title:"text",html:!1},theme:{dots:!0,icons:!0,stripes:!0},strings:{loading:"Loading ...",newNode:"New node"},selection:{multiple:!0,reveal:!0},check:()=>!0,error:t=>t,checkbox:{visible:!1,cascade:{up:!0,down:!0,indeterminate:!0,includeHidden:!0,includeDisabled:!0},selection:!0,wholeNode:!1},dragndrop:{isDraggable:()=>!1,dragSelection:!0,forceCopy:!1,mobileSelectionOnly:!0},search:{beforeSearch:(t,e)=>e(),match:(t,e)=>-1!==e.data.text.indexOf(t),showOnlyMatches:!0,closeOnClear:!0},sort:null,state:{key:"jstree",ttl:0,filter:t=>t},types:{"*":{}}};